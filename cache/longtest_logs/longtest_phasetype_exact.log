
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

Precompiling packages...
    MultistateModels Being precompiled by another process (pid: 92216, pidfile: /Users/fintzij/.julia/compiled/v1.12/MultistateModels/4PRvT_KRgLi.ji.pidfile)
  16838.3 ms  ✓ MultistateModels
  1 dependency successfully precompiled in 51 seconds. 576 already precompiled.
┌ Warning: No transitions observed in data (all statefrom == stateto). Falling back to :crude initialization. If this is template data for simulation, consider using `initialize=false` when creating the model.
└ @ MultistateModels ~/Library/CloudStorage/OneDrive-BristolMyersSquibb/Documents/Julia packages/MultistateModels.jl/src/utilities/initialization.jl:468
[ Info: Saved result: pt_exact_nocov -> /Users/fintzij/Library/CloudStorage/OneDrive-BristolMyersSquibb/Documents/Julia packages/MultistateModels.jl/MultistateModelsTests/cache/longtest_results/pt_exact_nocov.json
[ Info: Saved result: pt_exact_fixed -> /Users/fintzij/Library/CloudStorage/OneDrive-BristolMyersSquibb/Documents/Julia packages/MultistateModels.jl/MultistateModelsTests/cache/longtest_results/pt_exact_fixed.json
[ Info: Saved result: pt_exact_tvc -> /Users/fintzij/Library/CloudStorage/OneDrive-BristolMyersSquibb/Documents/Julia packages/MultistateModels.jl/MultistateModelsTests/cache/longtest_results/pt_exact_tvc.json

======================================================================
Phase-Type Hazard Models: Exact Data Long Tests
======================================================================
Testing inference for models with Coxian phase-type hazard structure.
These models are Markov on the expanded state space → direct MLE.
Default sample size: n=1000

--- 2-Phase Coxian Illness-Death Model ---
Observed states: 3, Phases per transient: 2
Expanded states: 5 (2 + 2 + 1)
Phase-type model structure:
  Observed states: 3
  Expanded states: 5
  State 1 → phases 1:2 (2 phases)
  State 2 → phases 3:4 (2 phases)
  State 3 → phases 5:5 (1 phases)
  Number of hazards: 8
  Number of hazards in expanded model: 8
  True rates: [0.5, 0.3, 0.4, 0.2, 0.25, 0.35, 0.3, 0.15]

Simulating exact data...
  Simulated 2089 observations

Fitting phase-type model with direct MLE...
True params (natural): [0.5, 0.3, 0.4, 0.2, 0.25, 0.35, 0.3, 0.15]
Fitted params (natural): [0.458, 0.341, 0.41, 0.21, 0.236, 0.361, 0.292, 0.173]
Test Summary:                                         | Pass  Total     Time
Phase-Type Hazard: 2-Phase Illness-Death (Exact Data) |   23     23  3m51.3s

--- Distributional Fidelity Check ---
Verify fitted phase-type model reproduces data-generating distribution
  Quantiles (true → fitted):
    25th: 1.137 → 1.077
    50th: 2.358 → 2.31
    75th: 3.977 → 4.06
    90th: 5.991 → 5.84
Test Summary:                             | Pass  Total   Time
Distributional Fidelity: Phase-Type Model |    1      1  23.6s

--- 2-Phase Phase-Type with Fixed Covariate ---
Phase-type model structure:
  Observed states: 2
  Expanded states: 3
  State 1 → phases 1:2 (2 phases)
  State 2 → phases 3:3 (1 phases)
  Number of hazards: 3
  Number of hazards: 3
  True rates: [0.5, 0.3, 0.6]
  True betas: [0.0, 0.4, 0.3]

Simulating exact data with covariate...
  Simulated 1559 observations
  Events: 995

Fitting phase-type model with covariate...
Test Summary:                                                | Pass  Total     Time
Phase-Type Hazard: 2-Phase with Fixed Covariate (Exact Data) |   10     10  1m50.0s

--- 2-Phase Phase-Type with Time-Varying Covariate ---
  True rates: [0.4, 0.25, 0.5]
  True TVC betas: [0.0, 0.5, 0.4]

Simulating exact data with TVC...
  Simulated 1957 observations

Fitting phase-type model with TVC...
Test Summary:                                    | Pass  Total     Time
Phase-Type Hazard: 2-Phase with TVC (Exact Data) |    6      6  2m00.1s
