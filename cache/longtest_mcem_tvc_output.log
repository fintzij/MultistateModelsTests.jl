
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

  ✓ Markov Panel Exponential + TVC fitting works
Test Summary:                  | Pass  Total   Time
Markov Panel Exponential + TVC |    6      6  23.6s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -2006.87
Initial estimate of the log marginal likelihood: -1565.889

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1983.284
Gain in marginal log-likelihood, ΔQ: 23.6
MCEM asymptotic standard error: 0.151
Ascent lower and upper bound: [23.4, 23.8]
Estimate of the log marginal likelihood, l(θ): -1541.726
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1979.553
Gain in marginal log-likelihood, ΔQ: 0.0418
MCEM asymptotic standard error: 0.0256
Ascent lower and upper bound: [0.00892, 0.0746]
Estimate of the log marginal likelihood, l(θ): -1541.668
SQUAREM: 0 accelerations, 1 fallbacks

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1978.762
Gain in marginal log-likelihood, ΔQ: 0.0113
MCEM asymptotic standard error: 0.0185
Ascent lower and upper bound: [-0.0124, 0.035]
Estimate of the log marginal likelihood, l(θ): -1541.649
SQUAREM: 0 accelerations, 1 fallbacks

The MCEM algorithm has converged.

  ✓ Binary TVC (treatment switch) MCEM fitting works
Test Summary:                           | Pass  Total   Time
MCEM with Binary TVC (Treatment Switch) |    9      9  25.5s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -1847.579
Initial estimate of the log marginal likelihood: -1453.644

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1834.682
Gain in marginal log-likelihood, ΔQ: 12.9
MCEM asymptotic standard error: 0.102
Ascent lower and upper bound: [12.8, 13.0]
Estimate of the log marginal likelihood, l(θ): -1440.485
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: acceleration accepted, α=-0.973]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1836.335
Gain in marginal log-likelihood, ΔQ: 0.00778
MCEM asymptotic standard error: 0.00955
Ascent lower and upper bound: [-0.00441, 0.0201]
Estimate of the log marginal likelihood, l(θ): -1440.473
SQUAREM: 1 accelerations, 0 fallbacks

The MCEM algorithm has converged.

  ✓ Continuous TVC (biomarker) MCEM fitting works
Test Summary:                        | Pass  Total   Time
MCEM with Continuous TVC (Biomarker) |    7      7  30.8s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 30.0 per-subject
Initial range of the number of sample paths per-subject: [30, 50]
Initial estimate of the marginal log-likelihood, Q: -2263.669
Initial estimate of the log marginal likelihood: -1485.752

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -2210.822
Gain in marginal log-likelihood, ΔQ: 52.8
MCEM asymptotic standard error: 0.275
Ascent lower and upper bound: [52.5, 53.2]
Estimate of the log marginal likelihood, l(θ): -1431.002
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: acceleration accepted, α=-0.999]

Iteration: 2
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -2207.061
Gain in marginal log-likelihood, ΔQ: 0.353
MCEM asymptotic standard error: 0.0951
Ascent lower and upper bound: [0.231, 0.474]
Estimate of the log marginal likelihood, l(θ): -1430.434
SQUAREM: 1 accelerations, 0 fallbacks

Iteration: 3
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -2208.4
Gain in marginal log-likelihood, ΔQ: 0.167
MCEM asymptotic standard error: 0.072
Ascent lower and upper bound: [0.0747, 0.259]
Estimate of the log marginal likelihood, l(θ): -1430.138
SQUAREM: 1 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 4
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -2209.58
Gain in marginal log-likelihood, ΔQ: 0.102
MCEM asymptotic standard error: 0.055
Ascent lower and upper bound: [0.031, 0.172]
Estimate of the log marginal likelihood, l(θ): -1429.958
SQUAREM: 1 accelerations, 1 fallbacks

Iteration: 5
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -2210.396
Gain in marginal log-likelihood, ΔQ: 0.0617
MCEM asymptotic standard error: 0.0422
Ascent lower and upper bound: [0.00758, 0.116]
Estimate of the log marginal likelihood, l(θ): -1429.849
SQUAREM: 1 accelerations, 1 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 6
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -2210.957
Gain in marginal log-likelihood, ΔQ: 0.0373
MCEM asymptotic standard error: 0.0325
Ascent lower and upper bound: [-0.00428, 0.079]
Estimate of the log marginal likelihood, l(θ): -1429.783
SQUAREM: 1 accelerations, 2 fallbacks

Target ESS increased to 43.0 (growth factor 1.414).

Iteration: 7
Target ESS: 43.0 per-subject
Range of the number of sampled paths per-subject: [43.0, 50]
Estimate of the marginal log-likelihood, Q: -2211.347
Gain in marginal log-likelihood, ΔQ: 0.0225
MCEM asymptotic standard error: 0.025
Ascent lower and upper bound: [-0.00952, 0.0546]
Estimate of the log marginal likelihood, l(θ): -1429.743
SQUAREM: 1 accelerations, 2 fallbacks

Target ESS increased to 61.0 (growth factor 1.414).

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 8
Target ESS: 61.0 per-subject
Range of the number of sampled paths per-subject: [61.0, 70]
Estimate of the marginal log-likelihood, Q: -2211.492
Gain in marginal log-likelihood, ΔQ: 0.0107
MCEM asymptotic standard error: 0.0145
Ascent lower and upper bound: [-0.00787, 0.0293]
Estimate of the log marginal likelihood, l(θ): -1429.774
SQUAREM: 1 accelerations, 3 fallbacks

The MCEM algorithm has converged.

  ✓ Weibull + TVC (semi-Markov) MCEM fitting works
Test Summary:                    | Pass  Total   Time
MCEM Weibull + TVC (Semi-Markov) |    6      6  30.8s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -2533.5
Initial estimate of the log marginal likelihood: -1695.173

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -2512.486
Gain in marginal log-likelihood, ΔQ: 21.0
MCEM asymptotic standard error: 0.27
Ascent lower and upper bound: [20.7, 21.4]
Estimate of the log marginal likelihood, l(θ): -1672.356
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -2511.571
Gain in marginal log-likelihood, ΔQ: 0.178
MCEM asymptotic standard error: 0.0267
Ascent lower and upper bound: [0.144, 0.212]
Estimate of the log marginal likelihood, l(θ): -1672.165
SQUAREM: 0 accelerations, 1 fallbacks

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -2511.369
Gain in marginal log-likelihood, ΔQ: 0.00186
MCEM asymptotic standard error: 0.00276
Ascent lower and upper bound: [-0.00168, 0.0054]
Estimate of the log marginal likelihood, l(θ): -1672.163
SQUAREM: 0 accelerations, 1 fallbacks

The MCEM algorithm has converged.

  ✓ Gompertz + TVC (aging + treatment) MCEM fitting works
Test Summary:                           | Pass  Total   Time
MCEM Gompertz + TVC (Aging + Treatment) |    3      3  16.1s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 30.0 per-subject
Initial range of the number of sample paths per-subject: [30, 50]
Initial estimate of the marginal log-likelihood, Q: -3488.136
Initial estimate of the log marginal likelihood: -2778.525

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -3480.684
Gain in marginal log-likelihood, ΔQ: 7.45
MCEM asymptotic standard error: 0.0759
Ascent lower and upper bound: [7.35, 7.55]
Estimate of the log marginal likelihood, l(θ): -2770.927
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -3482.245
Gain in marginal log-likelihood, ΔQ: 0.017
MCEM asymptotic standard error: 0.0141
Ascent lower and upper bound: [-0.00107, 0.035]
Estimate of the log marginal likelihood, l(θ): -2770.905
SQUAREM: 0 accelerations, 1 fallbacks

The MCEM algorithm has converged.


    Parameter Comparison: Progressive with TVC
    ----------------------------------------------------------------------
    Parameter         True        Estimated   Abs Diff    Rel Diff (%)
    ----------------------------------------------------------------------
    shape_12          1.0000      1.0124      0.0124      1.2%
    scale_12          0.1500      0.1550      0.0050      3.3%
    beta_12           0.3000      0.2530      0.0470      15.7%
    shape_23          1.0000      1.0139      0.0139      1.4%
    scale_23          0.2500      0.2481      0.0019      0.8%
    beta_23           0.4000      0.4285      0.0285      7.1%
    ----------------------------------------------------------------------
  ✓ Progressive model with TVC MCEM fitting works
Test Summary:             | Pass  Total   Time
MCEM Progressive with TVC |    4      4  30.9s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -2213.603
Initial estimate of the log marginal likelihood: -1920.856

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -2205.373
Gain in marginal log-likelihood, ΔQ: 8.23
MCEM asymptotic standard error: 0.17
Ascent lower and upper bound: [8.01, 8.45]
Estimate of the log marginal likelihood, l(θ): -1911.953
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -2207.834
Gain in marginal log-likelihood, ΔQ: 0.353
MCEM asymptotic standard error: 0.0882
Ascent lower and upper bound: [0.24, 0.466]
Estimate of the log marginal likelihood, l(θ): -1911.411
SQUAREM: 0 accelerations, 1 fallbacks

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -2208.607
Gain in marginal log-likelihood, ΔQ: 0.102
MCEM asymptotic standard error: 0.0456
Ascent lower and upper bound: [0.0435, 0.16]
Estimate of the log marginal likelihood, l(θ): -1911.256
SQUAREM: 0 accelerations, 1 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -2208.942
Gain in marginal log-likelihood, ΔQ: 0.0285
MCEM asymptotic standard error: 0.0236
Ascent lower and upper bound: [-0.00178, 0.0588]
Estimate of the log marginal likelihood, l(θ): -1911.212
SQUAREM: 0 accelerations, 2 fallbacks

Target ESS increased to 36.0 (growth factor 1.414).

Iteration: 5
Target ESS: 36.0 per-subject
Range of the number of sampled paths per-subject: [36.0, 50]
Estimate of the marginal log-likelihood, Q: -2209.099
Gain in marginal log-likelihood, ΔQ: 0.00782
MCEM asymptotic standard error: 0.0123
Ascent lower and upper bound: [-0.00788, 0.0235]
Estimate of the log marginal likelihood, l(θ): -1911.201
SQUAREM: 0 accelerations, 2 fallbacks

The MCEM algorithm has converged.

  ✓ Multiple TVC change points MCEM fitting works
Test Summary:                   | Pass  Total   Time
MCEM Multiple TVC Change Points |    3      3  58.6s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -1774.553
Initial estimate of the log marginal likelihood: -1396.813

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1771.086
Gain in marginal log-likelihood, ΔQ: 3.47
MCEM asymptotic standard error: 0.382
Ascent lower and upper bound: [2.98, 3.96]
Estimate of the log marginal likelihood, l(θ): -1391.02
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1781.821
Gain in marginal log-likelihood, ΔQ: 1.89
MCEM asymptotic standard error: 0.266
Ascent lower and upper bound: [1.55, 2.23]
Estimate of the log marginal likelihood, l(θ): -1387.685
SQUAREM: 0 accelerations, 1 fallbacks

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1787.394
Gain in marginal log-likelihood, ΔQ: 1.15
MCEM asymptotic standard error: 0.191
Ascent lower and upper bound: [0.905, 1.4]
Estimate of the log marginal likelihood, l(θ): -1385.655
SQUAREM: 0 accelerations, 1 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1790.236
Gain in marginal log-likelihood, ΔQ: 0.69
MCEM asymptotic standard error: 0.14
Ascent lower and upper bound: [0.51, 0.87]
Estimate of the log marginal likelihood, l(θ): -1384.444
SQUAREM: 0 accelerations, 2 fallbacks

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1791.609
Gain in marginal log-likelihood, ΔQ: 0.404
MCEM asymptotic standard error: 0.104
Ascent lower and upper bound: [0.271, 0.537]
Estimate of the log marginal likelihood, l(θ): -1383.738
SQUAREM: 0 accelerations, 2 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 6
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1792.204
Gain in marginal log-likelihood, ΔQ: 0.232
MCEM asymptotic standard error: 0.0766
Ascent lower and upper bound: [0.134, 0.33]
Estimate of the log marginal likelihood, l(θ): -1383.335
SQUAREM: 0 accelerations, 3 fallbacks

Iteration: 7
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1792.405
Gain in marginal log-likelihood, ΔQ: 0.132
MCEM asymptotic standard error: 0.0567
Ascent lower and upper bound: [0.0588, 0.204]
Estimate of the log marginal likelihood, l(θ): -1383.108
SQUAREM: 0 accelerations, 3 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 8
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1792.42
Gain in marginal log-likelihood, ΔQ: 0.0736
MCEM asymptotic standard error: 0.0419
Ascent lower and upper bound: [0.0199, 0.127]
Estimate of the log marginal likelihood, l(θ): -1382.982
SQUAREM: 0 accelerations, 4 fallbacks

Iteration: 9
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1792.357
Gain in marginal log-likelihood, ΔQ: 0.0408
MCEM asymptotic standard error: 0.031
Ascent lower and upper bound: [0.00113, 0.0806]
Estimate of the log marginal likelihood, l(θ): -1382.913
SQUAREM: 0 accelerations, 4 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 10
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1792.269
Gain in marginal log-likelihood, ΔQ: 0.0225
MCEM asymptotic standard error: 0.0229
Ascent lower and upper bound: [-0.00681, 0.0518]
Estimate of the log marginal likelihood, l(θ): -1382.875
SQUAREM: 0 accelerations, 5 fallbacks

Target ESS increased to 36.0 (growth factor 1.414).

Iteration: 11
Target ESS: 36.0 per-subject
Range of the number of sampled paths per-subject: [36.0, 50]
Estimate of the marginal log-likelihood, Q: -1792.183
Gain in marginal log-likelihood, ΔQ: 0.0123
MCEM asymptotic standard error: 0.0169
Ascent lower and upper bound: [-0.00928, 0.034]
Estimate of the log marginal likelihood, l(θ): -1382.855
SQUAREM: 0 accelerations, 5 fallbacks

The MCEM algorithm has converged.

  ✓ AFT effect with TVC MCEM fitting works
Test Summary:            | Pass  Total   Time
MCEM AFT Effect with TVC |    3      3  38.9s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -1897.358
Initial estimate of the log marginal likelihood: -1543.295

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1882.331
Gain in marginal log-likelihood, ΔQ: 15.0
MCEM asymptotic standard error: 0.331
Ascent lower and upper bound: [14.6, 15.5]
Estimate of the log marginal likelihood, l(θ): -1525.531
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1878.284
Gain in marginal log-likelihood, ΔQ: 0.972
MCEM asymptotic standard error: 0.125
Ascent lower and upper bound: [0.812, 1.13]
Estimate of the log marginal likelihood, l(θ): -1524.191
SQUAREM: 0 accelerations, 1 fallbacks

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1876.656
Gain in marginal log-likelihood, ΔQ: 0.163
MCEM asymptotic standard error: 0.0534
Ascent lower and upper bound: [0.0944, 0.231]
Estimate of the log marginal likelihood, l(θ): -1523.968
SQUAREM: 0 accelerations, 1 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1875.942
Gain in marginal log-likelihood, ΔQ: 0.0309
MCEM asymptotic standard error: 0.0236
Ascent lower and upper bound: [0.00064, 0.0612]
Estimate of the log marginal likelihood, l(θ): -1523.927
SQUAREM: 0 accelerations, 2 fallbacks

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1875.619
Gain in marginal log-likelihood, ΔQ: 0.00616
MCEM asymptotic standard error: 0.0106
Ascent lower and upper bound: [-0.00745, 0.0198]
Estimate of the log marginal likelihood, l(θ): -1523.92
SQUAREM: 0 accelerations, 2 fallbacks

The MCEM algorithm has converged.

  ✓ Spline + TVC MCEM fitting works
Test Summary:     | Pass  Total   Time
MCEM Spline + TVC |    5      5  29.9s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using phase-type proposal for MCEM importance sampling.

Using model's Markov surrogate for MCEM.

Phase-type surrogate configuration:
  n_phases per state: [3, 3, 1]
  Total expanded states: 7
  Phase-type surrogate built successfully.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -3996.396
Initial estimate of the log marginal likelihood: -2615.768

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3952.547
Gain in marginal log-likelihood, ΔQ: 43.8
MCEM asymptotic standard error: 0.636
Ascent lower and upper bound: [43.0, 44.7]
Estimate of the log marginal likelihood, l(θ): -2561.458
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3916.298
Gain in marginal log-likelihood, ΔQ: 4.38
MCEM asymptotic standard error: 0.252
Ascent lower and upper bound: [4.06, 4.71]
Estimate of the log marginal likelihood, l(θ): -2555.283
SQUAREM: 0 accelerations, 1 fallbacks

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3899.944
Gain in marginal log-likelihood, ΔQ: 0.841
MCEM asymptotic standard error: 0.111
Ascent lower and upper bound: [0.699, 0.984]
Estimate of the log marginal likelihood, l(θ): -2554.113
SQUAREM: 0 accelerations, 1 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3892.417
Gain in marginal log-likelihood, ΔQ: 0.165
MCEM asymptotic standard error: 0.0494
Ascent lower and upper bound: [0.102, 0.229]
Estimate of the log marginal likelihood, l(θ): -2553.895
SQUAREM: 0 accelerations, 2 fallbacks

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3889.003
Gain in marginal log-likelihood, ΔQ: 0.0324
MCEM asymptotic standard error: 0.0219
Ascent lower and upper bound: [0.00431, 0.0605]
Estimate of the log marginal likelihood, l(θ): -2553.858
SQUAREM: 0 accelerations, 2 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 6
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3887.479
Gain in marginal log-likelihood, ΔQ: 0.00634
MCEM asymptotic standard error: 0.00972
Ascent lower and upper bound: [-0.00611, 0.0188]
Estimate of the log marginal likelihood, l(θ): -2553.853
SQUAREM: 0 accelerations, 3 fallbacks

The MCEM algorithm has converged.


    Parameter Comparison: Weibull + TVC - PhaseType
    ----------------------------------------------------------------------
    Parameter         True        Estimated   Abs Diff    Rel Diff (%)
    ----------------------------------------------------------------------
    shape_12          1.3000      1.3507      0.0507      3.9%
    scale_12          0.1500      0.1509      0.0009      0.6%
    beta_12           0.5000      0.4373      0.0627      12.5%
    shape_23          1.4000      1.4325      0.0325      2.3%
    scale_23          0.2000      0.2160      0.0160      8.0%
    ----------------------------------------------------------------------
  ✓ Weibull + TVC with PhaseType proposal works
Test Summary:                           | Pass  Total   Time
MCEM Weibull + TVC - PhaseType Proposal |    5      5  46.9s
Using SQUAREM acceleration for MCEM.

Using adaptive SIR (will switch to lhs when cost-effective).

Using phase-type proposal for MCEM importance sampling.

Using model's Markov surrogate for MCEM.

Phase-type surrogate configuration:
  n_phases per state: [3, 1]
  Total expanded states: 4
  Phase-type surrogate built successfully.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -1905.65
Initial estimate of the log marginal likelihood: -1517.156

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1879.54
Gain in marginal log-likelihood, ΔQ: 26.1
MCEM asymptotic standard error: 0.352
Ascent lower and upper bound: [25.7, 26.6]
Estimate of the log marginal likelihood, l(θ): -1487.964
SQUAREM: 0 accelerations, 0 fallbacks

  [SQUAREM: no acceleration (Δ too small), using standard EM]

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1866.955
Gain in marginal log-likelihood, ΔQ: 0.597
MCEM asymptotic standard error: 0.0654
Ascent lower and upper bound: [0.513, 0.681]
Estimate of the log marginal likelihood, l(θ): -1487.265
SQUAREM: 0 accelerations, 1 fallbacks

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -1864.131
Gain in marginal log-likelihood, ΔQ: 0.0243
MCEM asymptotic standard error: 0.0136
Ascent lower and upper bound: [0.00698, 0.0417]
Estimate of the log marginal likelihood, l(θ): -1487.239
SQUAREM: 0 accelerations, 1 fallbacks

The MCEM algorithm has converged.

  ✓ Gompertz + TVC with PhaseType proposal works
Test Summary:                            | Pass  Total   Time
MCEM Gompertz + TVC - PhaseType Proposal |    4      4  14.8s

=== TVC Long Test Suite Complete ===

Tests verify fitting for:
  - Markov Panel Exponential + TVC
  - Binary TVC (treatment switch)
  - Continuous TVC (biomarker)
  - Weibull + TVC (semi-Markov)
  - Gompertz + TVC (aging + treatment)
  - Progressive 3-state model with TVC
  - Multiple TVC change points
  - AFT effect with TVC
  - Spline + TVC
  - Weibull + TVC with PhaseType proposal
  - Gompertz + TVC with PhaseType proposal
