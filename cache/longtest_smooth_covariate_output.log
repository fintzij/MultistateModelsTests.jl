======================================================================
Running Smooth Covariate Recovery Long Test
======================================================================

======================================================================
Test: Sinusoidal Effect Recovery
  f(x) = sin(2πx)
  h(t|x) = 0.5 * exp(f(x))
  n = 500, k = 10
======================================================================
  Events: 478 / 500 (95.6%)
  Fitting with SplinePenalty and automatic λ selection...

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

  Log-likelihood: -809.82

    Smooth Effect Comparison: Sinusoidal
    ----------------------------------------------------------------------
    x           f(x) true   f̂(x)        Error
    ----------------------------------------------------------------------
    0.05        +0.3145      +1.0119      +0.6974
    0.15        +0.8106      +0.8194      +0.0088
    0.25        +1.0000      +0.6189      -0.3811
    0.35        +0.8109      +0.3982      -0.4127
    0.45        +0.3150      +0.1541      -0.1608
    0.55        -0.3001      -0.1053      +0.1948
    0.65        -0.8017      -0.3642      +0.4375
    0.75        -0.9999      -0.6118      +0.3881
    0.85        -0.8198      -0.8464      -0.0266
    0.95        -0.3294      -1.0747      -0.7454
    ----------------------------------------------------------------------
    Max Abs Error: 0.7454
    RMSE:          0.4200
  ✓ Sinusoidal effect recovered within tolerance
Test Summary:                       | Pass  Total   Time
Smooth Covariate: Sinusoidal Effect |    3      3  26.5s

======================================================================
Test: Quadratic Effect Recovery
  f(x) = x² - 1/3 (centered)
  h(t|x) = 0.5 * exp(f(x))
  n = 500, k = 8
======================================================================
  Events: 496 / 500 (99.2%)
  Fitting with SplinePenalty and automatic λ selection...
  Log-likelihood: -862.85

    Smooth Effect Comparison: Quadratic
    ----------------------------------------------------------------------
    x           f(x) true   f̂(x)        Error
    ----------------------------------------------------------------------
    0.05        -0.3293      -0.5045      -0.1752
    0.15        -0.3091      -0.4219      -0.1129
    0.25        -0.2690      -0.3360      -0.0669
    0.35        -0.2091      -0.2397      -0.0306
    0.45        -0.1293      -0.1231      +0.0062
    0.55        -0.0296      +0.0148      +0.0444
    0.65        +0.0899      +0.1656      +0.0758
    0.75        +0.2293      +0.3228      +0.0935
    0.85        +0.3886      +0.4817      +0.0931
    0.95        +0.5677      +0.6403      +0.0726
    ----------------------------------------------------------------------
    Max Abs Error: 0.1752
    RMSE:          0.0890
  ✓ Quadratic effect recovered within tolerance
Test Summary:                      | Pass  Total  Time
Smooth Covariate: Quadratic Effect |    3      3  4.3s

======================================================================
Test: Sigmoid Effect Recovery
  f(x) = tanh(5(x - 0.5))
  h(t|x) = 0.5 * exp(f(x))
  n = 500, k = 12
======================================================================
  Events: 475 / 500 (95.0%)
  Fitting with SplinePenalty and automatic λ selection...
  Log-likelihood: -803.69

    Smooth Effect Comparison: Sigmoid
    ----------------------------------------------------------------------
    x           f(x) true   f̂(x)        Error
    ----------------------------------------------------------------------
    0.05        -0.9786      -1.2446      -0.2660
    0.12        -0.9590      -1.0717      -0.1126
    0.18        -0.9229      -0.8982      +0.0247
    0.24        -0.8578      -0.7223      +0.1356
    0.31        -0.7456      -0.5420      +0.2036
    0.37        -0.5658      -0.3571      +0.2086
    0.44        -0.3095      -0.1692      +0.1402
    0.50        +0.0011      +0.0186      +0.0174
    0.56        +0.3114      +0.2035      -0.1079
    0.63        +0.5668      +0.3833      -0.1835
    ----------------------------------------------------------------------
    Max Abs Error: 0.2660
    RMSE:          0.1553
  ✓ Sigmoid effect recovered within tolerance
Test Summary:                    | Pass  Total  Time
Smooth Covariate: Sigmoid Effect |    3      3  3.9s

======================================================================
Test: Combined Smooth + Linear Effect
  f(x) = sin(2πx)
  h(t|x,trt) = 0.5 * exp(f(x) + 0.5 * trt)
  n = 500, k = 10
======================================================================
  Events: 481 / 500 (96.2%)
  Fitting with SplinePenalty...
  Log-likelihood: -711.55
  Treatment effect: true=0.5, estimated=0.597

    Smooth Effect Comparison: Smooth (with trt)
    ----------------------------------------------------------------------
    x           f(x) true   f̂(x)        Error
    ----------------------------------------------------------------------
    0.05        +0.3309      +0.9874      +0.6565
    0.15        +0.8201      +0.7973      -0.0228
    0.25        +0.9999      +0.5997      -0.4002
    0.35        +0.8025      +0.3823      -0.4203
    0.45        +0.3024      +0.1419      -0.1605
    0.55        -0.3118      -0.1118      +0.2000
    0.65        -0.8084      -0.3591      +0.4493
    0.75        -1.0000      -0.5923      +0.4076
    0.85        -0.8143      -0.8140      +0.0002
    0.95        -0.3214      -1.0313      -0.7100
    ----------------------------------------------------------------------
    Max Abs Error: 0.7100
    RMSE:          0.4131
  ✓ Combined smooth + linear effect recovered
Test Summary:                       | Pass  Total   Time
Smooth Covariate: s(x) + Linear trt |    4      4  14.9s

======================================================================
SMOOTH COVARIATE RECOVERY TESTS COMPLETE
======================================================================
