
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

  ✓ Markov Panel Exponential + TVC fitting works
Test Summary:                  | Pass  Total   Time
Markov Panel Exponential + TVC |    6      6  30.4s
Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -4079.559
Initial estimate of the log marginal likelihood: -3216.752

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4037.364
Gain in marginal log-likelihood, ΔQ: 42.2
MCEM asymptotic standard error: 0.231
Ascent lower and upper bound: [41.9, 42.5]
Estimate of the log marginal likelihood, l(θ): -3172.383

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4039.981
Gain in marginal log-likelihood, ΔQ: 1.25
MCEM asymptotic standard error: 0.165
Ascent lower and upper bound: [1.04, 1.46]
Estimate of the log marginal likelihood, l(θ): -3170.253

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4038.225
Gain in marginal log-likelihood, ΔQ: 0.602
MCEM asymptotic standard error: 0.119
Ascent lower and upper bound: [0.449, 0.754]
Estimate of the log marginal likelihood, l(θ): -3169.221

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4036.319
Gain in marginal log-likelihood, ΔQ: 0.299
MCEM asymptotic standard error: 0.0861
Ascent lower and upper bound: [0.189, 0.409]
Estimate of the log marginal likelihood, l(θ): -3168.706

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4034.648
Gain in marginal log-likelihood, ΔQ: 0.151
MCEM asymptotic standard error: 0.0625
Ascent lower and upper bound: [0.0713, 0.232]
Estimate of the log marginal likelihood, l(θ): -3168.445

Iteration: 6
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4033.288
Gain in marginal log-likelihood, ΔQ: 0.0777
MCEM asymptotic standard error: 0.0455
Ascent lower and upper bound: [0.0194, 0.136]
Estimate of the log marginal likelihood, l(θ): -3168.311

Iteration: 7
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4032.224
Gain in marginal log-likelihood, ΔQ: 0.0402
MCEM asymptotic standard error: 0.0331
Ascent lower and upper bound: [-0.00221, 0.0826]
Estimate of the log marginal likelihood, l(θ): -3168.241

Target ESS increased to 36.0 (growth factor 1.414).

Iteration: 8
Target ESS: 36.0 per-subject
Range of the number of sampled paths per-subject: [36.0, 50]
Estimate of the marginal log-likelihood, Q: -4031.411
Gain in marginal log-likelihood, ΔQ: 0.021
MCEM asymptotic standard error: 0.0241
Ascent lower and upper bound: [-0.00993, 0.0518]
Estimate of the log marginal likelihood, l(θ): -3168.205

Target ESS increased to 51.0 (growth factor 1.414).

Iteration: 9
Target ESS: 51.0 per-subject
Range of the number of sampled paths per-subject: [51.0, 60]
Estimate of the marginal log-likelihood, Q: -4031.038
Gain in marginal log-likelihood, ΔQ: 0.0163
MCEM asymptotic standard error: 0.0196
Ascent lower and upper bound: [-0.00882, 0.0415]
Estimate of the log marginal likelihood, l(θ): -3168.195

The MCEM algorithm has converged.

  ✓ Binary TVC (treatment switch) MCEM fitting works
Test Summary:                           | Pass  Total     Time
MCEM with Binary TVC (Treatment Switch) |    9      9  1m34.4s
Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -3917.776
Initial estimate of the log marginal likelihood: -3115.493

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3761.979
Gain in marginal log-likelihood, ΔQ: 156.0
MCEM asymptotic standard error: 0.386
Ascent lower and upper bound: [155.0, 156.0]
Estimate of the log marginal likelihood, l(θ): -2955.001

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3772.889
Gain in marginal log-likelihood, ΔQ: 0.933
MCEM asymptotic standard error: 0.143
Ascent lower and upper bound: [0.75, 1.12]
Estimate of the log marginal likelihood, l(θ): -2953.438

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3770.847
Gain in marginal log-likelihood, ΔQ: 0.459
MCEM asymptotic standard error: 0.109
Ascent lower and upper bound: [0.319, 0.599]
Estimate of the log marginal likelihood, l(θ): -2952.63

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3768.51
Gain in marginal log-likelihood, ΔQ: 0.259
MCEM asymptotic standard error: 0.0839
Ascent lower and upper bound: [0.151, 0.366]
Estimate of the log marginal likelihood, l(θ): -2952.174

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3766.429
Gain in marginal log-likelihood, ΔQ: 0.147
MCEM asymptotic standard error: 0.0645
Ascent lower and upper bound: [0.0647, 0.23]
Estimate of the log marginal likelihood, l(θ): -2951.914

Iteration: 6
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3764.672
Gain in marginal log-likelihood, ΔQ: 0.0846
MCEM asymptotic standard error: 0.0497
Ascent lower and upper bound: [0.021, 0.148]
Estimate of the log marginal likelihood, l(θ): -2951.764

Iteration: 7
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3763.231
Gain in marginal log-likelihood, ΔQ: 0.0489
MCEM asymptotic standard error: 0.0382
Ascent lower and upper bound: [-5.89e-5, 0.0978]
Estimate of the log marginal likelihood, l(θ): -2951.678

Target ESS increased to 36.0 (growth factor 1.414).

Iteration: 8
Target ESS: 36.0 per-subject
Range of the number of sampled paths per-subject: [36.0, 50]
Estimate of the marginal log-likelihood, Q: -3762.073
Gain in marginal log-likelihood, ΔQ: 0.0283
MCEM asymptotic standard error: 0.0294
Ascent lower and upper bound: [-0.00927, 0.066]
Estimate of the log marginal likelihood, l(θ): -2951.628

Target ESS increased to 51.0 (growth factor 1.414).

Iteration: 9
Target ESS: 51.0 per-subject
Range of the number of sampled paths per-subject: [51.0, 60]
Estimate of the marginal log-likelihood, Q: -3761.557
Gain in marginal log-likelihood, ΔQ: 0.0057
MCEM asymptotic standard error: 0.0121
Ascent lower and upper bound: [-0.00978, 0.0212]
Estimate of the log marginal likelihood, l(θ): -2951.637

The MCEM algorithm has converged.

  ✓ Continuous TVC (biomarker) MCEM fitting works
Test Summary:                        | Pass  Total     Time
MCEM with Continuous TVC (Biomarker) |    7      7  2m20.9s
Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 30.0 per-subject
Initial range of the number of sample paths per-subject: [30, 50]
Initial estimate of the marginal log-likelihood, Q: -4452.048
Initial estimate of the log marginal likelihood: -2904.737

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -4401.922
Gain in marginal log-likelihood, ΔQ: 50.1
MCEM asymptotic standard error: 0.151
Ascent lower and upper bound: [49.9, 50.3]
Estimate of the log marginal likelihood, l(θ): -2853.93

Iteration: 2
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -4409.229
Gain in marginal log-likelihood, ΔQ: 0.0472
MCEM asymptotic standard error: 0.0259
Ascent lower and upper bound: [0.014, 0.0803]
Estimate of the log marginal likelihood, l(θ): -2853.857

Iteration: 3
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -4409.909
Gain in marginal log-likelihood, ΔQ: 0.0165
MCEM asymptotic standard error: 0.0195
Ascent lower and upper bound: [-0.00846, 0.0415]
Estimate of the log marginal likelihood, l(θ): -2853.826

The MCEM algorithm has converged.

  ✓ Weibull + TVC (semi-Markov) MCEM fitting works
Test Summary:                    | Pass  Total   Time
MCEM Weibull + TVC (Semi-Markov) |    6      6  51.8s
Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -5084.337
Initial estimate of the log marginal likelihood: -3425.443

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4996.618
Gain in marginal log-likelihood, ΔQ: 87.7
MCEM asymptotic standard error: 0.409
Ascent lower and upper bound: [87.2, 88.2]
Estimate of the log marginal likelihood, l(θ): -3333.212

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -5002.116
Gain in marginal log-likelihood, ΔQ: 0.181
MCEM asymptotic standard error: 0.0196
Ascent lower and upper bound: [0.156, 0.207]
Estimate of the log marginal likelihood, l(θ): -3333.025

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -5002.164
Gain in marginal log-likelihood, ΔQ: 0.000705
MCEM asymptotic standard error: 0.00161
Ascent lower and upper bound: [-0.00136, 0.00277]
Estimate of the log marginal likelihood, l(θ): -3333.024

The MCEM algorithm has converged.

  ✓ Gompertz + TVC (aging + treatment) MCEM fitting works
Test Summary:                           | Pass  Total   Time
MCEM Gompertz + TVC (Aging + Treatment) |    3      3  43.6s
Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 30.0 per-subject
Initial range of the number of sample paths per-subject: [30, 50]
Initial estimate of the marginal log-likelihood, Q: -7193.13
Initial estimate of the log marginal likelihood: -5847.663

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -6866.649
Gain in marginal log-likelihood, ΔQ: 326.0
MCEM asymptotic standard error: 0.487
Ascent lower and upper bound: [326.0, 327.0]
Estimate of the log marginal likelihood, l(θ): -5512.776

Iteration: 2
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -6865.703
Gain in marginal log-likelihood, ΔQ: 2.13
MCEM asymptotic standard error: 0.17
Ascent lower and upper bound: [1.92, 2.35]
Estimate of the log marginal likelihood, l(θ): -5509.851

Iteration: 3
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -6865.01
Gain in marginal log-likelihood, ΔQ: 0.296
MCEM asymptotic standard error: 0.0688
Ascent lower and upper bound: [0.208, 0.385]
Estimate of the log marginal likelihood, l(θ): -5509.438

Iteration: 4
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -6864.796
Gain in marginal log-likelihood, ΔQ: 0.0463
MCEM asymptotic standard error: 0.0283
Ascent lower and upper bound: [0.01, 0.0825]
Estimate of the log marginal likelihood, l(θ): -5509.373

Iteration: 5
Target ESS: 30.0 per-subject
Range of the number of sampled paths per-subject: [30, 50]
Estimate of the marginal log-likelihood, Q: -6864.764
Gain in marginal log-likelihood, ΔQ: 0.00775
MCEM asymptotic standard error: 0.0119
Ascent lower and upper bound: [-0.00748, 0.023]
Estimate of the log marginal likelihood, l(θ): -5509.363

The MCEM algorithm has converged.


    Parameter Comparison: Progressive with TVC
    ----------------------------------------------------------------------
    Parameter         True        Estimated   Abs Diff    Rel Diff (%)
    ----------------------------------------------------------------------
    shape_12          1.0000      0.9545      0.0455      4.6%
    scale_12          0.1500      0.1610      0.0110      7.3%
    beta_12           0.3000      0.3273      0.0273      9.1%
    shape_23          1.0000      0.9484      0.0516      5.2%
    scale_23          0.2500      0.2617      0.0117      4.7%
    beta_23           0.4000      0.3430      0.0570      14.3%
    ----------------------------------------------------------------------
  ✓ Progressive model with TVC MCEM fitting works
Test Summary:             | Pass  Total     Time
MCEM Progressive with TVC |    4      4  4m44.7s
Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -4581.63
Initial estimate of the log marginal likelihood: -4037.405

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4355.738
Gain in marginal log-likelihood, ΔQ: 226.0
MCEM asymptotic standard error: 0.43
Ascent lower and upper bound: [225.0, 226.0]
Estimate of the log marginal likelihood, l(θ): -3805.14

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4357.146
Gain in marginal log-likelihood, ΔQ: 2.05
MCEM asymptotic standard error: 0.191
Ascent lower and upper bound: [1.81, 2.3]
Estimate of the log marginal likelihood, l(θ): -3802.025

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4353.415
Gain in marginal log-likelihood, ΔQ: 0.545
MCEM asymptotic standard error: 0.105
Ascent lower and upper bound: [0.41, 0.679]
Estimate of the log marginal likelihood, l(θ): -3801.191

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4351.011
Gain in marginal log-likelihood, ΔQ: 0.154
MCEM asymptotic standard error: 0.0578
Ascent lower and upper bound: [0.0798, 0.228]
Estimate of the log marginal likelihood, l(θ): -3800.955

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4349.596
Gain in marginal log-likelihood, ΔQ: 0.0447
MCEM asymptotic standard error: 0.0317
Ascent lower and upper bound: [0.00399, 0.0853]
Estimate of the log marginal likelihood, l(θ): -3800.887

Iteration: 6
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -4348.795
Gain in marginal log-likelihood, ΔQ: 0.013
MCEM asymptotic standard error: 0.0173
Ascent lower and upper bound: [-0.00916, 0.0352]
Estimate of the log marginal likelihood, l(θ): -3800.868

The MCEM algorithm has converged.

  ✓ Multiple TVC change points MCEM fitting works
Test Summary:                   | Pass  Total     Time
MCEM Multiple TVC Change Points |    3      3  3m20.9s
Using adaptive SIR (will switch to lhs when cost-effective).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -3692.219
Initial estimate of the log marginal likelihood: -2868.207

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3575.034
Gain in marginal log-likelihood, ΔQ: 117.0
MCEM asymptotic standard error: 0.366
Ascent lower and upper bound: [117.0, 118.0]
Estimate of the log marginal likelihood, l(θ): -2747.54

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3587.053
Gain in marginal log-likelihood, ΔQ: 0.21
MCEM asymptotic standard error: 0.0592
Ascent lower and upper bound: [0.134, 0.286]
Estimate of the log marginal likelihood, l(θ): -2747.229

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3587.54
Gain in marginal log-likelihood, ΔQ: 0.0784
MCEM asymptotic standard error: 0.0438
Ascent lower and upper bound: [0.0222, 0.135]
Estimate of the log marginal likelihood, l(θ): -2747.095

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3587.657
Gain in marginal log-likelihood, ΔQ: 0.0448
MCEM asymptotic standard error: 0.033
Ascent lower and upper bound: [0.0026, 0.0871]
Estimate of the log marginal likelihood, l(θ): -2747.018

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3587.694
Gain in marginal log-likelihood, ΔQ: 0.0256
MCEM asymptotic standard error: 0.0248
Ascent lower and upper bound: [-0.0062, 0.0573]
Estimate of the log marginal likelihood, l(θ): -2746.976

Target ESS increased to 36.0 (growth factor 1.414).

Iteration: 6
Target ESS: 36.0 per-subject
Range of the number of sampled paths per-subject: [36.0, 50]
Estimate of the marginal log-likelihood, Q: -3587.696
Gain in marginal log-likelihood, ΔQ: 0.0145
MCEM asymptotic standard error: 0.0186
Ascent lower and upper bound: [-0.00934, 0.0384]
Estimate of the log marginal likelihood, l(θ): -2746.952

The MCEM algorithm has converged.

  ✓ AFT effect with TVC MCEM fitting works
Test Summary:            | Pass  Total     Time
MCEM AFT Effect with TVC |    3      3  3m20.2s
Using adaptive SIR (will switch to lhs when cost-effective).

Using penalized likelihood with 1 smoothing parameter(s).

Using model's Markov surrogate for MCEM.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -4044.429
Initial estimate of the log marginal likelihood: -3327.324

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3764.606
Gain in marginal log-likelihood, ΔQ: 280.0
MCEM asymptotic standard error: 0.521
Ascent lower and upper bound: [279.0, 280.0]
Estimate of the log marginal likelihood, l(θ): -3039.341

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3776.855
Gain in marginal log-likelihood, ΔQ: 0.179
MCEM asymptotic standard error: 0.0378
Ascent lower and upper bound: [0.131, 0.227]
Estimate of the log marginal likelihood, l(θ): -3039.134

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3777.452
Gain in marginal log-likelihood, ΔQ: 0.0109
MCEM asymptotic standard error: 0.0127
Ascent lower and upper bound: [-0.00544, 0.0271]
Estimate of the log marginal likelihood, l(θ): -3039.122

The MCEM algorithm has converged.

  ✓ Spline + TVC MCEM fitting works
Test Summary:     | Pass  Total     Time
MCEM Spline + TVC |    5      5  2m10.6s
Using adaptive SIR (will switch to lhs when cost-effective).

Using phase-type proposal for MCEM importance sampling.

Using model's Markov surrogate for MCEM.

Phase-type surrogate configuration:
  n_phases per state: [3, 3, 1]
  Total expanded states: 7
  Phase-type surrogate built successfully.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -7916.083
Initial estimate of the log marginal likelihood: -5312.796

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -7850.753
Gain in marginal log-likelihood, ΔQ: 65.3
MCEM asymptotic standard error: 0.696
Ascent lower and upper bound: [64.4, 66.2]
Estimate of the log marginal likelihood, l(θ): -5234.452

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -7774.122
Gain in marginal log-likelihood, ΔQ: 4.96
MCEM asymptotic standard error: 0.263
Ascent lower and upper bound: [4.62, 5.3]
Estimate of the log marginal likelihood, l(θ): -5227.589

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -7745.07
Gain in marginal log-likelihood, ΔQ: 0.916
MCEM asymptotic standard error: 0.116
Ascent lower and upper bound: [0.767, 1.06]
Estimate of the log marginal likelihood, l(θ): -5226.349

Iteration: 4
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -7732.732
Gain in marginal log-likelihood, ΔQ: 0.18
MCEM asymptotic standard error: 0.052
Ascent lower and upper bound: [0.113, 0.246]
Estimate of the log marginal likelihood, l(θ): -5226.125

Iteration: 5
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -7727.396
Gain in marginal log-likelihood, ΔQ: 0.0363
MCEM asymptotic standard error: 0.0237
Ascent lower and upper bound: [0.00589, 0.0666]
Estimate of the log marginal likelihood, l(θ): -5226.089

Iteration: 6
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -7725.095
Gain in marginal log-likelihood, ΔQ: 0.00765
MCEM asymptotic standard error: 0.0111
Ascent lower and upper bound: [-0.00657, 0.0219]
Estimate of the log marginal likelihood, l(θ): -5226.085

The MCEM algorithm has converged.


    Parameter Comparison: Weibull + TVC - PhaseType
    ----------------------------------------------------------------------
    Parameter         True        Estimated   Abs Diff    Rel Diff (%)
    ----------------------------------------------------------------------
    shape_12          1.3000      1.4578      0.1578      12.1%
    scale_12          0.1500      0.1223      0.0277      18.5%
    beta_12           0.5000      0.3969      0.1031      20.6%
    shape_23          1.4000      1.4477      0.0477      3.4%
    scale_23          0.2000      0.2189      0.0189      9.4%
    ----------------------------------------------------------------------
  ✓ Weibull + TVC with PhaseType proposal works
Test Summary:                           | Pass  Total     Time
MCEM Weibull + TVC - PhaseType Proposal |    5      5  1m32.6s
Using adaptive SIR (will switch to lhs when cost-effective).

Using phase-type proposal for MCEM importance sampling.

Using model's Markov surrogate for MCEM.

Phase-type surrogate configuration:
  n_phases per state: [3, 1]
  Total expanded states: 4
  Phase-type surrogate built successfully.

Initializing sample paths ...

Initial target ESS: 25.0 per-subject
Initial range of the number of sample paths per-subject: [25, 50]
Initial estimate of the marginal log-likelihood, Q: -3848.297
Initial estimate of the log marginal likelihood: -3056.2

Starting Monte Carlo EM...

Iteration: 1
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3830.521
Gain in marginal log-likelihood, ΔQ: 17.8
MCEM asymptotic standard error: 0.298
Ascent lower and upper bound: [17.4, 18.2]
Estimate of the log marginal likelihood, l(θ): -3036.148

Iteration: 2
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3818.258
Gain in marginal log-likelihood, ΔQ: 0.398
MCEM asymptotic standard error: 0.0506
Ascent lower and upper bound: [0.333, 0.462]
Estimate of the log marginal likelihood, l(θ): -3035.688

Iteration: 3
Target ESS: 25.0 per-subject
Range of the number of sampled paths per-subject: [25, 50]
Estimate of the marginal log-likelihood, Q: -3815.715
Gain in marginal log-likelihood, ΔQ: 0.013
MCEM asymptotic standard error: 0.00932
Ascent lower and upper bound: [0.00107, 0.025]
Estimate of the log marginal likelihood, l(θ): -3035.675

The MCEM algorithm has converged.

  ✓ Gompertz + TVC with PhaseType proposal works
Test Summary:                            | Pass  Total   Time
MCEM Gompertz + TVC - PhaseType Proposal |    4      4  31.6s

=== TVC Long Test Suite Complete ===

Tests verify fitting for:
  - Markov Panel Exponential + TVC
  - Binary TVC (treatment switch)
  - Continuous TVC (biomarker)
  - Weibull + TVC (semi-Markov)
  - Gompertz + TVC (aging + treatment)
  - Progressive 3-state model with TVC
  - Multiple TVC change points
  - AFT effect with TVC
  - Spline + TVC
  - Weibull + TVC with PhaseType proposal
  - Gompertz + TVC with PhaseType proposal
