
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************


======================================================================
Phase-Type Hazard Models: Panel & Mixed Data Long Tests
======================================================================
Testing inference for Coxian phase-type models with intermittent observations.
These models are Markov on expanded state space → direct likelihood (no MCEM).
Default sample size: n=1000

--- Simple 2-State Phase-Type with Panel Data ---
Observed states: 2, Expanded phases: 3
State 1 → phases 1:2
State 2 → phases 3:3
True rates: [0.4, 0.2, 0.5]
Observation times: [0.0, 2.5, 5.0, 7.5, 10.0]
Simulated 1662 exact observations
Converted to 4000 panel observations
Panel data: 985 state changes observed, 3329 absorptions

Fitting phase-type model with panel data...
True params (natural): [0.4, 0.2, 0.5]
Fitted params (log): [0.432, 0.217, 0.52]
Test Summary:                          | Pass  Total   Time
Phase-Type Panel: Simple 2-State Model |    5      5  37.4s

--- Illness-Death Phase-Type with Panel Data ---
Observed states: 3, Expanded phases: 5
True rates: [0.5, 0.3, 0.35, 0.4, 0.25, 0.2, 0.3, 0.35]
Number of hazards: 8
Sample size: 1000
Panel observations: 2046 rows

Fitting illness-death phase-type model with panel data...
True params (natural): [0.5, 0.3, 0.35, 0.4, 0.25, 0.2, 0.3, 0.35]
Fitted params (log): [0.535, 0.294, 0.356, 0.386, 0.283, 0.208, 0.29, 0.353]
Test Summary:                         | Pass  Total   Time
Phase-Type Panel: Illness-Death Model |    1      1  13.8s

--- Mixed Exact + Panel Data ---
Some subjects observed exactly, others at panel times
Template: 600 exact + 400 panel subjects
True rates: [0.35, 0.25, 0.45]
Simulated: 959 exact + 664 panel observations

Fitting with mixed observation types...
True params (natural): [0.35, 0.25, 0.45]
Fitted params (log): [0.354, 0.246, 0.453]

Comparison of estimation approaches:
  Exact-only:  [0.359, 0.24, 0.435]
  Panel-only:  [0.338, 0.261, 0.482]
  Mixed:       [0.354, 0.246, 0.453]
  True:        [0.35, 0.25, 0.45]
Test Summary:                        | Pass  Total   Time
Phase-Type Mixed: Exact + Panel Data |    4      4  26.4s

--- Structured Mixed Observations ---
First half of subjects: exact observations
Second half of subjects: panel observations
Absorbing phase: 3
Simulated: 805 exact + 822 panel observations

Fitting with structured mixed observations...
True params (natural): [0.4, 0.25, 0.5]
Fitted params (log): [0.386, 0.25, 0.484]
Test Summary:                                  | Pass  Total  Time
Phase-Type Mixed: Structured Mixed Observation |    1      1  8.6s

--- Distributional Fidelity: Panel vs Exact ---
  Quantiles (true → fitted from panel):
    25th: 0.999 → 0.953
    50th: 1.95 → 2.137
    75th: 3.601 → 3.785
    90th: 5.703 → 6.149
Test Summary:                       | Pass  Total  Time
Distributional Fidelity: Panel Data |    1      1  2.7s

======================================================================
Phase-Type Panel & Mixed Data Long Tests Complete
======================================================================

This test suite validated:
  1. Simple 2-state phase-type with panel data
  2. Illness-death phase-type with panel data
  3. Mixed exact + panel observations
  4. Illness-death with exactly observed absorptions
  5. Distributional fidelity for panel data fitting
  6. Phase-type with fixed covariates (panel data) - DISABLED
  7. Phase-type with time-varying covariates (panel data) - DISABLED

Key insight: Phase-type hazard models remain Markov on expanded space,
so panel data can be fit with direct likelihood (no MCEM needed).
======================================================================
