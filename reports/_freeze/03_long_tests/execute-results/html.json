{
  "hash": "6b005d091772c1b3d2ace0c2f42f1402",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Long Tests Status\"\nsubtitle: \"Statistical Recovery of Parameters\"\ndate: last-modified\nformat:\n  html:\n    toc: true\n    toc-depth: 4\n    toc-expand: 1\n    code-fold: true\n---\n\n\n\n## 1. Overview\n\nAll long tests validate statistical parameter recovery with relative tolerances\nof 15-35% depending on the complexity of the model and inference method.\n\n**Last full run**: January 23, 2026  \n**Branch**: `penalized_splines`\n\n::: {.callout-note}\n## Test Suite Cleanup (2026-01-23)\n\nLong test suite consolidated from 24 files to 13 files. Deleted redundant/deprecated tests:\n`longtest_aft_suite.jl`, `longtest_sir.jl`, `longtest_phasetype.jl`, `longtest_pijcv_loocv.jl`,\n`longtest_sensitivity_check.jl`, `longtest_smooth_covariate_recovery.jl`,\n`longtest_tensor_product_recovery.jl`, `longtest_spline_suite.jl`.\n\nHelper files moved to `src/`: `longtest_config.jl`, `longtest_helpers.jl`, `phasetype_longtest_helpers.jl`.\n:::\n\n### 1.1 Overall Status\n\n| Test Suite | File | Status |\n|------------|------|--------|\n| Parametric Suite | `longtest_parametric_suite.jl` | ✅ |\n| Exact Markov | `longtest_exact_markov.jl` | ✅ |\n| MCEM Parametric | `longtest_mcem.jl` | ✅ |\n| MCEM Splines | `longtest_mcem_splines.jl` | ✅ |\n| MCEM TVC | `longtest_mcem_tvc.jl` | ✅ |\n| Phase-Type Exact | `longtest_phasetype_exact.jl` | ✅ |\n| Phase-Type Panel | `longtest_phasetype_panel.jl` | ✅ |\n| Robust Parametric | `longtest_robust_parametric.jl` | ✅ |\n| Robust Markov/PT | `longtest_robust_markov_phasetype.jl` | ✅ |\n| Simulation Dist | `longtest_simulation_distribution.jl` | ✅ |\n| Simulation TVC | `longtest_simulation_tvc.jl` | ✅ |\n| Spline Exact | `longtest_spline_exact.jl` | ✅ |\n| Variance Validation | `longtest_variance_validation.jl` | ✅ |\n\n**Total**: 13 long test files\n\n---\n\n## 2. Exponential Hazard Models\n\n### 2.1 exp_exact_nocov\n\n**Test**: exp_exact_nocov | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1506</td>\n      <td style = \"text-align: right;\">0.0053</td>\n      <td style = \"text-align: right;\">0.137</td>\n      <td style = \"text-align: right;\">0.1641</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1281</td>\n      <td style = \"text-align: right;\">0.0052</td>\n      <td style = \"text-align: right;\">0.1146</td>\n      <td style = \"text-align: right;\">0.1415</td>\n      <td style = \"text-align: right;\">6.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-exp-exact-nocov-ci .cell execution_count=3}\n\n::: {.cell-output .cell-output-display execution_count=4}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-exp-exact-nocov-ci-output-1.svg){#fig-exp-exact-nocov-ci}\n:::\n:::\n\n\n::: {#cell-fig-exp-exact-nocov-prev .cell execution_count=4}\n\n::: {.cell-output .cell-output-display execution_count=5}\n![State Prevalence](03_long_tests_files/figure-html/fig-exp-exact-nocov-prev-output-1.svg){#fig-exp-exact-nocov-prev}\n:::\n:::\n\n\n### 2.2 exp_exact_fixed\n\n**Test**: exp_exact_fixed | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.3753</td>\n      <td style = \"text-align: right;\">0.0632</td>\n      <td style = \"text-align: right;\">0.2126</td>\n      <td style = \"text-align: right;\">0.538</td>\n      <td style = \"text-align: right;\">24.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1588</td>\n      <td style = \"text-align: right;\">0.0068</td>\n      <td style = \"text-align: right;\">0.1412</td>\n      <td style = \"text-align: right;\">0.1764</td>\n      <td style = \"text-align: right;\">5.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.3806</td>\n      <td style = \"text-align: right;\">0.0761</td>\n      <td style = \"text-align: right;\">0.1846</td>\n      <td style = \"text-align: right;\">0.5765</td>\n      <td style = \"text-align: right;\">23.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1221</td>\n      <td style = \"text-align: right;\">0.0067</td>\n      <td style = \"text-align: right;\">0.1048</td>\n      <td style = \"text-align: right;\">0.1394</td>\n      <td style = \"text-align: right;\">1.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-exp-exact-fixed-ci .cell execution_count=6}\n\n::: {.cell-output .cell-output-display execution_count=7}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-exp-exact-fixed-ci-output-1.svg){#fig-exp-exact-fixed-ci}\n:::\n:::\n\n\n::: {#cell-fig-exp-exact-fixed-prev .cell execution_count=7}\n\n::: {.cell-output .cell-output-display execution_count=8}\n![State Prevalence](03_long_tests_files/figure-html/fig-exp-exact-fixed-prev-output-1.svg){#fig-exp-exact-fixed-prev}\n:::\n:::\n\n\n### 2.3 exp_exact_tvc\n\n**Test**: exp_exact_tvc | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4832</td>\n      <td style = \"text-align: right;\">0.0633</td>\n      <td style = \"text-align: right;\">0.3202</td>\n      <td style = \"text-align: right;\">0.6462</td>\n      <td style = \"text-align: right;\">3.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1493</td>\n      <td style = \"text-align: right;\">0.0064</td>\n      <td style = \"text-align: right;\">0.1327</td>\n      <td style = \"text-align: right;\">0.1659</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5306</td>\n      <td style = \"text-align: right;\">0.0943</td>\n      <td style = \"text-align: right;\">0.2877</td>\n      <td style = \"text-align: right;\">0.7734</td>\n      <td style = \"text-align: right;\">6.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1165</td>\n      <td style = \"text-align: right;\">0.01</td>\n      <td style = \"text-align: right;\">0.0908</td>\n      <td style = \"text-align: right;\">0.1421</td>\n      <td style = \"text-align: right;\">2.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-exp-exact-tvc-ci .cell execution_count=9}\n\n::: {.cell-output .cell-output-display execution_count=10}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-exp-exact-tvc-ci-output-1.svg){#fig-exp-exact-tvc-ci}\n:::\n:::\n\n\n::: {#cell-fig-exp-exact-tvc-prev .cell execution_count=10}\n\n::: {.cell-output .cell-output-display execution_count=11}\n![State Prevalence](03_long_tests_files/figure-html/fig-exp-exact-tvc-prev-output-1.svg){#fig-exp-exact-tvc-prev}\n:::\n:::\n\n\n### 2.4 exp_panel_nocov\n\n**Test**: exp_panel_nocov | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1558</td>\n      <td style = \"text-align: right;\">0.0054</td>\n      <td style = \"text-align: right;\">0.1419</td>\n      <td style = \"text-align: right;\">0.1697</td>\n      <td style = \"text-align: right;\">3.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1175</td>\n      <td style = \"text-align: right;\">0.0059</td>\n      <td style = \"text-align: right;\">0.1022</td>\n      <td style = \"text-align: right;\">0.1328</td>\n      <td style = \"text-align: right;\">2.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-exp-panel-nocov-ci .cell execution_count=12}\n\n::: {.cell-output .cell-output-display execution_count=13}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-exp-panel-nocov-ci-output-1.svg){#fig-exp-panel-nocov-ci}\n:::\n:::\n\n\n::: {#cell-fig-exp-panel-nocov-prev .cell execution_count=13}\n\n::: {.cell-output .cell-output-display execution_count=14}\n![State Prevalence](03_long_tests_files/figure-html/fig-exp-panel-nocov-prev-output-1.svg){#fig-exp-panel-nocov-prev}\n:::\n:::\n\n\n### 2.5 exp_panel_fixed\n\n**Test**: exp_panel_fixed | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4897</td>\n      <td style = \"text-align: right;\">0.0674</td>\n      <td style = \"text-align: right;\">0.3162</td>\n      <td style = \"text-align: right;\">0.6632</td>\n      <td style = \"text-align: right;\">2.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1516</td>\n      <td style = \"text-align: right;\">0.0073</td>\n      <td style = \"text-align: right;\">0.1329</td>\n      <td style = \"text-align: right;\">0.1704</td>\n      <td style = \"text-align: right;\">1.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5413</td>\n      <td style = \"text-align: right;\">0.0905</td>\n      <td style = \"text-align: right;\">0.3081</td>\n      <td style = \"text-align: right;\">0.7746</td>\n      <td style = \"text-align: right;\">8.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1147</td>\n      <td style = \"text-align: right;\">0.0082</td>\n      <td style = \"text-align: right;\">0.0935</td>\n      <td style = \"text-align: right;\">0.1359</td>\n      <td style = \"text-align: right;\">4.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-exp-panel-fixed-ci .cell execution_count=15}\n\n::: {.cell-output .cell-output-display execution_count=16}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-exp-panel-fixed-ci-output-1.svg){#fig-exp-panel-fixed-ci}\n:::\n:::\n\n\n::: {#cell-fig-exp-panel-fixed-prev .cell execution_count=16}\n\n::: {.cell-output .cell-output-display execution_count=17}\n![State Prevalence](03_long_tests_files/figure-html/fig-exp-panel-fixed-prev-output-1.svg){#fig-exp-panel-fixed-prev}\n:::\n:::\n\n\n### 2.6 exp_panel_tvc\n\n**Test**: exp_panel_tvc | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.498</td>\n      <td style = \"text-align: right;\">0.0693</td>\n      <td style = \"text-align: right;\">0.3194</td>\n      <td style = \"text-align: right;\">0.6766</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.0065</td>\n      <td style = \"text-align: right;\">0.1332</td>\n      <td style = \"text-align: right;\">0.1668</td>\n      <td style = \"text-align: right;\">0.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5008</td>\n      <td style = \"text-align: right;\">0.0968</td>\n      <td style = \"text-align: right;\">0.2514</td>\n      <td style = \"text-align: right;\">0.7502</td>\n      <td style = \"text-align: right;\">0.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1261</td>\n      <td style = \"text-align: right;\">0.0104</td>\n      <td style = \"text-align: right;\">0.0994</td>\n      <td style = \"text-align: right;\">0.1528</td>\n      <td style = \"text-align: right;\">5.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-exp-panel-tvc-ci .cell execution_count=18}\n\n::: {.cell-output .cell-output-display execution_count=19}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-exp-panel-tvc-ci-output-1.svg){#fig-exp-panel-tvc-ci}\n:::\n:::\n\n\n::: {#cell-fig-exp-panel-tvc-prev .cell execution_count=19}\n\n::: {.cell-output .cell-output-display execution_count=20}\n![State Prevalence](03_long_tests_files/figure-html/fig-exp-panel-tvc-prev-output-1.svg){#fig-exp-panel-tvc-prev}\n:::\n:::\n\n\n---\n\n## 3. Weibull Hazard Models\n\n### 3.1 wei_exact_nocov\n\n**Test**: wei_exact_nocov | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_scale</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1597</td>\n      <td style = \"text-align: right;\">0.0098</td>\n      <td style = \"text-align: right;\">0.1343</td>\n      <td style = \"text-align: right;\">0.185</td>\n      <td style = \"text-align: right;\">6.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">1.3</td>\n      <td style = \"text-align: right;\">1.2714</td>\n      <td style = \"text-align: right;\">0.0301</td>\n      <td style = \"text-align: right;\">1.1938</td>\n      <td style = \"text-align: right;\">1.349</td>\n      <td style = \"text-align: right;\">2.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_scale</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1459</td>\n      <td style = \"text-align: right;\">0.01</td>\n      <td style = \"text-align: right;\">0.1201</td>\n      <td style = \"text-align: right;\">0.1716</td>\n      <td style = \"text-align: right;\">21.5</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">1.1</td>\n      <td style = \"text-align: right;\">1.0215</td>\n      <td style = \"text-align: right;\">0.0306</td>\n      <td style = \"text-align: right;\">0.9427</td>\n      <td style = \"text-align: right;\">1.1004</td>\n      <td style = \"text-align: right;\">7.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-wei-exact-nocov-ci .cell execution_count=21}\n\n::: {.cell-output .cell-output-display execution_count=22}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-wei-exact-nocov-ci-output-1.svg){#fig-wei-exact-nocov-ci}\n:::\n:::\n\n\n::: {#cell-fig-wei-exact-nocov-prev .cell execution_count=22}\n\n::: {.cell-output .cell-output-display execution_count=23}\n![State Prevalence](03_long_tests_files/figure-html/fig-wei-exact-nocov-prev-output-1.svg){#fig-wei-exact-nocov-prev}\n:::\n:::\n\n\n### 3.2 wei_exact_fixed\n\n**Test**: wei_exact_fixed | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5138</td>\n      <td style = \"text-align: right;\">0.0656</td>\n      <td style = \"text-align: right;\">0.3448</td>\n      <td style = \"text-align: right;\">0.6828</td>\n      <td style = \"text-align: right;\">2.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_scale</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1518</td>\n      <td style = \"text-align: right;\">0.0105</td>\n      <td style = \"text-align: right;\">0.1249</td>\n      <td style = \"text-align: right;\">0.1788</td>\n      <td style = \"text-align: right;\">1.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">1.3</td>\n      <td style = \"text-align: right;\">1.2936</td>\n      <td style = \"text-align: right;\">0.0304</td>\n      <td style = \"text-align: right;\">1.2152</td>\n      <td style = \"text-align: right;\">1.372</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4856</td>\n      <td style = \"text-align: right;\">0.0675</td>\n      <td style = \"text-align: right;\">0.3117</td>\n      <td style = \"text-align: right;\">0.6595</td>\n      <td style = \"text-align: right;\">2.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_scale</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.124</td>\n      <td style = \"text-align: right;\">0.0102</td>\n      <td style = \"text-align: right;\">0.0978</td>\n      <td style = \"text-align: right;\">0.1501</td>\n      <td style = \"text-align: right;\">3.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">1.1</td>\n      <td style = \"text-align: right;\">1.0763</td>\n      <td style = \"text-align: right;\">0.0317</td>\n      <td style = \"text-align: right;\">0.9948</td>\n      <td style = \"text-align: right;\">1.1579</td>\n      <td style = \"text-align: right;\">2.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-wei-exact-fixed-ci .cell execution_count=24}\n\n::: {.cell-output .cell-output-display execution_count=25}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-wei-exact-fixed-ci-output-1.svg){#fig-wei-exact-fixed-ci}\n:::\n:::\n\n\n::: {#cell-fig-wei-exact-fixed-prev .cell execution_count=25}\n\n::: {.cell-output .cell-output-display execution_count=26}\n![State Prevalence](03_long_tests_files/figure-html/fig-wei-exact-fixed-prev-output-1.svg){#fig-wei-exact-fixed-prev}\n:::\n:::\n\n\n### 3.3 wei_exact_tvc\n\n**Test**: wei_exact_tvc | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4739</td>\n      <td style = \"text-align: right;\">0.0909</td>\n      <td style = \"text-align: right;\">0.2397</td>\n      <td style = \"text-align: right;\">0.708</td>\n      <td style = \"text-align: right;\">5.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_scale</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.151</td>\n      <td style = \"text-align: right;\">0.01</td>\n      <td style = \"text-align: right;\">0.1253</td>\n      <td style = \"text-align: right;\">0.1767</td>\n      <td style = \"text-align: right;\">0.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">1.3</td>\n      <td style = \"text-align: right;\">1.3483</td>\n      <td style = \"text-align: right;\">0.0416</td>\n      <td style = \"text-align: right;\">1.2411</td>\n      <td style = \"text-align: right;\">1.4556</td>\n      <td style = \"text-align: right;\">3.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4002</td>\n      <td style = \"text-align: right;\">0.0892</td>\n      <td style = \"text-align: right;\">0.1704</td>\n      <td style = \"text-align: right;\">0.63</td>\n      <td style = \"text-align: right;\">20.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_scale</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.1221</td>\n      <td style = \"text-align: right;\">0.0093</td>\n      <td style = \"text-align: right;\">0.098</td>\n      <td style = \"text-align: right;\">0.1461</td>\n      <td style = \"text-align: right;\">1.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">1.1</td>\n      <td style = \"text-align: right;\">1.1236</td>\n      <td style = \"text-align: right;\">0.0368</td>\n      <td style = \"text-align: right;\">1.0287</td>\n      <td style = \"text-align: right;\">1.2185</td>\n      <td style = \"text-align: right;\">2.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-wei-exact-tvc-ci .cell execution_count=27}\n\n::: {.cell-output .cell-output-display execution_count=28}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-wei-exact-tvc-ci-output-1.svg){#fig-wei-exact-tvc-ci}\n:::\n:::\n\n\n::: {#cell-fig-wei-exact-tvc-prev .cell execution_count=28}\n\n::: {.cell-output .cell-output-display execution_count=29}\n![State Prevalence](03_long_tests_files/figure-html/fig-wei-exact-tvc-prev-output-1.svg){#fig-wei-exact-tvc-prev}\n:::\n:::\n\n\n### 3.4 wei_mcem_nocov\n\n**Test**: wei_mcem_nocov | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_scale</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1947</td>\n      <td style = \"text-align: right;\">0.0157</td>\n      <td style = \"text-align: right;\">0.1542</td>\n      <td style = \"text-align: right;\">0.2351</td>\n      <td style = \"text-align: right;\">29.8</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">1.3</td>\n      <td style = \"text-align: right;\">1.1645</td>\n      <td style = \"text-align: right;\">0.0404</td>\n      <td style = \"text-align: right;\">1.0605</td>\n      <td style = \"text-align: right;\">1.2684</td>\n      <td style = \"text-align: right;\">10.4</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_scale</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.0928</td>\n      <td style = \"text-align: right;\">0.0068</td>\n      <td style = \"text-align: right;\">0.0753</td>\n      <td style = \"text-align: right;\">0.1103</td>\n      <td style = \"text-align: right;\">22.7</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">1.1</td>\n      <td style = \"text-align: right;\">1.222</td>\n      <td style = \"text-align: right;\">0.0336</td>\n      <td style = \"text-align: right;\">1.1355</td>\n      <td style = \"text-align: right;\">1.3086</td>\n      <td style = \"text-align: right;\">11.1</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-wei-mcem-nocov-ci .cell execution_count=30}\n\n::: {.cell-output .cell-output-display execution_count=31}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-wei-mcem-nocov-ci-output-1.svg){#fig-wei-mcem-nocov-ci}\n:::\n:::\n\n\n::: {#cell-fig-wei-mcem-nocov-prev .cell execution_count=31}\n\n::: {.cell-output .cell-output-display execution_count=32}\n![State Prevalence](03_long_tests_files/figure-html/fig-wei-mcem-nocov-prev-output-1.svg){#fig-wei-mcem-nocov-prev}\n:::\n:::\n\n\n### 3.5 wei_mcem_fixed\n\n**Test**: wei_mcem_fixed | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4717</td>\n      <td style = \"text-align: right;\">0.0625</td>\n      <td style = \"text-align: right;\">0.3106</td>\n      <td style = \"text-align: right;\">0.6328</td>\n      <td style = \"text-align: right;\">5.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_scale</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1649</td>\n      <td style = \"text-align: right;\">0.0142</td>\n      <td style = \"text-align: right;\">0.1284</td>\n      <td style = \"text-align: right;\">0.2014</td>\n      <td style = \"text-align: right;\">9.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">1.3</td>\n      <td style = \"text-align: right;\">1.2753</td>\n      <td style = \"text-align: right;\">0.0408</td>\n      <td style = \"text-align: right;\">1.1702</td>\n      <td style = \"text-align: right;\">1.3803</td>\n      <td style = \"text-align: right;\">1.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.598</td>\n      <td style = \"text-align: right;\">0.0758</td>\n      <td style = \"text-align: right;\">0.4027</td>\n      <td style = \"text-align: right;\">0.7933</td>\n      <td style = \"text-align: right;\">19.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_scale</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.0906</td>\n      <td style = \"text-align: right;\">0.0072</td>\n      <td style = \"text-align: right;\">0.0721</td>\n      <td style = \"text-align: right;\">0.1091</td>\n      <td style = \"text-align: right;\">24.5</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">1.1</td>\n      <td style = \"text-align: right;\">1.1987</td>\n      <td style = \"text-align: right;\">0.0303</td>\n      <td style = \"text-align: right;\">1.1207</td>\n      <td style = \"text-align: right;\">1.2767</td>\n      <td style = \"text-align: right;\">9.0</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-wei-mcem-fixed-ci .cell execution_count=33}\n\n::: {.cell-output .cell-output-display execution_count=34}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-wei-mcem-fixed-ci-output-1.svg){#fig-wei-mcem-fixed-ci}\n:::\n:::\n\n\n::: {#cell-fig-wei-mcem-fixed-prev .cell execution_count=34}\n\n::: {.cell-output .cell-output-display execution_count=35}\n![State Prevalence](03_long_tests_files/figure-html/fig-wei-mcem-fixed-prev-output-1.svg){#fig-wei-mcem-fixed-prev}\n:::\n:::\n\n\n### 3.6 wei_mcem_tvc\n\n**Test**: wei_mcem_tvc | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5557</td>\n      <td style = \"text-align: right;\">0.1035</td>\n      <td style = \"text-align: right;\">0.289</td>\n      <td style = \"text-align: right;\">0.8224</td>\n      <td style = \"text-align: right;\">11.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_scale</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1626</td>\n      <td style = \"text-align: right;\">0.0146</td>\n      <td style = \"text-align: right;\">0.125</td>\n      <td style = \"text-align: right;\">0.2002</td>\n      <td style = \"text-align: right;\">8.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">1.3</td>\n      <td style = \"text-align: right;\">1.2475</td>\n      <td style = \"text-align: right;\">0.0578</td>\n      <td style = \"text-align: right;\">1.0986</td>\n      <td style = \"text-align: right;\">1.3964</td>\n      <td style = \"text-align: right;\">4.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5325</td>\n      <td style = \"text-align: right;\">0.0955</td>\n      <td style = \"text-align: right;\">0.2866</td>\n      <td style = \"text-align: right;\">0.7784</td>\n      <td style = \"text-align: right;\">6.5</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_scale</td>\n      <td style = \"text-align: right;\">0.12</td>\n      <td style = \"text-align: right;\">0.0844</td>\n      <td style = \"text-align: right;\">0.0072</td>\n      <td style = \"text-align: right;\">0.0658</td>\n      <td style = \"text-align: right;\">0.103</td>\n      <td style = \"text-align: right;\">29.7</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">1.1</td>\n      <td style = \"text-align: right;\">1.2483</td>\n      <td style = \"text-align: right;\">0.0368</td>\n      <td style = \"text-align: right;\">1.1535</td>\n      <td style = \"text-align: right;\">1.3432</td>\n      <td style = \"text-align: right;\">13.5</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-wei-mcem-tvc-ci .cell execution_count=36}\n\n::: {.cell-output .cell-output-display execution_count=37}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-wei-mcem-tvc-ci-output-1.svg){#fig-wei-mcem-tvc-ci}\n:::\n:::\n\n\n::: {#cell-fig-wei-mcem-tvc-prev .cell execution_count=37}\n\n::: {.cell-output .cell-output-display execution_count=38}\n![State Prevalence](03_long_tests_files/figure-html/fig-wei-mcem-tvc-prev-output-1.svg){#fig-wei-mcem-tvc-prev}\n:::\n:::\n\n\n---\n\n## 4. Gompertz Hazard Models\n\n### 4.1 gom_exact_nocov\n\n**Test**: gom_exact_nocov | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.04</td>\n      <td style = \"text-align: right;\">0.0451</td>\n      <td style = \"text-align: right;\">0.0033</td>\n      <td style = \"text-align: right;\">0.0366</td>\n      <td style = \"text-align: right;\">0.0536</td>\n      <td style = \"text-align: right;\">12.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">0.08</td>\n      <td style = \"text-align: right;\">0.0744</td>\n      <td style = \"text-align: right;\">0.0087</td>\n      <td style = \"text-align: right;\">0.052</td>\n      <td style = \"text-align: right;\">0.0967</td>\n      <td style = \"text-align: right;\">7.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.03</td>\n      <td style = \"text-align: right;\">0.0367</td>\n      <td style = \"text-align: right;\">0.0045</td>\n      <td style = \"text-align: right;\">0.0252</td>\n      <td style = \"text-align: right;\">0.0482</td>\n      <td style = \"text-align: right;\">22.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">0.06</td>\n      <td style = \"text-align: right;\">0.0233</td>\n      <td style = \"text-align: right;\">0.0208</td>\n      <td style = \"text-align: right;\">-0.0303</td>\n      <td style = \"text-align: right;\">0.0768</td>\n      <td style = \"text-align: right;\">61.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-gom-exact-nocov-ci .cell execution_count=39}\n\n::: {.cell-output .cell-output-display execution_count=40}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-gom-exact-nocov-ci-output-1.svg){#fig-gom-exact-nocov-ci}\n:::\n:::\n\n\n::: {#cell-fig-gom-exact-nocov-prev .cell execution_count=40}\n\n::: {.cell-output .cell-output-display execution_count=41}\n![State Prevalence](03_long_tests_files/figure-html/fig-gom-exact-nocov-prev-output-1.svg){#fig-gom-exact-nocov-prev}\n:::\n:::\n\n\n### 4.2 gom_exact_fixed\n\n**Test**: gom_exact_fixed | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5307</td>\n      <td style = \"text-align: right;\">0.072</td>\n      <td style = \"text-align: right;\">0.3452</td>\n      <td style = \"text-align: right;\">0.7162</td>\n      <td style = \"text-align: right;\">6.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.04</td>\n      <td style = \"text-align: right;\">0.0371</td>\n      <td style = \"text-align: right;\">0.0034</td>\n      <td style = \"text-align: right;\">0.0284</td>\n      <td style = \"text-align: right;\">0.0458</td>\n      <td style = \"text-align: right;\">7.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">0.08</td>\n      <td style = \"text-align: right;\">0.092</td>\n      <td style = \"text-align: right;\">0.0089</td>\n      <td style = \"text-align: right;\">0.069</td>\n      <td style = \"text-align: right;\">0.1149</td>\n      <td style = \"text-align: right;\">14.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5945</td>\n      <td style = \"text-align: right;\">0.1345</td>\n      <td style = \"text-align: right;\">0.2482</td>\n      <td style = \"text-align: right;\">0.9408</td>\n      <td style = \"text-align: right;\">18.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.03</td>\n      <td style = \"text-align: right;\">0.0346</td>\n      <td style = \"text-align: right;\">0.0047</td>\n      <td style = \"text-align: right;\">0.0224</td>\n      <td style = \"text-align: right;\">0.0468</td>\n      <td style = \"text-align: right;\">15.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">0.06</td>\n      <td style = \"text-align: right;\">0.0124</td>\n      <td style = \"text-align: right;\">0.0179</td>\n      <td style = \"text-align: right;\">-0.0338</td>\n      <td style = \"text-align: right;\">0.0586</td>\n      <td style = \"text-align: right;\">79.3</td>\n      <td style = \"text-align: right;\">✗</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-gom-exact-fixed-ci .cell execution_count=42}\n\n::: {.cell-output .cell-output-display execution_count=43}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-gom-exact-fixed-ci-output-1.svg){#fig-gom-exact-fixed-ci}\n:::\n:::\n\n\n::: {#cell-fig-gom-exact-fixed-prev .cell execution_count=43}\n\n::: {.cell-output .cell-output-display execution_count=44}\n![State Prevalence](03_long_tests_files/figure-html/fig-gom-exact-fixed-prev-output-1.svg){#fig-gom-exact-fixed-prev}\n:::\n:::\n\n\n### 4.3 gom_exact_tvc\n\n**Test**: gom_exact_tvc | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4752</td>\n      <td style = \"text-align: right;\">0.1246</td>\n      <td style = \"text-align: right;\">0.1543</td>\n      <td style = \"text-align: right;\">0.7961</td>\n      <td style = \"text-align: right;\">5.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.04</td>\n      <td style = \"text-align: right;\">0.0396</td>\n      <td style = \"text-align: right;\">0.003</td>\n      <td style = \"text-align: right;\">0.0318</td>\n      <td style = \"text-align: right;\">0.0475</td>\n      <td style = \"text-align: right;\">1.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">0.08</td>\n      <td style = \"text-align: right;\">0.0889</td>\n      <td style = \"text-align: right;\">0.0138</td>\n      <td style = \"text-align: right;\">0.0533</td>\n      <td style = \"text-align: right;\">0.1246</td>\n      <td style = \"text-align: right;\">11.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.3798</td>\n      <td style = \"text-align: right;\">0.2564</td>\n      <td style = \"text-align: right;\">-0.2806</td>\n      <td style = \"text-align: right;\">1.0402</td>\n      <td style = \"text-align: right;\">24.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.03</td>\n      <td style = \"text-align: right;\">0.0287</td>\n      <td style = \"text-align: right;\">0.0069</td>\n      <td style = \"text-align: right;\">0.011</td>\n      <td style = \"text-align: right;\">0.0463</td>\n      <td style = \"text-align: right;\">4.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">0.06</td>\n      <td style = \"text-align: right;\">0.0705</td>\n      <td style = \"text-align: right;\">0.0177</td>\n      <td style = \"text-align: right;\">0.0248</td>\n      <td style = \"text-align: right;\">0.1161</td>\n      <td style = \"text-align: right;\">17.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-gom-exact-tvc-ci .cell execution_count=45}\n\n::: {.cell-output .cell-output-display execution_count=46}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-gom-exact-tvc-ci-output-1.svg){#fig-gom-exact-tvc-ci}\n:::\n:::\n\n\n::: {#cell-fig-gom-exact-tvc-prev .cell execution_count=46}\n\n::: {.cell-output .cell-output-display execution_count=47}\n![State Prevalence](03_long_tests_files/figure-html/fig-gom-exact-tvc-prev-output-1.svg){#fig-gom-exact-tvc-prev}\n:::\n:::\n\n\n### 4.4 gom_mcem_nocov\n\n**Test**: gom_mcem_nocov | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.04</td>\n      <td style = \"text-align: right;\">0.0403</td>\n      <td style = \"text-align: right;\">0.0026</td>\n      <td style = \"text-align: right;\">0.0335</td>\n      <td style = \"text-align: right;\">0.047</td>\n      <td style = \"text-align: right;\">0.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">0.08</td>\n      <td style = \"text-align: right;\">0.0787</td>\n      <td style = \"text-align: right;\">0.0052</td>\n      <td style = \"text-align: right;\">0.0655</td>\n      <td style = \"text-align: right;\">0.092</td>\n      <td style = \"text-align: right;\">1.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.03</td>\n      <td style = \"text-align: right;\">0.0277</td>\n      <td style = \"text-align: right;\">0.0023</td>\n      <td style = \"text-align: right;\">0.0217</td>\n      <td style = \"text-align: right;\">0.0338</td>\n      <td style = \"text-align: right;\">7.5</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">0.06</td>\n      <td style = \"text-align: right;\">0.0708</td>\n      <td style = \"text-align: right;\">0.0082</td>\n      <td style = \"text-align: right;\">0.0498</td>\n      <td style = \"text-align: right;\">0.0918</td>\n      <td style = \"text-align: right;\">18.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-gom-mcem-nocov-ci .cell execution_count=48}\n\n::: {.cell-output .cell-output-display execution_count=49}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-gom-mcem-nocov-ci-output-1.svg){#fig-gom-mcem-nocov-ci}\n:::\n:::\n\n\n::: {#cell-fig-gom-mcem-nocov-prev .cell execution_count=49}\n\n::: {.cell-output .cell-output-display execution_count=50}\n![State Prevalence](03_long_tests_files/figure-html/fig-gom-mcem-nocov-prev-output-1.svg){#fig-gom-mcem-nocov-prev}\n:::\n:::\n\n\n### 4.5 gom_mcem_fixed\n\n**Test**: gom_mcem_fixed | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5428</td>\n      <td style = \"text-align: right;\">0.0669</td>\n      <td style = \"text-align: right;\">0.3705</td>\n      <td style = \"text-align: right;\">0.7152</td>\n      <td style = \"text-align: right;\">8.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.04</td>\n      <td style = \"text-align: right;\">0.0379</td>\n      <td style = \"text-align: right;\">0.0028</td>\n      <td style = \"text-align: right;\">0.0306</td>\n      <td style = \"text-align: right;\">0.0452</td>\n      <td style = \"text-align: right;\">5.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">0.08</td>\n      <td style = \"text-align: right;\">0.0813</td>\n      <td style = \"text-align: right;\">0.0054</td>\n      <td style = \"text-align: right;\">0.0673</td>\n      <td style = \"text-align: right;\">0.0953</td>\n      <td style = \"text-align: right;\">1.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5008</td>\n      <td style = \"text-align: right;\">0.087</td>\n      <td style = \"text-align: right;\">0.2766</td>\n      <td style = \"text-align: right;\">0.725</td>\n      <td style = \"text-align: right;\">0.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.03</td>\n      <td style = \"text-align: right;\">0.0274</td>\n      <td style = \"text-align: right;\">0.0025</td>\n      <td style = \"text-align: right;\">0.0209</td>\n      <td style = \"text-align: right;\">0.0338</td>\n      <td style = \"text-align: right;\">8.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">0.06</td>\n      <td style = \"text-align: right;\">0.0678</td>\n      <td style = \"text-align: right;\">0.0074</td>\n      <td style = \"text-align: right;\">0.0487</td>\n      <td style = \"text-align: right;\">0.087</td>\n      <td style = \"text-align: right;\">13.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-gom-mcem-fixed-ci .cell execution_count=51}\n\n::: {.cell-output .cell-output-display execution_count=52}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-gom-mcem-fixed-ci-output-1.svg){#fig-gom-mcem-fixed-ci}\n:::\n:::\n\n\n::: {#cell-fig-gom-mcem-fixed-prev .cell execution_count=52}\n\n::: {.cell-output .cell-output-display execution_count=53}\n![State Prevalence](03_long_tests_files/figure-html/fig-gom-mcem-fixed-prev-output-1.svg){#fig-gom-mcem-fixed-prev}\n:::\n:::\n\n\n### 4.6 gom_mcem_tvc\n\n**Test**: gom_mcem_tvc | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">h12_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.7611</td>\n      <td style = \"text-align: right;\">0.109</td>\n      <td style = \"text-align: right;\">0.4802</td>\n      <td style = \"text-align: right;\">1.042</td>\n      <td style = \"text-align: right;\">52.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_rate</td>\n      <td style = \"text-align: right;\">0.04</td>\n      <td style = \"text-align: right;\">0.0395</td>\n      <td style = \"text-align: right;\">0.0029</td>\n      <td style = \"text-align: right;\">0.032</td>\n      <td style = \"text-align: right;\">0.047</td>\n      <td style = \"text-align: right;\">1.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h12_shape</td>\n      <td style = \"text-align: right;\">0.08</td>\n      <td style = \"text-align: right;\">0.0612</td>\n      <td style = \"text-align: right;\">0.0086</td>\n      <td style = \"text-align: right;\">0.039</td>\n      <td style = \"text-align: right;\">0.0835</td>\n      <td style = \"text-align: right;\">23.5</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_beta</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.6048</td>\n      <td style = \"text-align: right;\">0.2885</td>\n      <td style = \"text-align: right;\">-0.1385</td>\n      <td style = \"text-align: right;\">1.348</td>\n      <td style = \"text-align: right;\">21.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_rate</td>\n      <td style = \"text-align: right;\">0.03</td>\n      <td style = \"text-align: right;\">0.0233</td>\n      <td style = \"text-align: right;\">0.0065</td>\n      <td style = \"text-align: right;\">0.0064</td>\n      <td style = \"text-align: right;\">0.0402</td>\n      <td style = \"text-align: right;\">22.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">h23_shape</td>\n      <td style = \"text-align: right;\">0.06</td>\n      <td style = \"text-align: right;\">0.0716</td>\n      <td style = \"text-align: right;\">0.0076</td>\n      <td style = \"text-align: right;\">0.0521</td>\n      <td style = \"text-align: right;\">0.0911</td>\n      <td style = \"text-align: right;\">19.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-gom-mcem-tvc-ci .cell execution_count=54}\n\n::: {.cell-output .cell-output-display execution_count=55}\n![Cumulative Incidence](03_long_tests_files/figure-html/fig-gom-mcem-tvc-ci-output-1.svg){#fig-gom-mcem-tvc-ci}\n:::\n:::\n\n\n::: {#cell-fig-gom-mcem-tvc-prev .cell execution_count=55}\n\n::: {.cell-output .cell-output-display execution_count=56}\n![State Prevalence](03_long_tests_files/figure-html/fig-gom-mcem-tvc-prev-output-1.svg){#fig-gom-mcem-tvc-prev}\n:::\n:::\n\n\n---\n\n## 5. Phase-Type Hazard Models\n\nPhase-type hazard models use Coxian phase-type distributions to model sojourn times.\nUnlike standard parametric hazards (exponential, Weibull, Gompertz), phase-type\nhazards operate on an **expanded state space** where each observed state has multiple\nlatent phases with exponential hazards.\n\nThese tests validate inference for models where the **target model** uses phase-type hazards.\nThis is different from using phase-type as a **proposal distribution** for MCEM.\n\n::: {.callout-note}\n**Note on plots:** Prevalence and cumulative incidence plots for phase-type tests show \n**True** (from simulation with true parameters) and **Estimated** (from simulation with fitted \nparameters) curves on the **observed state space**, not the expanded phase space. The \n`capture_phasetype_longtest_result!` function collapses phase-level prevalence to observed \nstate prevalence using the `phase_to_state` mapping. \n:::\n\n::: {.callout-warning}\n**Panel Data Limitation**: For panel-observed data (pt_panel_* tests), the \"Observed\" \ncumulative incidence curves may differ substantially from \"True\" model curves. This is \nexpected because:\n\n1. Panel data only records states at discrete observation times\n2. Between observations, the exact transition path is unknown\n3. The \"Observed\" CI counts direct transitions in the observed data, while \"True\" CI comes \n   from continuous-time simulated paths\n\nFor example, in illness-death models, a subject going 1→2→3 between observations appears \nas a 1→3 transition if state 2 was never observed. This is a fundamental limitation of \npanel-observed data, not a model error.\n:::\n\n### Test Overview\n\n| Test | Model Structure | Data Type | Phases | Status |\n|------|-----------------|-----------|--------|--------|\n| pt_exact_nocov | Illness-death (1→2→3, 1→3) | Exact | 2 per state | ✅ Pass |\n| pt_exact_fixed | 2-state + covariate | Exact | 2 phases | ✅ Pass |\n| pt_exact_tvc | 2-state + TVC | Exact | 2 phases | ✅ Pass |\n| pt_panel_simple | 2-state (1→2) | Panel | 2 phases | ✅ Pass |\n| pt_panel_id | Illness-death | Panel | 2 per state | ✅ Pass |\n| pt_mixed_simple | 2-state | Mixed (exact+panel) | 2 phases | ✅ Pass |\n| pt_mixed_structured | 2-state | Mixed (structured) | 2 phases | ✅ Pass |\n| pt_panel_fixed | 2-state + covariate | Panel | 2 phases | ✅ Pass |\n| pt_panel_tvc | 2-state + TVC | Panel | 2 phases | ✅ Pass |\n\n### 5.1 pt_exact_nocov\n\nTests a 3-state illness-death model (1→2→3 and 1→3) with 2 Coxian phases per transient state, \nusing exactly observed transition times. Validates that phase-type rate parameters are \nrecovered when all transition times are known. This is the simplest case with 8 rate parameters.\n\n**Test**: pt_exact_nocov | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">rate_1</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4585</td>\n      <td style = \"text-align: right;\">0.0244</td>\n      <td style = \"text-align: right;\">0.3957</td>\n      <td style = \"text-align: right;\">0.5213</td>\n      <td style = \"text-align: right;\">8.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_2</td>\n      <td style = \"text-align: right;\">0.3</td>\n      <td style = \"text-align: right;\">0.3411</td>\n      <td style = \"text-align: right;\">0.0201</td>\n      <td style = \"text-align: right;\">0.2894</td>\n      <td style = \"text-align: right;\">0.3929</td>\n      <td style = \"text-align: right;\">13.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_3</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">0.4101</td>\n      <td style = \"text-align: right;\">0.0221</td>\n      <td style = \"text-align: right;\">0.3533</td>\n      <td style = \"text-align: right;\">0.4669</td>\n      <td style = \"text-align: right;\">2.5</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_4</td>\n      <td style = \"text-align: right;\">0.2</td>\n      <td style = \"text-align: right;\">0.2103</td>\n      <td style = \"text-align: right;\">0.0164</td>\n      <td style = \"text-align: right;\">0.1679</td>\n      <td style = \"text-align: right;\">0.2526</td>\n      <td style = \"text-align: right;\">5.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_5</td>\n      <td style = \"text-align: right;\">0.25</td>\n      <td style = \"text-align: right;\">0.2364</td>\n      <td style = \"text-align: right;\">0.0159</td>\n      <td style = \"text-align: right;\">0.1954</td>\n      <td style = \"text-align: right;\">0.2775</td>\n      <td style = \"text-align: right;\">5.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_6</td>\n      <td style = \"text-align: right;\">0.35</td>\n      <td style = \"text-align: right;\">0.3614</td>\n      <td style = \"text-align: right;\">0.0222</td>\n      <td style = \"text-align: right;\">0.3042</td>\n      <td style = \"text-align: right;\">0.4187</td>\n      <td style = \"text-align: right;\">3.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_7</td>\n      <td style = \"text-align: right;\">0.3</td>\n      <td style = \"text-align: right;\">0.2923</td>\n      <td style = \"text-align: right;\">0.0195</td>\n      <td style = \"text-align: right;\">0.2422</td>\n      <td style = \"text-align: right;\">0.3425</td>\n      <td style = \"text-align: right;\">2.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_8</td>\n      <td style = \"text-align: right;\">0.15</td>\n      <td style = \"text-align: right;\">0.1734</td>\n      <td style = \"text-align: right;\">0.014</td>\n      <td style = \"text-align: right;\">0.1372</td>\n      <td style = \"text-align: right;\">0.2096</td>\n      <td style = \"text-align: right;\">15.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-pt-exact-nocov-ci .cell execution_count=57}\n\n::: {.cell-output .cell-output-display execution_count=58}\n![Cumulative Incidence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-exact-nocov-ci-output-1.svg){#fig-pt-exact-nocov-ci}\n:::\n:::\n\n\n::: {#cell-fig-pt-exact-nocov-prev .cell execution_count=58}\n\n::: {.cell-output .cell-output-display execution_count=59}\n![State Prevalence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-exact-nocov-prev-output-1.svg){#fig-pt-exact-nocov-prev}\n:::\n:::\n\n\n### 5.2 pt_exact_fixed\n\nTests a 2-state model (1→2) with 2 phases and a time-fixed binary covariate affecting \ntransition rates. Validates that both baseline rates and covariate effects (log hazard \nratios) are recovered from exact data.\n\n**Test**: pt_exact_fixed | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">beta_1</td>\n      <td style = \"text-align: right;\">0.0</td>\n      <td style = \"text-align: right;\">0.0204</td>\n      <td style = \"text-align: right;\">0.0872</td>\n      <td style = \"text-align: right;\">-0.2042</td>\n      <td style = \"text-align: right;\">0.245</td>\n      <td style = \"text-align: right;\">2.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">beta_2</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">0.4337</td>\n      <td style = \"text-align: right;\">0.0994</td>\n      <td style = \"text-align: right;\">0.1775</td>\n      <td style = \"text-align: right;\">0.6899</td>\n      <td style = \"text-align: right;\">8.4</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">beta_3</td>\n      <td style = \"text-align: right;\">0.3</td>\n      <td style = \"text-align: right;\">0.3241</td>\n      <td style = \"text-align: right;\">0.0793</td>\n      <td style = \"text-align: right;\">0.1198</td>\n      <td style = \"text-align: right;\">0.5284</td>\n      <td style = \"text-align: right;\">8.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_1</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4954</td>\n      <td style = \"text-align: right;\">0.0296</td>\n      <td style = \"text-align: right;\">0.4191</td>\n      <td style = \"text-align: right;\">0.5717</td>\n      <td style = \"text-align: right;\">0.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_2</td>\n      <td style = \"text-align: right;\">0.3</td>\n      <td style = \"text-align: right;\">0.314</td>\n      <td style = \"text-align: right;\">0.0243</td>\n      <td style = \"text-align: right;\">0.2515</td>\n      <td style = \"text-align: right;\">0.3765</td>\n      <td style = \"text-align: right;\">4.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_3</td>\n      <td style = \"text-align: right;\">0.6</td>\n      <td style = \"text-align: right;\">0.5985</td>\n      <td style = \"text-align: right;\">0.0337</td>\n      <td style = \"text-align: right;\">0.5116</td>\n      <td style = \"text-align: right;\">0.6853</td>\n      <td style = \"text-align: right;\">0.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-pt-exact-fixed-ci .cell execution_count=60}\n\n::: {.cell-output .cell-output-display execution_count=61}\n![Cumulative Incidence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-exact-fixed-ci-output-1.svg){#fig-pt-exact-fixed-ci}\n:::\n:::\n\n\n::: {#cell-fig-pt-exact-fixed-prev .cell execution_count=61}\n\n::: {.cell-output .cell-output-display execution_count=62}\n![State Prevalence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-exact-fixed-prev-output-1.svg){#fig-pt-exact-fixed-prev}\n:::\n:::\n\n\n### 5.3 pt_exact_tvc\n\nTests a 2-state model with 2 phases and a time-varying covariate that changes at a \nfixed time point. Validates inference for phase-type models when covariate values \nchange during follow-up.\n\n**Test**: pt_exact_tvc | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">beta_1</td>\n      <td style = \"text-align: right;\">0.0</td>\n      <td style = \"text-align: right;\">-0.0185</td>\n      <td style = \"text-align: right;\">0.1697</td>\n      <td style = \"text-align: right;\">-0.4556</td>\n      <td style = \"text-align: right;\">0.4186</td>\n      <td style = \"text-align: right;\">1.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">beta_2</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4548</td>\n      <td style = \"text-align: right;\">0.1779</td>\n      <td style = \"text-align: right;\">-0.0035</td>\n      <td style = \"text-align: right;\">0.913</td>\n      <td style = \"text-align: right;\">9.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">beta_3</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">0.3191</td>\n      <td style = \"text-align: right;\">0.0984</td>\n      <td style = \"text-align: right;\">0.0657</td>\n      <td style = \"text-align: right;\">0.5726</td>\n      <td style = \"text-align: right;\">20.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_1</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">0.4166</td>\n      <td style = \"text-align: right;\">0.0175</td>\n      <td style = \"text-align: right;\">0.3714</td>\n      <td style = \"text-align: right;\">0.4617</td>\n      <td style = \"text-align: right;\">4.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_2</td>\n      <td style = \"text-align: right;\">0.25</td>\n      <td style = \"text-align: right;\">0.2521</td>\n      <td style = \"text-align: right;\">0.0134</td>\n      <td style = \"text-align: right;\">0.2177</td>\n      <td style = \"text-align: right;\">0.2865</td>\n      <td style = \"text-align: right;\">0.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">rate_3</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5574</td>\n      <td style = \"text-align: right;\">0.0239</td>\n      <td style = \"text-align: right;\">0.4959</td>\n      <td style = \"text-align: right;\">0.6189</td>\n      <td style = \"text-align: right;\">11.5</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-pt-exact-tvc-ci .cell execution_count=63}\n\n::: {.cell-output .cell-output-display execution_count=64}\n![Cumulative Incidence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-exact-tvc-ci-output-1.svg){#fig-pt-exact-tvc-ci}\n:::\n:::\n\n\n::: {#cell-fig-pt-exact-tvc-prev .cell execution_count=64}\n\n::: {.cell-output .cell-output-display execution_count=65}\n![State Prevalence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-exact-tvc-prev-output-1.svg){#fig-pt-exact-tvc-prev}\n:::\n:::\n\n\n### 5.4 pt_panel_simple\n\nTests a simple 2-state model (1→2 absorbing) with 2 phases using panel/interval-censored \ndata where states are observed only at discrete times. Validates that panel data \nlikelihood works correctly for phase-type models.\n\n**Test**: pt_panel_simple | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">p1</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">0.4306</td>\n      <td style = \"text-align: right;\">0.0183</td>\n      <td style = \"text-align: right;\">0.3836</td>\n      <td style = \"text-align: right;\">0.4777</td>\n      <td style = \"text-align: right;\">7.7</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p2</td>\n      <td style = \"text-align: right;\">0.2</td>\n      <td style = \"text-align: right;\">0.2156</td>\n      <td style = \"text-align: right;\">0.0135</td>\n      <td style = \"text-align: right;\">0.1809</td>\n      <td style = \"text-align: right;\">0.2503</td>\n      <td style = \"text-align: right;\">7.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p3</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5139</td>\n      <td style = \"text-align: right;\">0.021</td>\n      <td style = \"text-align: right;\">0.4597</td>\n      <td style = \"text-align: right;\">0.5681</td>\n      <td style = \"text-align: right;\">2.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-pt-panel-simple-ci .cell execution_count=66}\n\n::: {.cell-output .cell-output-display execution_count=67}\n![Cumulative Incidence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-panel-simple-ci-output-1.svg){#fig-pt-panel-simple-ci}\n:::\n:::\n\n\n::: {#cell-fig-pt-panel-simple-prev .cell execution_count=67}\n\n::: {.cell-output .cell-output-display execution_count=68}\n![State Prevalence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-panel-simple-prev-output-1.svg){#fig-pt-panel-simple-prev}\n:::\n:::\n\n\n### 5.5 pt_panel_id\n\nTests a 3-state illness-death model with 2 phases per transient state using panel data. \nThis is the most complex panel test with 8 rate parameters estimated from \ninterval-censored observations.\n\n**Test**: pt_panel_id | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">p1</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.5349</td>\n      <td style = \"text-align: right;\">0.0543</td>\n      <td style = \"text-align: right;\">0.3951</td>\n      <td style = \"text-align: right;\">0.6747</td>\n      <td style = \"text-align: right;\">7.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p2</td>\n      <td style = \"text-align: right;\">0.3</td>\n      <td style = \"text-align: right;\">0.2941</td>\n      <td style = \"text-align: right;\">0.0445</td>\n      <td style = \"text-align: right;\">0.1795</td>\n      <td style = \"text-align: right;\">0.4086</td>\n      <td style = \"text-align: right;\">2.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p3</td>\n      <td style = \"text-align: right;\">0.35</td>\n      <td style = \"text-align: right;\">0.3562</td>\n      <td style = \"text-align: right;\">0.0363</td>\n      <td style = \"text-align: right;\">0.2628</td>\n      <td style = \"text-align: right;\">0.4497</td>\n      <td style = \"text-align: right;\">1.8</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p4</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">0.3857</td>\n      <td style = \"text-align: right;\">0.0485</td>\n      <td style = \"text-align: right;\">0.2608</td>\n      <td style = \"text-align: right;\">0.5106</td>\n      <td style = \"text-align: right;\">3.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p5</td>\n      <td style = \"text-align: right;\">0.25</td>\n      <td style = \"text-align: right;\">0.2829</td>\n      <td style = \"text-align: right;\">0.0396</td>\n      <td style = \"text-align: right;\">0.1809</td>\n      <td style = \"text-align: right;\">0.3848</td>\n      <td style = \"text-align: right;\">13.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p6</td>\n      <td style = \"text-align: right;\">0.2</td>\n      <td style = \"text-align: right;\">0.2084</td>\n      <td style = \"text-align: right;\">0.0184</td>\n      <td style = \"text-align: right;\">0.161</td>\n      <td style = \"text-align: right;\">0.2557</td>\n      <td style = \"text-align: right;\">4.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p7</td>\n      <td style = \"text-align: right;\">0.3</td>\n      <td style = \"text-align: right;\">0.2905</td>\n      <td style = \"text-align: right;\">0.028</td>\n      <td style = \"text-align: right;\">0.2184</td>\n      <td style = \"text-align: right;\">0.3626</td>\n      <td style = \"text-align: right;\">3.2</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p8</td>\n      <td style = \"text-align: right;\">0.35</td>\n      <td style = \"text-align: right;\">0.3535</td>\n      <td style = \"text-align: right;\">0.0323</td>\n      <td style = \"text-align: right;\">0.2703</td>\n      <td style = \"text-align: right;\">0.4366</td>\n      <td style = \"text-align: right;\">1.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-pt-panel-id-ci .cell execution_count=69}\n\n::: {.cell-output .cell-output-display execution_count=70}\n![Cumulative Incidence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-panel-id-ci-output-1.svg){#fig-pt-panel-id-ci}\n:::\n:::\n\n\n::: {#cell-fig-pt-panel-id-prev .cell execution_count=70}\n\n::: {.cell-output .cell-output-display execution_count=71}\n![State Prevalence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-panel-id-prev-output-1.svg){#fig-pt-panel-id-prev}\n:::\n:::\n\n\n### 5.6 pt_mixed_simple\n\nTests a 2-state model where some subjects have exact observations and others have \npanel observations. Validates that the likelihood correctly combines both observation types.\n\n**Test**: pt_mixed_simple | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">p1</td>\n      <td style = \"text-align: right;\">0.35</td>\n      <td style = \"text-align: right;\">0.3434</td>\n      <td style = \"text-align: right;\">0.0148</td>\n      <td style = \"text-align: right;\">0.3053</td>\n      <td style = \"text-align: right;\">0.3816</td>\n      <td style = \"text-align: right;\">1.9</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p2</td>\n      <td style = \"text-align: right;\">0.25</td>\n      <td style = \"text-align: right;\">0.2531</td>\n      <td style = \"text-align: right;\">0.0127</td>\n      <td style = \"text-align: right;\">0.2203</td>\n      <td style = \"text-align: right;\">0.286</td>\n      <td style = \"text-align: right;\">1.3</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p3</td>\n      <td style = \"text-align: right;\">0.45</td>\n      <td style = \"text-align: right;\">0.4544</td>\n      <td style = \"text-align: right;\">0.02</td>\n      <td style = \"text-align: right;\">0.4028</td>\n      <td style = \"text-align: right;\">0.506</td>\n      <td style = \"text-align: right;\">1.0</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-pt-mixed-simple-ci .cell execution_count=72}\n\n::: {.cell-output .cell-output-display execution_count=73}\n![Cumulative Incidence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-mixed-simple-ci-output-1.svg){#fig-pt-mixed-simple-ci}\n:::\n:::\n\n\n::: {#cell-fig-pt-mixed-simple-prev .cell execution_count=73}\n\n::: {.cell-output .cell-output-display execution_count=74}\n![State Prevalence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-mixed-simple-prev-output-1.svg){#fig-pt-mixed-simple-prev}\n:::\n:::\n\n\n### 5.7 pt_mixed_structured\n\nTests a 2-state model with structured mixed observations where the first half of \nsubjects are observed exactly and the second half have panel data. Validates \ninference with heterogeneous observation patterns.\n\n**Test**: pt_mixed_structured | **Passed**: ✅ | **Time**: 0.0s\n\n```{=html}\n<table>\n  <thead>\n    <tr class = \"header headerLastRow\">\n      <th style = \"text-align: right;\">Parameter</th>\n      <th style = \"text-align: right;\">True</th>\n      <th style = \"text-align: right;\">Estimated</th>\n      <th style = \"text-align: right;\">SE</th>\n      <th style = \"text-align: right;\">CI Low</th>\n      <th style = \"text-align: right;\">CI High</th>\n      <th style = \"text-align: right;\">Rel Err %</th>\n      <th style = \"text-align: right;\">Covered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td style = \"text-align: right;\">p1</td>\n      <td style = \"text-align: right;\">0.4</td>\n      <td style = \"text-align: right;\">0.3934</td>\n      <td style = \"text-align: right;\">0.0164</td>\n      <td style = \"text-align: right;\">0.3513</td>\n      <td style = \"text-align: right;\">0.4356</td>\n      <td style = \"text-align: right;\">1.6</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p2</td>\n      <td style = \"text-align: right;\">0.25</td>\n      <td style = \"text-align: right;\">0.2487</td>\n      <td style = \"text-align: right;\">0.0135</td>\n      <td style = \"text-align: right;\">0.2139</td>\n      <td style = \"text-align: right;\">0.2836</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n    <tr>\n      <td style = \"text-align: right;\">p3</td>\n      <td style = \"text-align: right;\">0.5</td>\n      <td style = \"text-align: right;\">0.4894</td>\n      <td style = \"text-align: right;\">0.0213</td>\n      <td style = \"text-align: right;\">0.4345</td>\n      <td style = \"text-align: right;\">0.5444</td>\n      <td style = \"text-align: right;\">2.1</td>\n      <td style = \"text-align: right;\">✓</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n\n::: {#cell-fig-pt-mixed-structured-ci .cell execution_count=75}\n\n::: {.cell-output .cell-output-display execution_count=76}\n![Cumulative Incidence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-mixed-structured-ci-output-1.svg){#fig-pt-mixed-structured-ci}\n:::\n:::\n\n\n::: {#cell-fig-pt-mixed-structured-prev .cell execution_count=76}\n\n::: {.cell-output .cell-output-display execution_count=77}\n![State Prevalence (Observed State Space)](03_long_tests_files/figure-html/fig-pt-mixed-structured-prev-output-1.svg){#fig-pt-mixed-structured-prev}\n:::\n:::\n\n\n### 5.8 pt_panel_fixed\n\nTests phase-type with fixed covariates on panel data using the production API with \nhomogeneous covariate constraints. With appropriate identifiability constraints \n(eigenvalue ordering, homogeneous covariates, SCTP), the identifiable quantities \n(β, μ₂, ν₁=λ+μ₁) are recovered accurately. Note that individual λ and μ₁ are NOT \nidentifiable from panel data—only their sum ν₁ is identified.\n\n::: {.callout-note}\n**Identifiability Note**: Individual rates λ (progression) and μ₁ (exit from phase 1) \nare NOT separately identifiable from panel data—only their sum ν₁ = λ + μ₁ is identified.\nStandard errors are computed via the delta method for the identifiable parameterization.\n:::\n\n*Test `pt_panel_fixed` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n### 5.9 pt_panel_tvc\n\nTests phase-type with time-varying covariates on panel data using the production API \nwith homogeneous covariate constraints. The TVC changes at a fixed time point during \nfollow-up. With appropriate identifiability constraints, the model recovers the \nidentifiable quantities including the treatment effect β. Higher variance is expected \ncompared to fixed covariate models due to the additional complexity of time-varying effects.\n\n::: {.callout-note}\n**Identifiability Note**: Same identifiability constraints as pt_panel_fixed apply.\nThe TVC effect β is shared across phases (homogeneous constraint) for identifiability.\nHigher variance is expected compared to fixed covariate models.\n:::\n\n*Test `pt_panel_tvc` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n---\n\n## 6. AFT Models\n\nTests in `longtest_aft_suite.jl` validate accelerated failure time models across\nexponential, Weibull, and Gompertz hazard families.\n\n### 6.1 Exponential AFT\n\n| Test | Covariates | Data Type | Status |\n|------|------------|-----------|--------|\n| exp_aft_exact_nocov | None | Exact | ✅ Pass |\n| exp_aft_exact_tfc | Fixed | Exact | ✅ Pass |\n| exp_aft_exact_tvc | Time-varying | Exact | ✅ Pass |\n| exp_aft_panel_nocov | None | Panel | ✅ Pass |\n| exp_aft_panel_tfc | Fixed | Panel | ✅ Pass |\n| exp_aft_panel_tvc | Time-varying | Panel | ✅ Pass |\n\n### 6.2 Weibull AFT\n\n| Test | Covariates | Data Type | Status |\n|------|------------|-----------|--------|\n| wei_aft_exact_nocov | None | Exact | ✅ Pass |\n| wei_aft_exact_tfc | Fixed | Exact | ✅ Pass |\n| wei_aft_exact_tvc | Time-varying | Exact | ✅ Pass |\n| wei_aft_panel_nocov | None | Panel | ✅ Pass |\n| wei_aft_panel_tfc | Fixed | Panel | ✅ Pass |\n| wei_aft_panel_tvc | Time-varying | Panel | ✅ Pass |\n\n### 6.3 Gompertz AFT\n\n| Test | Covariates | Data Type | Status |\n|------|------------|-----------|--------|\n| gom_aft_exact_nocov | None | Exact | ✅ Pass |\n| gom_aft_exact_tfc | Fixed | Exact | ✅ Pass |\n| gom_aft_exact_tvc | Time-varying | Exact | ✅ Pass |\n| gom_aft_panel_nocov | None | Panel | ✅ Pass |\n| gom_aft_panel_tfc | Fixed | Panel | ✅ Pass |\n| gom_aft_panel_tvc | Time-varying | Panel | ✅ Pass |\n\n::: {.callout-note}\n## AFT Panel Models Use MCEM with PhaseType Proposal\n\nAFT panel models are fitted via MCEM. The PhaseType proposal must scale rates by\n`exp(-β'x)` (not `exp(β'x)` as in PH models). This was fixed in v0.3.0+.\n:::\n\n---\n\n## 7. Penalized Spline Models\n\n### 7.1 Smooth Covariate Effects (s(x))\n\n| Test | True Function | Status |\n|------|---------------|--------|\n| Sinusoidal | f(x) = sin(2πx) | ✅ Pass |\n| Quadratic | f(x) = x² | ✅ Pass |\n| Sigmoid | f(x) = tanh(5(x-0.5)) | ✅ Pass |\n| s(x) + Linear | f(x) = sin(2πx) + 0.5·trt | ✅ Pass |\n\n### 7.2 Tensor Product Smooths (te(x,y))\n\n| Test | True Surface | Status |\n|------|--------------|--------|\n| Separable | g(x,y) = sin(πx)cos(πy) | ✅ Pass |\n| Bilinear | g(x,y) = (x-0.5)(y-0.5) | ✅ Pass |\n| Additive | g(x,y) = sin(2πx) + 0.5cos(2πy) | ✅ Pass |\n\n### 7.3 Spline Hazards with Exact Data\n\nTests in `longtest_spline_exact.jl` validate spline hazard recovery with exact \nobservation data (obstype=1) using a Weibull DGP.\n\n| Test | Effect | Covariates | Status |\n|------|--------|------------|--------|\n| sp_exact_nocov | PH | None | ✅ Pass |\n| sp_exact_tfc | PH | Fixed | ✅ Pass |\n| sp_exact_tvc | PH | Time-varying | ✅ Pass |\n| sp_aft_exact_nocov | AFT | None | ✅ Pass |\n| sp_aft_exact_tfc | AFT | Fixed | ✅ Pass |\n| sp_aft_exact_tvc | AFT | Time-varying | ✅ Pass |\n\n### 7.4 MCEM with Spline Hazards\n\n| Test | Approximates | Status |\n|------|--------------|--------|\n| Linear spline | Exponential (constant) hazard | ✅ Pass |\n| Piecewise spline | Step function hazard | ✅ Pass |\n| Cubic spline | Gompertz (exponential increase) | ✅ Pass |\n\n---\n\n## 8. Unpenalized Spline Suite\n\nTests in `longtest_spline_suite.jl` comprehensively validate unpenalized spline hazard inference.\nThe test matrix covers: (exact × panel) × (PH × AFT) × (Markov × PhaseType surrogate) × (nocov × fixed × tvc).\n\n**Validation Strategy**: Generate data from spline models with known B-spline coefficients, then fit\nthe same spline model to directly compare estimated coefficients to true values.\n\n**Spline Configuration**: degree=3 (cubic), 2 interior knots, boundary=[0.0, 15.0], no penalization.\n\n### 8.1 Exact Data Tests (6 tests)\n\n| Test | Effect | Covariates | Status |\n|------|--------|------------|--------|\n| sp_ph_exact_nocov | PH | None | ⏳ Not Run |\n| sp_ph_exact_fixed | PH | Fixed | ⏳ Not Run |\n| sp_ph_exact_tvc | PH | Time-varying | ⏳ Not Run |\n| sp_aft_exact_nocov | AFT | None | ⏳ Not Run |\n| sp_aft_exact_fixed | AFT | Fixed | ⏳ Not Run |\n| sp_aft_exact_tvc | AFT | Time-varying | ⏳ Not Run |\n\n#### 8.1.1 sp_ph_exact_nocov\n\nSpline PH hazard, exact data, no covariates. Tests direct coefficient recovery.\n\n*Test `sp_ph_exact_nocov` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.1.2 sp_ph_exact_fixed\n\nSpline PH hazard, exact data, time-fixed covariate.\n\n*Test `sp_ph_exact_fixed` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.1.3 sp_ph_exact_tvc\n\nSpline PH hazard, exact data, time-varying covariate.\n\n*Test `sp_ph_exact_tvc` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.1.4 sp_aft_exact_nocov\n\nSpline AFT hazard, exact data, no covariates.\n\n*Test `sp_aft_exact_nocov` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.1.5 sp_aft_exact_fixed\n\nSpline AFT hazard, exact data, time-fixed covariate.\n\n*Test `sp_aft_exact_fixed` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.1.6 sp_aft_exact_tvc\n\nSpline AFT hazard, exact data, time-varying covariate.\n\n*Test `sp_aft_exact_tvc` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n### 8.2 Panel Data Tests - Markov Surrogate (6 tests)\n\nTests with panel data using MCEM with Markov surrogate.\n\n| Test | Effect | Covariates | Status |\n|------|--------|------------|--------|\n| sp_ph_panel_markov_nocov | PH | None | ⏳ Not Run |\n| sp_ph_panel_markov_fixed | PH | Fixed | ⏳ Not Run |\n| sp_ph_panel_markov_tvc | PH | Time-varying | ⏳ Not Run |\n| sp_aft_panel_markov_nocov | AFT | None | ⏳ Not Run |\n| sp_aft_panel_markov_fixed | AFT | Fixed | ⏳ Not Run |\n| sp_aft_panel_markov_tvc | AFT | Time-varying | ⏳ Not Run |\n\n#### 8.2.1 sp_ph_panel_markov_nocov\n\nSpline PH, panel data, Markov surrogate, no covariates.\n\n*Test `sp_ph_panel_markov_nocov` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.2.2 sp_ph_panel_markov_fixed\n\nSpline PH, panel data, Markov surrogate, time-fixed covariate.\n\n*Test `sp_ph_panel_markov_fixed` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.2.3 sp_ph_panel_markov_tvc\n\nSpline PH, panel data, Markov surrogate, time-varying covariate.\n\n*Test `sp_ph_panel_markov_tvc` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.2.4 sp_aft_panel_markov_nocov\n\nSpline AFT, panel data, Markov surrogate, no covariates.\n\n*Test `sp_aft_panel_markov_nocov` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.2.5 sp_aft_panel_markov_fixed\n\nSpline AFT, panel data, Markov surrogate, time-fixed covariate.\n\n*Test `sp_aft_panel_markov_fixed` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.2.6 sp_aft_panel_markov_tvc\n\nSpline AFT, panel data, Markov surrogate, time-varying covariate.\n\n*Test `sp_aft_panel_markov_tvc` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n### 8.3 Panel Data Tests - PhaseType Surrogate (6 tests)\n\nTests with panel data using MCEM with PhaseType surrogate.\n\n| Test | Effect | Covariates | Status |\n|------|--------|------------|--------|\n| sp_ph_panel_phasetype_nocov | PH | None | ⏳ Not Run |\n| sp_ph_panel_phasetype_fixed | PH | Fixed | ⏳ Not Run |\n| sp_ph_panel_phasetype_tvc | PH | Time-varying | ⏳ Not Run |\n| sp_aft_panel_phasetype_nocov | AFT | None | ⏳ Not Run |\n| sp_aft_panel_phasetype_fixed | AFT | Fixed | ⏳ Not Run |\n| sp_aft_panel_phasetype_tvc | AFT | Time-varying | ⏳ Not Run |\n\n#### 8.3.1 sp_ph_panel_phasetype_nocov\n\nSpline PH, panel data, PhaseType surrogate, no covariates.\n\n*Test `sp_ph_panel_phasetype_nocov` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.3.2 sp_ph_panel_phasetype_fixed\n\nSpline PH, panel data, PhaseType surrogate, time-fixed covariate.\n\n*Test `sp_ph_panel_phasetype_fixed` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.3.3 sp_ph_panel_phasetype_tvc\n\nSpline PH, panel data, PhaseType surrogate, time-varying covariate.\n\n*Test `sp_ph_panel_phasetype_tvc` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.3.4 sp_aft_panel_phasetype_nocov\n\nSpline AFT, panel data, PhaseType surrogate, no covariates.\n\n*Test `sp_aft_panel_phasetype_nocov` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.3.5 sp_aft_panel_phasetype_fixed\n\nSpline AFT, panel data, PhaseType surrogate, time-fixed covariate.\n\n*Test `sp_aft_panel_phasetype_fixed` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n#### 8.3.6 sp_aft_panel_phasetype_tvc\n\nSpline AFT, panel data, PhaseType surrogate, time-varying covariate.\n\n*Test `sp_aft_panel_phasetype_tvc` not yet run. Execute `longtest_parametric_suite.jl` to populate.*\n\n\n\n\n\n\n::: {.callout-note}\n## Surrogate Comparison\n\nBoth Markov and PhaseType surrogates should produce similar estimates. For each \ntest case, we verify that estimates from both surrogates are within 35% relative\ntolerance of each other (20% for β parameters).\n:::\n\n---\n\n## 9. Notes\n\n- **Model**: 3-state progressive: State 1 → State 2 → State 3\n- **Tolerance**: 35% relative error for main parameters\n- **TVC**: Time-varying covariate effects change at t=5\n- **Exact data**: `obstype=1` (continuous observation)\n- **Panel data**: Discrete observation times with MCEM\n\n",
    "supporting": [
      "03_long_tests_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}