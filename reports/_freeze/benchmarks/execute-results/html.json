{
  "hash": "b11ed091e37bac09dd535cb3071fc9b1",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Performance Benchmarks\"\nsubtitle: \"Computational Performance and Scalability Tests\"\nformat:\n  html:\n    toc: true\n    toc-depth: 3\n    toc-expand: 2\n    code-fold: true\n    code-summary: \"Show code\"\nexecute:\n  echo: true\n  warning: false\n  freeze: auto\n---\n\n\n\n## Benchmark Results\n\n**Note**: These results are generated from `MultistateModelsTests/benchmarks/run_benchmarks.jl`. Last run: December 2025.\n\n::: {#5843b638 .cell execution_count=2}\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div><div style = \"float: left;\"><span>0×2 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Threads</th><th style = \"text-align: left;\">Runtime</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Union{}\" style = \"text-align: left;\">Union{}</th><th title = \"Union{}\" style = \"text-align: left;\">Union{}</th></tr></thead><tbody></tbody></table></div>\n```\n:::\n:::\n\n\n## Scalability Analysis\n\n### Sample Size Scaling\n\n::: {#cell-fig-scalability .cell fig-height='5' execution_count=3}\n``` {.julia .cell-code}\nif !isempty(scalability_df)\n    fig = Figure(size=(700, 400))\n    \n    ax = Axis(fig[1, 1],\n        xlabel=\"Sample Size (n)\",\n        ylabel=\"Runtime (seconds)\",\n        title=\"Runtime Scaling\",\n        xscale=log10,\n        yscale=log10,\n        xticks=(scalability_df.N, string.(scalability_df.N)))\n    \n    scatter!(ax, scalability_df.N, scalability_df.Runtime, label=\"Panel (MCEM)\", \n             markersize=12, color=:orange)\n    lines!(ax, scalability_df.N, scalability_df.Runtime, color=:orange, linewidth=2)\n    \n    axislegend(ax, position=:lt)\n    fig\nelse\n    println(\"No scalability data available.\")\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n![Runtime Scaling with Sample Size](benchmarks_files/figure-html/fig-scalability-output-1.svg){#fig-scalability}\n:::\n:::\n\n\n## SQUAREM Acceleration\n\n::: {#5498a7b3 .cell execution_count=4}\n\n::: {.cell-output .cell-output-stdout}\n```\nSQUAREM Runtime (N=200): 0.0108 seconds\n```\n:::\n:::\n\n\n## Threading Performance\n\n::: {#67a30b90 .cell execution_count=5}\n\n::: {.cell-output .cell-output-stdout}\n```\nNo threading data available.\n```\n:::\n:::\n\n\n### Complexity Analysis\n\n| Operation | Complexity | Notes |\n|-----------|------------|-------|\n| Exact likelihood | O(n) | Per-subject TPM computation |\n| Panel likelihood | O(n × k) | k = paths per subject |\n| Gradient computation | O(n × p) | p = number of parameters |\n| MCEM per iteration | O(n × k × m) | m = MCEM paths |\n\n### Threading Recommendations\n\n::: {#a6b758fa .cell execution_count=6}\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div><div style = \"float: left;\"><span>4×3 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Scenario</th><th style = \"text-align: left;\">RecommendedThreads</th><th style = \"text-align: left;\">Notes</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String\" style = \"text-align: left;\">String</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">Small dataset (n &lt; 500)</td><td style = \"text-align: left;\">1-2</td><td style = \"text-align: left;\">Thread overhead dominates</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">Medium dataset (n ~ 1000)</td><td style = \"text-align: left;\">4</td><td style = \"text-align: left;\">Good balance</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">Large dataset (n &gt; 2000)</td><td style = \"text-align: left;\">8-16</td><td style = \"text-align: left;\">Near-linear scaling</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">MCEM with many paths</td><td style = \"text-align: left;\">Match physical cores</td><td style = \"text-align: left;\">Memory bandwidth limit</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## Phase-Type Proposal Performance\n\n*Benchmark pending implementation.*\n\n## Running Benchmarks\n\n```bash\n# Full benchmark suite\njulia --project=MultistateModelsTests MultistateModelsTests/benchmarks/run_benchmarks.jl\n```\n\n### Benchmark Environment\n\n::: {#b4b43c76 .cell execution_count=7}\n``` {.julia .cell-code code-fold=\"show\"}\n# System information for reproducibility\nprintln(\"Julia version: \", VERSION)\nprintln(\"Threads available: \", Threads.nthreads())\n# println(\"Physical cores: \", MultistateModels.get_physical_cores())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nJulia version: 1.12.2\nThreads available: 1\n```\n:::\n:::\n\n\n## Summary\n\n### Performance Highlights\n\n1. **Exact data fitting**: Scales linearly with sample size\n2. **Panel data (MCEM)**: Slower than exact, but handles interval censoring\n3. **SQUAREM**: Accelerated EM convergence (enabled by default)\n4. **Threading**: Parallel likelihood computation\n5. **Phase-type proposals**: Critical for non-exponential hazards in MCEM\n\n### Optimization Tips\n\n1. **Use exact observations when available** - much faster than panel\n2. **Enable SQUAREM** - default in `fit()`, significantly faster\n3. **Match threads to physical cores** - avoid hyperthreading overhead\n4. **Use phase-type proposals for semi-Markov** - automatic selection in `fit()`\n5. **Profile before optimizing** - identify actual bottlenecks\n\n### Memory Management\n\n- Pre-allocate path storage for MCEM\n- Use `CachedTransformStrategy()` for repeated simulations\n- Consider batched processing for very large datasets\n\n",
    "supporting": [
      "benchmarks_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}