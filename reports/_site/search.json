[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Unit Test Coverage",
    "section": "",
    "text": "Branch: penalized_splines ¬† Commit: bde2a53"
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "Unit Test Coverage",
    "section": "Overview",
    "text": "Overview\nComprehensive validation and documentation for MultistateModels.jl ‚Äî a Julia package for continuous-time multistate modeling.\n\n\nüìê Architecture\nType hierarchy, hazard families, inference engine, and simulation strategies.\n\n\n‚úÖ Unit Tests\nFunction-level tests for hazards, simulation, MCEM, and model construction.\n\n\nüìä Long Tests\nStatistical recovery of parameters across hazard families and data types.\n\n\nüéØ Simulation\nVisual verification of event time distributions (CDF diagnostic plots).\n\n\n‚ö° Benchmarks\nPerformance comparison of sampling methods and optimization strategies.\n\n\nüì¶ Main Package\nSource code and documentation for MultistateModels.jl."
  },
  {
    "objectID": "index.html#test-results-summary",
    "href": "index.html#test-results-summary",
    "title": "Unit Test Coverage",
    "section": "Test Results Summary",
    "text": "Test Results Summary\nNo cached test results available."
  },
  {
    "objectID": "index.html#quick-start",
    "href": "index.html#quick-start",
    "title": "Unit Test Coverage",
    "section": "Quick Start",
    "text": "Quick Start\n\nBuilding Reports Locally\ncd MultistateModelsTests/reports\nquarto render\n\n\nRunning Tests and Recording Results\n# Run full test suite with automatic cache recording\njulia --project=. -e 'using MultistateModelsTests; MultistateModelsTests.runtests()'\n\n# Or run with the dedicated script\njulia --project=. scripts/run_all_tests.jl\nTest results are automatically cached when running via runtests().\n\n\nChecking Cache Status\njulia --project=. scripts/refresh_cache.jl"
  },
  {
    "objectID": "02_unit_tests.html",
    "href": "02_unit_tests.html",
    "title": "Unit Test Coverage",
    "section": "",
    "text": "Metric\nValue\n\n\n\n\nTotal Test Files\n26\n\n\nTotal Test Cases\n~2831\n\n\nPassing\n~2831\n\n\nFailing\n0\n\n\nBranch\npenalized_splines\n\n\nRuntime\n~8.5 minutes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nArea\nTest Files\nDescription\n\n\n\n\nHazard Evaluation\ntest_hazards.jl, test_compute_hazard.jl\nHazard functions, cumulative hazards, survival\n\n\nSpline Infrastructure\ntest_splines.jl, test_penalty_infrastructure.jl\nB-spline basis, penalization\n\n\nSimulation\ntest_simulation.jl\nPath simulation, distribution fidelity\n\n\nMCEM Algorithm\ntest_mcem.jl\nMonte Carlo EM helper functions\n\n\nPhase-Type\ntest_phasetype.jl\nState expansion, FFBS, emission matrices, Coxian math\n\n\nSurrogates\ntest_surrogates.jl\nMarkov and phase-type surrogate fitting\n\n\nSIR Resampling\ntest_sir.jl\nMultinomial and LHS resampling\n\n\nVariance Estimation\ntest_variance.jl\nModel, IJ, jackknife variance\n\n\nWeights\ntest_subject_weights.jl\nSubject and observation weights\n\n\nPIJCV\ntest_pijcv.jl\nSmoothing parameter selection\n\n\nLikelihood\ntest_loglik_analytical.jl\nExact, panel, penalized likelihoods\n\n\nModel Construction\ntest_hazard_macro.jl, test_initialization.jl\nModel building, parameter init\n\n\nInfrastructure\ntest_bounds.jl, test_constraints.jl, test_ad_backends.jl\nParameter bounds, optimization, AD compatibility"
  },
  {
    "objectID": "02_unit_tests.html#coverage-summary",
    "href": "02_unit_tests.html#coverage-summary",
    "title": "Unit Test Coverage",
    "section": "",
    "text": "Metric\nValue\n\n\n\n\nTotal Test Files\n26\n\n\nTotal Test Cases\n~2831\n\n\nPassing\n~2831\n\n\nFailing\n0\n\n\nBranch\npenalized_splines\n\n\nRuntime\n~8.5 minutes\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nArea\nTest Files\nDescription\n\n\n\n\nHazard Evaluation\ntest_hazards.jl, test_compute_hazard.jl\nHazard functions, cumulative hazards, survival\n\n\nSpline Infrastructure\ntest_splines.jl, test_penalty_infrastructure.jl\nB-spline basis, penalization\n\n\nSimulation\ntest_simulation.jl\nPath simulation, distribution fidelity\n\n\nMCEM Algorithm\ntest_mcem.jl\nMonte Carlo EM helper functions\n\n\nPhase-Type\ntest_phasetype.jl\nState expansion, FFBS, emission matrices, Coxian math\n\n\nSurrogates\ntest_surrogates.jl\nMarkov and phase-type surrogate fitting\n\n\nSIR Resampling\ntest_sir.jl\nMultinomial and LHS resampling\n\n\nVariance Estimation\ntest_variance.jl\nModel, IJ, jackknife variance\n\n\nWeights\ntest_subject_weights.jl\nSubject and observation weights\n\n\nPIJCV\ntest_pijcv.jl\nSmoothing parameter selection\n\n\nLikelihood\ntest_loglik_analytical.jl\nExact, panel, penalized likelihoods\n\n\nModel Construction\ntest_hazard_macro.jl, test_initialization.jl\nModel building, parameter init\n\n\nInfrastructure\ntest_bounds.jl, test_constraints.jl, test_ad_backends.jl\nParameter bounds, optimization, AD compatibility"
  },
  {
    "objectID": "02_unit_tests.html#hazard-functions-test_hazards.jl",
    "href": "02_unit_tests.html#hazard-functions-test_hazards.jl",
    "title": "Unit Test Coverage",
    "section": "2. Hazard Functions (test_hazards.jl)",
    "text": "2. Hazard Functions (test_hazards.jl)\nTests verify that all parametric hazard families return mathematically correct values against analytical formulas.\n\n2.1 Mathematical Reference\n\n\n\n\n\n\nNoteAnalytical Hazard Formulas (Click to expand)\n\n\n\n\n\nExponential:\n\n\\(h(t) = \\lambda\\) (constant hazard)\n\\(H(t) = \\lambda t\\) (cumulative hazard)\n\\(S(t) = \\exp(-\\lambda t)\\) (survival function)\n\nWeibull (shape \\(\\kappa\\), scale \\(\\lambda\\)):\n\n\\(h(t) = \\lambda \\kappa t^{\\kappa-1}\\) (increasing/decreasing with \\(t\\))\n\\(H(t) = \\lambda t^\\kappa\\)\n\\(S(t) = \\exp(-\\lambda t^\\kappa)\\)\n\nGompertz (shape \\(a\\), rate \\(b\\)) - flexsurv parameterization:\n\n\\(h(t) = b \\exp(at)\\) (\\(a&gt;0\\): increasing, \\(a&lt;0\\): decreasing)\n\\(H(t) = \\frac{b}{a}(\\exp(at) - 1)\\) for \\(a \\neq 0\\)\n\\(S(t) = \\exp\\left(-\\frac{b}{a}(\\exp(at) - 1)\\right)\\)\n\nCovariate Effects:\n\nProportional Hazards (PH): \\(h(t|x) = h_0(t) \\exp(\\beta'x)\\)\nAccelerated Failure Time (AFT): \\(h(t|x) = h_0(t \\cdot e^{-\\beta'x}) e^{-\\beta'x}\\)\n\n\n\n\n\n\n2.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Test Criteria (Click to expand)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTest\nCriterion\nFormula Verified\nTolerance\n\n\n\n\nSurvival probability\n\\(1 - S(0,t) = F(t)\\) matches Distributions.Exponential\nTotal hazard rate = 0.2, \\(F(2) = 1 - e^{-0.4}\\)\nrtol=1e-6\n\n\nExponential baseline\n\\(h(t) = \\lambda\\) constant in \\(t\\)\neval_hazard = rate parameter\nrtol=1e-6\n\n\nExponential with covariates\n\\(\\log h = \\log\\lambda + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_{12} x_1 x_2\\)\nFull linear predictor formula\nExact match\n\n\nWeibull baseline\n\\(\\log h = \\log\\lambda + \\log\\kappa + (\\kappa-1)\\log t\\)\nLog-hazard at \\(t=1.7\\)\nrtol=1e-6\n\n\nWeibull with covariates\nPH and AFT covariate effects\nShape and scale adjustments\nrtol=1e-6\n\n\nGompertz baseline\n\\(h(t) = b\\exp(at)\\)\nRate exponentially increasing in \\(t\\)\nrtol=1e-6\n\n\nGompertz cumhaz\n\\(H(t) = (b/a)(\\exp(at)-1)\\)\nAnalytical integration\nrtol=1e-6\n\n\nTime transform parity\neval_hazard(apply_transform=true) = eval_hazard(apply_transform=false)\nTang optimization produces identical values\nExact match\n\n\nCumulative hazard additivity\n\\(H(a,c) = H(a,b) + H(b,c)\\)\nInterval splitting\nrtol=1e-8\n\n\n\nTolerance Justification: rtol=1e-6 accounts for ParameterHandling.positive() using \\(\\varepsilon \\approx 1.49 \\times 10^{-8}\\) safety margin in exp/log round-trips.\n\n\n\n\n\n2.3 Summary Table\n\n\n\nFamily\nBaseline\nCovariates\nAFT\nTime Transform\nStatus\n\n\n\n\nExponential\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass\n\n\nWeibull\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass\n\n\nGompertz\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass\n\n\nSpline\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass"
  },
  {
    "objectID": "02_unit_tests.html#spline-hazards-test_splines.jl",
    "href": "02_unit_tests.html#spline-hazards-test_splines.jl",
    "title": "Unit Test Coverage",
    "section": "3. Spline Hazards (test_splines.jl)",
    "text": "3. Spline Hazards (test_splines.jl)\nTests verify B-spline basis construction, numerical integration accuracy, and penalization infrastructure.\n\n3.1 Mathematical Reference\n\n\n\n\n\n\nNoteSpline Mathematical Background (Click to expand)\n\n\n\n\n\nB-Spline Hazard:\n\n\\(h(t) = \\sum_i \\beta_i B_i(t)\\) where \\(B_i\\) are B-spline basis functions\nCoefficients \\(\\beta_i &gt; 0\\) ensure non-negative hazard\n\nCumulative Hazard:\n\n\\(H(a,b) = \\int_a^b h(t) dt = \\sum_i \\beta_i \\int_a^b B_i(t) dt\\)\nUses analytical B-spline antiderivative (not numerical quadrature)\n\nSecond-Order Penalty Matrix:\n\n\\(\\mathbf{P} = \\int \\mathbf{B}''(t) \\mathbf{B}''(t)' dt\\)\nPenalizes deviation from linearity (Wood, 2017)\nMust be symmetric, positive semi-definite with \\(\\text{rank} = k - m\\) where \\(m\\) = penalty order\n\nTensor Product (te()):\n\n\\(f(x,y) = \\sum_i \\sum_j \\beta_{ij} B_i^{(x)}(x) B_j^{(y)}(y)\\)\nBasis: Kronecker product \\(\\mathbf{B}^{(x)} \\otimes \\mathbf{B}^{(y)}\\)\nPenalty: Row + column penalties on coefficient matrix\n\n\n\n\n\n\n3.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Spline Test Criteria (Click to expand)\n\n\n\n\n\nNumerical Integration Verification:\n\n\n\n\n\n\n\n\nTest\nCriterion\nMethod\n\n\n\n\nCumhaz vs QuadGK\n\\(H(a,b)_\\text{impl} \\approx \\int_a^b h(t)dt\\)\nQuadGK adaptive quadrature, 5 random parameter configs, 5 intervals each\n\n\nB-spline antiderivative\nBSplineKit integral() matches QuadGK\nrtol=1e-10 (machine precision for polynomials)\n\n\nCovariate effect\n\\(H(a,b|x) = H_0(a,b) \\exp(\\beta'x)\\) for PH\nMultiple covariate values\n\n\n\nPenalty Matrix Properties:\n\n\n\n\n\n\n\nProperty\nCriterion\n\n\n\n\nSymmetry\n\\(\\mathbf{P} = \\mathbf{P}'\\) exactly\n\n\nPositive semi-definiteness\nAll eigenvalues \\(\\geq 0\\)\n\n\nNull space dimension\n\\(\\text{dim}(\\text{null}(\\mathbf{P})) = m\\) (penalty order)\n\n\nNull space basis\nContains polynomials of degree \\(&lt; m\\)\n\n\n\nSmooth Term Parsing:\n\n\n\nTest\nInput\nExpected Output\n\n\n\n\nBasic s(x)\n@formula(0 ~ s(x))\nSmoothTerm with default k=10\n\n\nCustom k\n@formula(0 ~ s(x, k=15))\nSmoothTerm with k=15\n\n\nCustom m\n@formula(0 ~ s(x, m=1))\nFirst-order penalty (ridge)\n\n\nTensor product\n@formula(0 ~ te(x,y))\nTensorProductTerm\n\n\n\nAutomatic Knot Placement:\n\n\n\nTest\nCriterion\n\n\n\n\nInterior knots\nPlaced at quantiles of transition times\n\n\nBoundary knots\nSpan observed time range\n\n\nEdge case handling\nk &gt; n_unique_times handled gracefully\n\n\n\n\n\n\n\n\n3.3 Summary Table\n\n\n\n\n\n\n\n\n\nComponent\nTests\nTolerance\nStatus\n\n\n\n\nCumhaz vs numerical integration\n25 random configs\nrtol=1e-6\n‚úÖ Pass\n\n\nB-spline antiderivative\n6 test cases\nrtol=1e-10\n‚úÖ Pass\n\n\nPenalty matrix symmetry\nExact equality\nExact\n‚úÖ Pass\n\n\nPenalty matrix eigenvalues\nAll ‚â• 0\natol=1e-10\n‚úÖ Pass\n\n\nPenalty null space\nDimension = m\nExact count\n‚úÖ Pass\n\n\ns() term parsing\n10+ variants\nN/A\n‚úÖ Pass\n\n\nte() tensor product\nKronecker construction\nExact\n‚úÖ Pass\n\n\nAutomatic knot placement\nQuantile-based\nN/A\n‚úÖ Pass\n\n\nMonotone rectification\nCoefficients non-decreasing\nN/A\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#simulation-test_simulation.jl",
    "href": "02_unit_tests.html#simulation-test_simulation.jl",
    "title": "Unit Test Coverage",
    "section": "4. Simulation (test_simulation.jl)",
    "text": "4. Simulation (test_simulation.jl)\nTests verify simulation produces statistically correct output with correct schema.\n\n4.1 Mathematical Reference\n\n\n\n\n\n\nNoteSimulation Statistical Properties (Click to expand)\n\n\n\n\n\nExponential Distribution (\\(\\text{Exp}(\\lambda)\\)):\n\nMean: \\(E[T] = 1/\\lambda\\)\nVariance: \\(\\text{Var}(T) = 1/\\lambda^2\\)\nStandard error of sample mean: \\(\\text{SE}(\\bar{T}) = 1/(\\lambda\\sqrt{n})\\)\n\nStatistical Tests Applied:\n\nSample mean within 10% of true mean (relative tolerance)\nSample variance within 15% of true variance\nSample mean within 3 standard errors of true mean (statistical validity)\n\n\n\n\n\n\n4.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Simulation Test Criteria (Click to expand)\n\n\n\n\n\nDistribution Correctness (n=500 simulations):\n\n\n\n\n\n\n\n\nTest\nCriterion\nParameters\n\n\n\n\nMean\n\\(\\|\\bar{T} - 1/\\lambda\\| / (1/\\lambda) &lt; 0.10\\)\n\\(\\lambda=0.5\\), true mean = 2.0\n\n\nVariance\n\\(\\|s^2 - 1/\\lambda^2\\| / (1/\\lambda^2) &lt; 0.15\\)\ntrue var = 4.0\n\n\nStandard error\n\\(\\|\\bar{T} - 2.0\\| &lt; 3 \\times \\text{SE}\\)\n\\(\\text{SE} \\approx 0.0894\\)\n\n\n\nDataFrame Schema:\n\n\n\nColumn\nRequired Type\nConstraint\n\n\n\n\nid\nInt\nSubject identifier\n\n\ntstart\nFloat64\nInterval start\n\n\ntstop\nFloat64\nInterval end, tstop &gt; tstart\n\n\nstatefrom\nInt\nOrigin state\n\n\nstateto\nInt\nDestination state\n\n\nobstype\nInt\nObservation type\n\n\n\nPath Validity:\n\n\n\nTest\nCriterion\n\n\n\n\nMonotonic times\ntimes[i+1] &gt; times[i] for all \\(i\\)\n\n\nLegal transitions\ntmat[from, to] &gt; 0 when state changes\n\n\nInitial state\nMatches statefrom in data\n\n\nAbsorbing states\nNo transitions out of absorbing states\n\n\n\nTransform Strategy Equivalence:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nCachedTransformStrategy vs DirectTransformStrategy\nIdentical distribution (same RNG seed)\n\n\n\n\n\n\n\n\n4.3 Summary Table\n\n\n\nTest Category\nTests\nStatus\n\n\n\n\nMean correctness\n1\n‚úÖ Pass\n\n\nVariance correctness\n1\n‚úÖ Pass\n\n\nSchema validation\n3 simulations √ó 6 columns\n‚úÖ Pass\n\n\nMonotonic times\n50 paths\n‚úÖ Pass\n\n\nLegal transitions\n50 paths\n‚úÖ Pass\n\n\nInitial state\n20 paths\n‚úÖ Pass\n\n\nTransform strategy parity\nSame RNG\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#mcem-algorithm-test_mcem.jl",
    "href": "02_unit_tests.html#mcem-algorithm-test_mcem.jl",
    "title": "Unit Test Coverage",
    "section": "5. MCEM Algorithm (test_mcem.jl)",
    "text": "5. MCEM Algorithm (test_mcem.jl)\nTests verify Monte Carlo EM helper functions.\n\n5.1 Mathematical Reference\n\n\n\n\n\n\nNoteMCEM Mathematical Background (Click to expand)\n\n\n\n\n\nMCEM Marginal Log-Likelihood:\n\\[Q(\\theta) = \\sum_{i=1}^n w_i \\sum_{j=1}^{m_i} p_{ij} \\ell(\\theta; y_i, z_{ij})\\]\nwhere \\(w_i\\) = subject weight, \\(p_{ij}\\) = importance weight for path \\(j\\) of subject \\(i\\).\nMCEM Asymptotic Standard Error:\n\\[\\text{ASE} = \\sqrt{\\sum_{i=1}^n w_i^2 \\cdot \\text{Var}_{p_i}[\\ell(\\theta; y_i, z_i) - \\ell(\\theta_0; y_i, z_i)]}\\]\n\n\n\n\n\n5.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed MCEM Test Criteria (Click to expand)\n\n\n\n\n\nForwardDiff Gradient Compatibility:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nExactData gradient\nForwardDiff.gradient() produces finite values\n\n\nSMPanelData gradient\nForwardDiff.gradient() produces finite values\n\n\nGradient length\nMatches parameter count\n\n\n\nMCEM Helper Functions:\n\n\n\nFunction\nTest\nExpected Value\n\n\n\n\nmcem_mll\nUnit weights\nSum of weighted log-liks\n\n\nmcem_mll\nNon-unit weights\nSubject-weighted sum\n\n\nmcem_ase\nIdentical logliks\n0.0 (no variance)\n\n\nvar_ris\nAll zeros\n0.0\n\n\n\nMCEM Monotonicity (Limited Iterations):\n\n\n\nTest\nCriterion\n\n\n\n\nQ-function increase\nFinal MLL not substantially worse than initial\n\n\nMC noise allowance\nAllow 10% relative decrease\n\n\n\n\n\n\n\n\n5.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nAD gradient compatibility\n2 data types\n‚úÖ Pass\n\n\nmcem_mll correctness\n2 weight configs\n‚úÖ Pass\n\n\nmcem_ase correctness\n1 edge case\n‚úÖ Pass\n\n\nMCEM monotonicity\n3 iterations\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#sir-resampling-test_sir.jl",
    "href": "02_unit_tests.html#sir-resampling-test_sir.jl",
    "title": "Unit Test Coverage",
    "section": "6. SIR Resampling (test_sir.jl)",
    "text": "6. SIR Resampling (test_sir.jl)\nTests verify Sampling Importance Resampling functions for MCEM.\n\n6.1 Mathematical Reference\n\n\n\n\n\n\nNoteSIR Mathematical Background (Click to expand)\n\n\n\n\n\nPool Size Formula:\n\\[m_\\text{pool} = \\min(c \\cdot m \\cdot \\log(m), m_\\text{max})\\]\nwhere \\(c\\) = constant (default 2), \\(m\\) = target ESS.\nMultinomial Resampling:\n\nSample indices with replacement proportional to weights\nExpected count for index \\(i\\): \\(E[n_i] = m \\cdot w_i\\)\n\nLatin Hypercube Sampling (LHS):\n\nStratified sampling with one sample per stratum\nReduces variance compared to multinomial for smooth functions\n\n\n\n\n\n\n6.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed SIR Test Criteria (Click to expand)\n\n\n\n\n\nPool Size Computation:\n\n\n\nTest\nInput\nExpected\n\n\n\n\nBasic\nESS=50, c=2.0\n\\(\\lceil 2 \\cdot 50 \\cdot \\log(50) \\rceil\\)\n\n\nCap\nESS=1000, max=500\n500\n\n\nLarge ESS\nESS=1000, max=8192\n8192 (capped)\n\n\nEdge case\nESS=1\n1 (log(1)=0 handled)\n\n\n\nMultinomial Resampling:\n\n\n\nTest\nCriterion\n\n\n\n\nOutput length\nEquals requested count\n\n\nIndex range\nAll indices in [1, n_weights]\n\n\nProportionality\nHigher weights selected more often\n\n\nDeterminism\nSame RNG seed ‚Üí same result\n\n\nUniform weights\nApproximately equal counts\n\n\n\nLHS Resampling:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nOutput length\nEquals requested count\n\n\nIndex range\nAll indices in [1, n_weights]\n\n\nVariance reduction\n\\(\\text{Var}(\\bar{X}_\\text{LHS}) \\leq 1.5 \\cdot \\text{Var}(\\bar{X}_\\text{SIR})\\)\n\n\n\nMLL Computation:\n\n\n\n\n\n\n\n\nFunction\nTest\nExpected\n\n\n\n\nmcem_mll_sir\nUniform indices\nMean of selected log-liks\n\n\nmcem_mll_sir\nSubject weights\nWeighted sum\n\n\nmcem_ase_sir\nKnown differences\n\\(\\sqrt{\\sum_i \\text{Var}_i / m_i}\\)\n\n\n\n\n\n\n\n\n6.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nPool size formula\n5 cases\n‚úÖ Pass\n\n\nMultinomial resampling\n5 properties\n‚úÖ Pass\n\n\nLHS resampling\n3 properties\n‚úÖ Pass\n\n\nLHS variance reduction\n200 reps comparison\n‚úÖ Pass\n\n\nMLL with SIR\n2 weight configs\n‚úÖ Pass\n\n\nASE with SIR\nKnown variances\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#variance-estimation-test_variance.jl",
    "href": "02_unit_tests.html#variance-estimation-test_variance.jl",
    "title": "Unit Test Coverage",
    "section": "7. Variance Estimation (test_variance.jl)",
    "text": "7. Variance Estimation (test_variance.jl)\nTests verify variance-covariance matrix computation matches analytical formulas.\n\n7.1 Mathematical Reference\n\n\n\n\n\n\nNoteVariance Estimation Mathematical Background (Click to expand)\n\n\n\n\n\nExponential MLE Fisher Information:\n\nObserved information: \\(I(\\hat\\lambda) = n/\\hat\\lambda^2\\)\nMLE variance: \\(\\text{Var}(\\hat\\lambda) = \\hat\\lambda^2/n\\)\nMLE formula: \\(\\hat\\lambda = n / \\sum_i t_i\\)\n\nInfinitesimal Jackknife (IJ):\n\\[\\text{Var}_\\text{IJ} = \\left(\\frac{\\partial^2 \\ell}{\\partial \\theta^2}\\right)^{-1} \\left(\\sum_i \\frac{\\partial \\ell_i}{\\partial \\theta} \\frac{\\partial \\ell_i}{\\partial \\theta}'\\right) \\left(\\frac{\\partial^2 \\ell}{\\partial \\theta^2}\\right)^{-1}\\]\nJK-IJ Relationship:\n\\[\\text{Var}_\\text{JK} = \\frac{n-1}{n} \\text{Var}_\\text{IJ}\\]\n\n\n\n\n\n7.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Variance Test Criteria (Click to expand)\n\n\n\n\n\nAnalytical Verification (Exponential, n=100):\n\n\n\nTest\nCriterion\nExpected\n\n\n\n\nMLE formula\n\\(\\hat\\lambda = n/\\sum t_i\\)\nrtol=0.001\n\n\nVariance formula\n\\(\\hat\\sigma^2 = \\hat\\lambda^2/n\\)\nrtol=0.01\n\n\nAsymptotic variance\n\\(\\approx \\lambda^2/n = 0.0025\\)\nrtol=0.5\n\n\n\nVariance Matrix Properties:\n\n\n\nProperty\nCriterion\n\n\n\n\nSymmetry\n\\(\\mathbf{V} = \\mathbf{V}'\\) exactly\n\n\nPositive definiteness\nAll eigenvalues &gt; 0\n\n\nEigenvalue sum\n\\(\\sum \\lambda_i = \\text{tr}(\\mathbf{V})\\)\n\n\nDimensions\n\\(p \\times p\\) where \\(p\\) = parameter count\n\n\n\nAPI Functionality:\n\n\n\nTest\nCriterion\n\n\n\n\nget_vcov(type=:model)\nReturns model-based variance\n\n\nget_vcov(type=:ij)\nReturns IJ variance\n\n\nget_vcov(type=:jk)\nReturns jackknife variance\n\n\nUnfitted model\nWarns, returns nothing\n\n\n\n\n\n\n\n\n7.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nMLE analytical match\n1 test\n‚úÖ Pass\n\n\nVariance analytical match\n1 test\n‚úÖ Pass\n\n\nSymmetry\n2 families\n‚úÖ Pass\n\n\nPositive definiteness\n2 families\n‚úÖ Pass\n\n\nEigenvalue checksum\n2 families\n‚úÖ Pass\n\n\nAPI type selection\n3 types\n‚úÖ Pass\n\n\nWarning for missing vcov\n1 test\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#pijcv-smoothing-selection-test_pijcv.jl",
    "href": "02_unit_tests.html#pijcv-smoothing-selection-test_pijcv.jl",
    "title": "Unit Test Coverage",
    "section": "8. PIJCV Smoothing Selection (test_pijcv.jl)",
    "text": "8. PIJCV Smoothing Selection (test_pijcv.jl)\nTests verify Predictive Infinitesimal Jackknife Cross-Validation implementation based on Wood (2024).\n\n8.1 Mathematical Reference\n\n\n\n\n\n\nNotePIJCV Mathematical Background (Click to expand)\n\n\n\n\n\nCholesky Downdate:\nGiven \\(\\mathbf{H} = \\mathbf{L}\\mathbf{L}'\\) and vector \\(v\\), compute \\(\\mathbf{L}_{-}\\) such that: \\[\\mathbf{L}_{-}\\mathbf{L}_{-}' = \\mathbf{H} - vv'\\]\nLOO Newton Step:\n\\[\\hat\\theta_{-i} \\approx \\hat\\theta - (\\mathbf{H} - \\mathbf{H}_i)^{-1} g_i\\]\nwhere \\(\\mathbf{H}_i\\) = subject \\(i\\)‚Äôs Hessian contribution, \\(g_i\\) = gradient contribution.\nPIJCV Criterion (Wood 2024):\n\\[\\text{PIJCV}(\\lambda) = \\sum_{i=1}^n \\ell_i(\\hat\\theta_{-i}(\\lambda))\\]\nMinimizing PIJCV selects optimal \\(\\lambda\\).\n\n\n\n\n\n8.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed PIJCV Test Criteria (Click to expand)\n\n\n\n\n\nCholesky Downdate:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nCorrectness\n\\(\\mathbf{L}_{-}\\mathbf{L}_{-}' = \\mathbf{H} - vv'\\)\n\n\nPD preservation\nAll eigenvalues &gt; 0 after downdate\n\n\nIndefiniteness detection\nReturns false when \\(\\mathbf{H} - vv'\\) not PD\n\n\nNon-mutating copy\nOriginal \\(\\mathbf{L}\\) unchanged\n\n\nSequential downdates\nAccumulate correctly\n\n\n\nLOO Newton Step:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nDirect vs Cholesky\nResults match to rtol=1e-8\n\n\nSubject removal\n\\((\\mathbf{H} - \\mathbf{H}_i)^{-1}\\) computed correctly\n\n\n\nPIJCV Criterion:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nPerturbations\nMatch direct LOO computation\n\n\nObjective value\nCorrect sum of LOO likelihoods\n\n\nEnd-to-end API\nselect_smoothing_parameters returns valid \\(\\lambda\\)\n\n\n\n\n\n\n\n\n8.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nCholesky downdate correctness\n1 test\n‚úÖ Pass\n\n\nPD preservation\n1 test\n‚úÖ Pass\n\n\nIndefiniteness detection\n1 test\n‚úÖ Pass\n\n\nNon-mutating copy\n1 test\n‚úÖ Pass\n\n\nSequential downdates\n1 test\n‚úÖ Pass\n\n\nLOO Newton step\n2 methods compared\n‚úÖ Pass\n\n\nPIJCV criterion\n1 test\n‚úÖ Pass\n\n\nEnd-to-end API\n1 test\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#phase-type-models-test_phasetype.jl",
    "href": "02_unit_tests.html#phase-type-models-test_phasetype.jl",
    "title": "Unit Test Coverage",
    "section": "9. Phase-Type Models (test_phasetype.jl)",
    "text": "9. Phase-Type Models (test_phasetype.jl)\nTests verify phase-type distribution implementation against analytical formulas.\n\n9.1 Mathematical Reference\n\n\n\n\n\n\nNotePhase-Type Mathematical Background (Click to expand)\n\n\n\n\n\n\\(p\\)-Phase Coxian Distribution:\nSub-intensity matrix \\(\\mathbf{S}\\), absorption rates \\(\\mathbf{a}\\), initial distribution \\(\\boldsymbol{\\pi}\\):\n\nDensity: \\(f(t) = \\boldsymbol{\\pi}' \\exp(\\mathbf{S}t) \\mathbf{a}\\)\nSurvival: \\(S(t) = \\boldsymbol{\\pi}' \\exp(\\mathbf{S}t) \\mathbf{1}\\)\nHazard: \\(h(t) = f(t) / S(t)\\)\nCumulative hazard: \\(H(t) = -\\log S(t)\\)\n\n2-Phase Coxian Analytical Formulas:\nFor \\(\\mathbf{S} = \\begin{pmatrix} -(r+a_1) & r \\\\ 0 & -a_2 \\end{pmatrix}\\), \\(\\boldsymbol{\\pi} = (1, 0)'\\):\n\\[\\exp(\\mathbf{S}t)_{11} = e^{-\\lambda_1 t}, \\quad \\exp(\\mathbf{S}t)_{22} = e^{-\\lambda_2 t}\\] \\[\\exp(\\mathbf{S}t)_{12} = \\frac{r(e^{-\\lambda_1 t} - e^{-\\lambda_2 t})}{\\lambda_2 - \\lambda_1}\\]\nwhere \\(\\lambda_1 = r + a_1\\), \\(\\lambda_2 = a_2\\).\n\n\n\n\n\n9.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Phase-Type Test Criteria (Click to expand)\n\n\n\n\n\nEmission Matrix:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nPanel observation (obstype=2)\nAll phases of destination state = 1.0\n\n\nExact transition (obstype=1)\nOnly first phase = 1.0\n\n\nFully censored (obstype=0)\nAll phases = 1.0\n\n\nCustom censoring patterns\nCorrect pattern application\n\n\n\nData Expansion:\n\n\n\nTest\nCriterion\n\n\n\n\nExact transition split\nCreates intermediate ‚Äúremain‚Äù row\n\n\nPanel observation\nNo expansion needed\n\n\nSubject index recomputation\nIndices remain valid\n\n\n\nHazard/Survival Correctness:\n\n\n\nTest\nCriterion\nTolerance\n\n\n\n\n2-phase survival\nMatches analytical formula\nrtol=1e-10\n\n\n2-phase density\nMatches analytical formula\nrtol=1e-10\n\n\n2-phase hazard\n\\(h(t) = f(t)/S(t)\\)\nrtol=1e-10\n\n\nCumulative hazard\n\\(H(t) = -\\log S(t)\\)\nrtol=1e-10\n\n\nLog-likelihood\nAnalytical path likelihood\nrtol=1e-8\n\n\n\nPath Operations:\n\n\n\nTest\nCriterion\n\n\n\n\nExpand path\nObservable states ‚Üí phase states\n\n\nCollapse path\nPhase states ‚Üí observable states\n\n\nRound-trip\nExpand then collapse = original\n\n\n\n\n\n\n\n\n9.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nEmission matrix obstype=1\n1 test\n‚úÖ Pass\n\n\nEmission matrix obstype=2\n1 test\n‚úÖ Pass\n\n\nEmission matrix obstype=0\n1 test\n‚úÖ Pass\n\n\nData expansion\n2 tests\n‚úÖ Pass\n\n\n2-phase survival\n5 time points\n‚úÖ Pass\n\n\n2-phase density\n5 time points\n‚úÖ Pass\n\n\n2-phase hazard\n5 time points\n‚úÖ Pass\n\n\nPath expansion\n1 test\n‚úÖ Pass\n\n\nPath collapse\n1 test\n‚úÖ Pass\n\n\nLog-likelihood\n3 paths\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#likelihood-functions-test_mll_consistency.jl-test_loglik_analytical.jl",
    "href": "02_unit_tests.html#likelihood-functions-test_mll_consistency.jl-test_loglik_analytical.jl",
    "title": "Unit Test Coverage",
    "section": "10. Likelihood Functions (test_mll_consistency.jl, test_loglik_analytical.jl)",
    "text": "10. Likelihood Functions (test_mll_consistency.jl, test_loglik_analytical.jl)\nTests verify likelihood computation consistency across methods.\n\n10.1 Mathematical Reference\n\n\n\n\n\n\nNoteLikelihood Mathematical Background (Click to expand)\n\n\n\n\n\nExact Data Likelihood:\n\\[\\ell(\\theta) = \\sum_i \\left[ \\log h(t_i | x_i) - H(0, t_i | x_i) \\right]\\]\nPanel Data Likelihood (Markov):\n\\[\\ell(\\theta) = \\sum_i \\log \\mathbf{P}(s_i | s_{i-1}, t_i - t_{i-1})\\]\nwhere \\(\\mathbf{P} = \\exp(\\mathbf{Q} \\Delta t)\\) is the transition probability matrix.\nIS-Weighted MLL:\n\\[\\hat\\ell = \\sum_i w_i \\sum_j p_{ij} \\ell_{ij}\\]\n\n\n\n\n\n10.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Likelihood Test Criteria (Click to expand)\n\n\n\n\n\nMLL Consistency Across Methods:\n\n\n\nMethod Pair\nCriterion\nTolerance\n\n\n\n\nIS-weighted vs SIR\nSample-level agreement\n15% relative\n\n\nIS-weighted vs LHS\nSample-level agreement\n15% relative\n\n\nSIR vs LHS\nSample-level agreement\n15% relative\n\n\nSubject-level correlation\n\\(r &gt; 0.85\\)\nN/A\n\n\nSubject-level MAE\n&lt; 25% relative\nN/A\n\n\n\nAnalytical Likelihood (Exponential):\n\n\n\nTest\nCriterion\n\n\n\n\nFormula\n\\(\\ell = n\\log\\lambda - \\lambda \\sum t_i\\)\n\n\nGradient\nMatches ForwardDiff\n\n\n\n\n\n\n\n\n10.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nIS vs SIR agreement\n1 test\n‚úÖ Pass\n\n\nIS vs LHS agreement\n1 test\n‚úÖ Pass\n\n\nSubject-level correlation\n3 pairs\n‚úÖ Pass\n\n\nSubject-level MAE\n2 methods\n‚úÖ Pass\n\n\nAnalytical likelihood\n1 family\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#model-construction-test_modelgeneration.jl-test_initialization.jl",
    "href": "02_unit_tests.html#model-construction-test_modelgeneration.jl-test_initialization.jl",
    "title": "Unit Test Coverage",
    "section": "11. Model Construction (test_modelgeneration.jl, test_initialization.jl)",
    "text": "11. Model Construction (test_modelgeneration.jl, test_initialization.jl)\nTests verify model building and parameter initialization.\n\n11.1 Test Criteria\n\n\n\n\n\n\nNoteDetailed Model Construction Test Criteria (Click to expand)\n\n\n\n\n\nError Detection:\n\n\n\nTest\nInput\nExpected\n\n\n\n\nDuplicate transitions\nTwo hazards 1‚Üí2\nArgumentError\n\n\nState 0 origin\nHazard(..., 0, 1)\nArgumentError\n\n\nState 0 destination\nHazard(..., 1, 0)\nArgumentError\n\n\nSelf-transition\nHazard(..., 1, 1)\nArgumentError\n\n\nInvalid family\nHazard(..., \"invalid\", ...)\nArgumentError\n\n\n\nCensoring Pattern Handling:\n\n\n\nTest\nCriterion\n\n\n\n\nPattern parsing\nRow sums ‚â§ 1\n\n\nobstype &gt; 2\nUses pattern matrix\n\n\nobstype = 0\nAll states possible\n\n\n\nInitialization Methods:\n\n\n\nMethod\nWhen Used\nCriterion\n\n\n\n\n:crude\nMarkov models\nParameters non-NaN\n\n\n:surrogate\nSemi-Markov models\nParameters non-NaN\n\n\n:auto\nDefault\nSelects appropriate method\n\n\n\n\n\n\n\n\n11.2 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nDuplicate transition detection\n1 test\n‚úÖ Pass\n\n\nState 0 detection\n2 tests\n‚úÖ Pass\n\n\nSelf-transition detection\n1 test\n‚úÖ Pass\n\n\nCensoring patterns\n1 test\n‚úÖ Pass\n\n\nCrude initialization\n1 test\n‚úÖ Pass\n\n\nAuto method selection\n1 test\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#reconstructor-test_reconstructor.jl",
    "href": "02_unit_tests.html#reconstructor-test_reconstructor.jl",
    "title": "Unit Test Coverage",
    "section": "12. ReConstructor (test_reconstructor.jl)",
    "text": "12. ReConstructor (test_reconstructor.jl)\nTests verify AD-compatible parameter flattening/unflattening.\n\n12.1 Test Criteria\n\n\n\n\n\n\nNoteDetailed ReConstructor Test Criteria (Click to expand)\n\n\n\n\n\nType Construction:\n\n\n\nInput Type\nFlatten Output\nUnflatten Output\n\n\n\n\nFloat64\n[x]\nx::Float64\n\n\nVector{Float64}\nx (identity)\nx::Vector\n\n\nVector{Int}\n[] (empty)\nOriginal (no flatten)\n\n\nTuple\nConcatenated\nTuple with correct lengths\n\n\nNamedTuple\nConcatenated\nNamedTuple with keys preserved\n\n\n\nAD Compatibility:\n\n\n\nTest\nCriterion\n\n\n\n\nForwardDiff gradient\nThrough unflatten ‚Üí compute ‚Üí flatten\n\n\nType stability\nReturn type matches input type\n\n\nStrict mode\nExact key preservation\n\n\nFlexible mode\nStructural preservation only\n\n\n\nRound-trip:\n\n\n\nTest\nCriterion\n\n\n\n\nunflatten(flatten(x)) == x\nFor all supported types\n\n\nNested structures\nRecursive reconstruction\n\n\n\n\n\n\n\n\n12.2 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nReal number\n2 modes\n‚úÖ Pass\n\n\nFloat vector\n1 test\n‚úÖ Pass\n\n\nInt vector (skip)\n1 test\n‚úÖ Pass\n\n\nTuple\n2 depths\n‚úÖ Pass\n\n\nNamedTuple\n2 depths\n‚úÖ Pass\n\n\nAD compatibility\nForwardDiff\n‚úÖ Pass\n\n\nRound-trip\nAll types\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#additional-tests",
    "href": "02_unit_tests.html#additional-tests",
    "title": "Unit Test Coverage",
    "section": "13. Additional Tests",
    "text": "13. Additional Tests\n\n13.1 AD Backends (test_ad_backends.jl)\n\n\n\nTest\nCriterion\nStatus\n\n\n\n\nType existence\nADBackend types defined\n‚úÖ Pass\n\n\nDefault selection\nParameter count thresholds\n‚úÖ Pass\n\n\nForwardDiff gradient\nFinite, correct length\n‚úÖ Pass\n\n\nfit() integration\nadbackend kwarg works\n‚úÖ Pass\n\n\n\n\n\n13.2 @hazard Macro (test_hazard_macro.jl)\n\n\n\nTest\nCriterion\nStatus\n\n\n\n\nFamily aliases\n:exp, :wei, :gom, :sp, :pt\n‚úÖ Pass\n\n\nTransition syntax\nMultiple formats\n‚úÖ Pass\n\n\nFormula defaults\nIntercept-only\n‚úÖ Pass\n\n\nKeyword forwarding\nknots, n_phases, etc.\n‚úÖ Pass\n\n\nError messages\nMissing/invalid family\n‚úÖ Pass\n\n\n\n\n\n13.3 Model Output (test_model_output.jl)\n\n\n\nTest\nCriterion\nStatus\n\n\n\n\nAIC formula\n\\(-2\\ell + 2k\\)\n‚úÖ Pass\n\n\nBIC formula\n\\(-2\\ell + k\\log n\\)\n‚úÖ Pass\n\n\nSummary table\nTypedTable structure\n‚úÖ Pass\n\n\nestimate_loglik\nESS, MCSE fields\n‚úÖ Pass"
  },
  {
    "objectID": "02_unit_tests.html#coverage-gaps-and-future-work",
    "href": "02_unit_tests.html#coverage-gaps-and-future-work",
    "title": "Unit Test Coverage",
    "section": "14. Coverage Gaps and Future Work",
    "text": "14. Coverage Gaps and Future Work\n\n14.1 Current Gaps\n\n\n\n\n\n\n\n\nArea\nGap\nPriority\n\n\n\n\nAFT + TVC\nLimited testing for AFT with time-varying covariates\nMedium\n\n\nPanel + Splines\nIntegration tests for spline hazards with panel data\nMedium\n\n\nEdge cases\nDegenerate transition matrices\nLow\n\n\nPerformance\nBenchmark regression tests\nLow\n\n\n\n\n\n14.2 Test Suite History\n\n\n\n\n\n\n\n\nDate\nAction\nResult\n\n\n\n\n2026-01-23\nMajor cleanup: consolidated/deleted redundant tests\n26 files, 2831 tests\n\n\n2026-01-22\nMerged variance and weight tests\nReduced redundancy\n\n\n2026-01-21\nMerged phase-type tests (7‚Üí2 files)\nConsolidated coverage\n\n\n2026-01\nAdded analytical likelihood tests\ntest_loglik_analytical.jl\n\n\n2026-01\nAdded penalty infrastructure tests\ntest_penalty_infrastructure.jl\n\n\n\n\n\n14.3 Deleted Test Files (Cleanup 2026-01-23)\nThe following files were deleted during test suite cleanup due to redundancy, obsolescence, or low value:\n\ntest_perf.jl - Hardware-dependent, moved to benchmarks\ntest_error_paths.jl - Redundant with test_error_messages.jl\ntest_infrastructure.jl - Tested internal implementation details\ntest_regressions.jl - Bug fixes now covered by other tests\ntest_modelgeneration.jl - Superseded by test_hazard_macro.jl\ntest_mll_consistency.jl - Superseded by test_loglik_analytical.jl\ntest_helpers.jl - Low value utility function tests\ntest_efs.jl - Outdated EDF implementation\ntest_reconstructor.jl - Internal ReConstructor tests\ntest_phasetype_*.jl (6 files) - Merged into test_phasetype.jl\ntest_pijcv_reference.jl, test_pijcv_vs_loocv.jl - Merged into test_pijcv.jl\ntest_constrained_variance.jl - Merged into test_variance.jl\ntest_observation_weights_emat.jl, test_weight_validation.jl - Merged into test_subject_weights.jl\ntest_concurrency.jl, test_ordering_at.jl - Stale APIs"
  },
  {
    "objectID": "02_unit_tests.html#running-tests",
    "href": "02_unit_tests.html#running-tests",
    "title": "Unit Test Coverage",
    "section": "15. Running Tests",
    "text": "15. Running Tests\n# Run all unit tests\njulia --project -e 'using Pkg; Pkg.test()'\n\n# Run specific test file (standalone - may need imports)\njulia --project -e 'using Test, MultistateModels; include(\"MultistateModelsTests/unit/test_hazards.jl\")'\n\n# Run with full long tests\nMSM_TEST_LEVEL=full julia --project -e 'using Pkg; Pkg.test()'"
  },
  {
    "objectID": "03_long_tests.html",
    "href": "03_long_tests.html",
    "title": "Long Tests Status",
    "section": "",
    "text": "All long tests validate statistical parameter recovery with relative tolerances of 15-35% depending on the complexity of the model and inference method.\nLast full run: January 23, 2026\nBranch: penalized_splines\n\n\n\n\n\n\nNoteTest Suite Cleanup (2026-01-23)\n\n\n\nLong test suite consolidated from 24 files to 13 files. Deleted redundant/deprecated tests: longtest_aft_suite.jl, longtest_sir.jl, longtest_phasetype.jl, longtest_pijcv_loocv.jl, longtest_sensitivity_check.jl, longtest_smooth_covariate_recovery.jl, longtest_tensor_product_recovery.jl, longtest_spline_suite.jl.\nHelper files moved to src/: longtest_config.jl, longtest_helpers.jl, phasetype_longtest_helpers.jl.\n\n\n\n\n\n\n\nTest Suite\nFile\nStatus\n\n\n\n\nParametric Suite\nlongtest_parametric_suite.jl\n‚úÖ\n\n\nExact Markov\nlongtest_exact_markov.jl\n‚úÖ\n\n\nMCEM Parametric\nlongtest_mcem.jl\n‚úÖ\n\n\nMCEM Splines\nlongtest_mcem_splines.jl\n‚úÖ\n\n\nMCEM TVC\nlongtest_mcem_tvc.jl\n‚úÖ\n\n\nPhase-Type Exact\nlongtest_phasetype_exact.jl\n‚úÖ\n\n\nPhase-Type Panel\nlongtest_phasetype_panel.jl\n‚úÖ\n\n\nRobust Parametric\nlongtest_robust_parametric.jl\n‚úÖ\n\n\nRobust Markov/PT\nlongtest_robust_markov_phasetype.jl\n‚úÖ\n\n\nSimulation Dist\nlongtest_simulation_distribution.jl\n‚úÖ\n\n\nSimulation TVC\nlongtest_simulation_tvc.jl\n‚úÖ\n\n\nSpline Exact\nlongtest_spline_exact.jl\n‚úÖ\n\n\nVariance Validation\nlongtest_variance_validation.jl\n‚úÖ\n\n\n\nTotal: 13 long test files"
  },
  {
    "objectID": "03_long_tests.html#overview",
    "href": "03_long_tests.html#overview",
    "title": "Long Tests Status",
    "section": "",
    "text": "All long tests validate statistical parameter recovery with relative tolerances of 15-35% depending on the complexity of the model and inference method.\nLast full run: January 23, 2026\nBranch: penalized_splines\n\n\n\n\n\n\nNoteTest Suite Cleanup (2026-01-23)\n\n\n\nLong test suite consolidated from 24 files to 13 files. Deleted redundant/deprecated tests: longtest_aft_suite.jl, longtest_sir.jl, longtest_phasetype.jl, longtest_pijcv_loocv.jl, longtest_sensitivity_check.jl, longtest_smooth_covariate_recovery.jl, longtest_tensor_product_recovery.jl, longtest_spline_suite.jl.\nHelper files moved to src/: longtest_config.jl, longtest_helpers.jl, phasetype_longtest_helpers.jl.\n\n\n\n\n\n\n\nTest Suite\nFile\nStatus\n\n\n\n\nParametric Suite\nlongtest_parametric_suite.jl\n‚úÖ\n\n\nExact Markov\nlongtest_exact_markov.jl\n‚úÖ\n\n\nMCEM Parametric\nlongtest_mcem.jl\n‚úÖ\n\n\nMCEM Splines\nlongtest_mcem_splines.jl\n‚úÖ\n\n\nMCEM TVC\nlongtest_mcem_tvc.jl\n‚úÖ\n\n\nPhase-Type Exact\nlongtest_phasetype_exact.jl\n‚úÖ\n\n\nPhase-Type Panel\nlongtest_phasetype_panel.jl\n‚úÖ\n\n\nRobust Parametric\nlongtest_robust_parametric.jl\n‚úÖ\n\n\nRobust Markov/PT\nlongtest_robust_markov_phasetype.jl\n‚úÖ\n\n\nSimulation Dist\nlongtest_simulation_distribution.jl\n‚úÖ\n\n\nSimulation TVC\nlongtest_simulation_tvc.jl\n‚úÖ\n\n\nSpline Exact\nlongtest_spline_exact.jl\n‚úÖ\n\n\nVariance Validation\nlongtest_variance_validation.jl\n‚úÖ\n\n\n\nTotal: 13 long test files"
  },
  {
    "objectID": "03_long_tests.html#exponential-hazard-models",
    "href": "03_long_tests.html#exponential-hazard-models",
    "title": "Long Tests Status",
    "section": "2. Exponential Hazard Models",
    "text": "2. Exponential Hazard Models\n\n2.1 exp_exact_nocov\nTest: exp_exact_nocov | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_rate\n0.15\n0.1506\n0.0053\n0.137\n0.1641\n0.4\n‚úì\n\n\nh23_rate\n0.12\n0.1281\n0.0052\n0.1146\n0.1415\n6.7\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†1: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†2: State Prevalence\n\n\n\n\n\n\n\n2.2 exp_exact_fixed\nTest: exp_exact_fixed | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.3753\n0.0632\n0.2126\n0.538\n24.9\n‚úì\n\n\nh12_rate\n0.15\n0.1588\n0.0068\n0.1412\n0.1764\n5.9\n‚úì\n\n\nh23_beta\n0.5\n0.3806\n0.0761\n0.1846\n0.5765\n23.9\n‚úì\n\n\nh23_rate\n0.12\n0.1221\n0.0067\n0.1048\n0.1394\n1.8\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†3: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†4: State Prevalence\n\n\n\n\n\n\n\n2.3 exp_exact_tvc\nTest: exp_exact_tvc | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.4832\n0.0633\n0.3202\n0.6462\n3.4\n‚úì\n\n\nh12_rate\n0.15\n0.1493\n0.0064\n0.1327\n0.1659\n0.4\n‚úì\n\n\nh23_beta\n0.5\n0.5306\n0.0943\n0.2877\n0.7734\n6.1\n‚úì\n\n\nh23_rate\n0.12\n0.1165\n0.01\n0.0908\n0.1421\n2.9\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†5: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†6: State Prevalence\n\n\n\n\n\n\n\n2.4 exp_panel_nocov\nTest: exp_panel_nocov | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_rate\n0.15\n0.1558\n0.0054\n0.1419\n0.1697\n3.9\n‚úì\n\n\nh23_rate\n0.12\n0.1175\n0.0059\n0.1022\n0.1328\n2.1\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†7: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†8: State Prevalence\n\n\n\n\n\n\n\n2.5 exp_panel_fixed\nTest: exp_panel_fixed | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.4897\n0.0674\n0.3162\n0.6632\n2.1\n‚úì\n\n\nh12_rate\n0.15\n0.1516\n0.0073\n0.1329\n0.1704\n1.1\n‚úì\n\n\nh23_beta\n0.5\n0.5413\n0.0905\n0.3081\n0.7746\n8.3\n‚úì\n\n\nh23_rate\n0.12\n0.1147\n0.0082\n0.0935\n0.1359\n4.4\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†9: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†10: State Prevalence\n\n\n\n\n\n\n\n2.6 exp_panel_tvc\nTest: exp_panel_tvc | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.498\n0.0693\n0.3194\n0.6766\n0.4\n‚úì\n\n\nh12_rate\n0.15\n0.15\n0.0065\n0.1332\n0.1668\n0.0\n‚úì\n\n\nh23_beta\n0.5\n0.5008\n0.0968\n0.2514\n0.7502\n0.2\n‚úì\n\n\nh23_rate\n0.12\n0.1261\n0.0104\n0.0994\n0.1528\n5.1\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†11: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†12: State Prevalence"
  },
  {
    "objectID": "03_long_tests.html#weibull-hazard-models",
    "href": "03_long_tests.html#weibull-hazard-models",
    "title": "Long Tests Status",
    "section": "3. Weibull Hazard Models",
    "text": "3. Weibull Hazard Models\n\n3.1 wei_exact_nocov\nTest: wei_exact_nocov | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_scale\n0.15\n0.1597\n0.0098\n0.1343\n0.185\n6.4\n‚úì\n\n\nh12_shape\n1.3\n1.2714\n0.0301\n1.1938\n1.349\n2.2\n‚úì\n\n\nh23_scale\n0.12\n0.1459\n0.01\n0.1201\n0.1716\n21.5\n‚úó\n\n\nh23_shape\n1.1\n1.0215\n0.0306\n0.9427\n1.1004\n7.1\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†13: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†14: State Prevalence\n\n\n\n\n\n\n\n3.2 wei_exact_fixed\nTest: wei_exact_fixed | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.5138\n0.0656\n0.3448\n0.6828\n2.8\n‚úì\n\n\nh12_scale\n0.15\n0.1518\n0.0105\n0.1249\n0.1788\n1.2\n‚úì\n\n\nh12_shape\n1.3\n1.2936\n0.0304\n1.2152\n1.372\n0.5\n‚úì\n\n\nh23_beta\n0.5\n0.4856\n0.0675\n0.3117\n0.6595\n2.9\n‚úì\n\n\nh23_scale\n0.12\n0.124\n0.0102\n0.0978\n0.1501\n3.3\n‚úì\n\n\nh23_shape\n1.1\n1.0763\n0.0317\n0.9948\n1.1579\n2.2\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†15: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†16: State Prevalence\n\n\n\n\n\n\n\n3.3 wei_exact_tvc\nTest: wei_exact_tvc | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.4739\n0.0909\n0.2397\n0.708\n5.2\n‚úì\n\n\nh12_scale\n0.15\n0.151\n0.01\n0.1253\n0.1767\n0.7\n‚úì\n\n\nh12_shape\n1.3\n1.3483\n0.0416\n1.2411\n1.4556\n3.7\n‚úì\n\n\nh23_beta\n0.5\n0.4002\n0.0892\n0.1704\n0.63\n20.0\n‚úì\n\n\nh23_scale\n0.12\n0.1221\n0.0093\n0.098\n0.1461\n1.7\n‚úì\n\n\nh23_shape\n1.1\n1.1236\n0.0368\n1.0287\n1.2185\n2.1\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†17: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†18: State Prevalence\n\n\n\n\n\n\n\n3.4 wei_mcem_nocov\nTest: wei_mcem_nocov | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_scale\n0.15\n0.1947\n0.0157\n0.1542\n0.2351\n29.8\n‚úó\n\n\nh12_shape\n1.3\n1.1645\n0.0404\n1.0605\n1.2684\n10.4\n‚úó\n\n\nh23_scale\n0.12\n0.0928\n0.0068\n0.0753\n0.1103\n22.7\n‚úó\n\n\nh23_shape\n1.1\n1.222\n0.0336\n1.1355\n1.3086\n11.1\n‚úó\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†19: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†20: State Prevalence\n\n\n\n\n\n\n\n3.5 wei_mcem_fixed\nTest: wei_mcem_fixed | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.4717\n0.0625\n0.3106\n0.6328\n5.7\n‚úì\n\n\nh12_scale\n0.15\n0.1649\n0.0142\n0.1284\n0.2014\n9.9\n‚úì\n\n\nh12_shape\n1.3\n1.2753\n0.0408\n1.1702\n1.3803\n1.9\n‚úì\n\n\nh23_beta\n0.5\n0.598\n0.0758\n0.4027\n0.7933\n19.6\n‚úì\n\n\nh23_scale\n0.12\n0.0906\n0.0072\n0.0721\n0.1091\n24.5\n‚úó\n\n\nh23_shape\n1.1\n1.1987\n0.0303\n1.1207\n1.2767\n9.0\n‚úó\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†21: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†22: State Prevalence\n\n\n\n\n\n\n\n3.6 wei_mcem_tvc\nTest: wei_mcem_tvc | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.5557\n0.1035\n0.289\n0.8224\n11.1\n‚úì\n\n\nh12_scale\n0.15\n0.1626\n0.0146\n0.125\n0.2002\n8.4\n‚úì\n\n\nh12_shape\n1.3\n1.2475\n0.0578\n1.0986\n1.3964\n4.0\n‚úì\n\n\nh23_beta\n0.5\n0.5325\n0.0955\n0.2866\n0.7784\n6.5\n‚úì\n\n\nh23_scale\n0.12\n0.0844\n0.0072\n0.0658\n0.103\n29.7\n‚úó\n\n\nh23_shape\n1.1\n1.2483\n0.0368\n1.1535\n1.3432\n13.5\n‚úó\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†23: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†24: State Prevalence"
  },
  {
    "objectID": "03_long_tests.html#gompertz-hazard-models",
    "href": "03_long_tests.html#gompertz-hazard-models",
    "title": "Long Tests Status",
    "section": "4. Gompertz Hazard Models",
    "text": "4. Gompertz Hazard Models\n\n4.1 gom_exact_nocov\nTest: gom_exact_nocov | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_rate\n0.04\n0.0451\n0.0033\n0.0366\n0.0536\n12.7\n‚úì\n\n\nh12_shape\n0.08\n0.0744\n0.0087\n0.052\n0.0967\n7.1\n‚úì\n\n\nh23_rate\n0.03\n0.0367\n0.0045\n0.0252\n0.0482\n22.3\n‚úì\n\n\nh23_shape\n0.06\n0.0233\n0.0208\n-0.0303\n0.0768\n61.2\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†25: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†26: State Prevalence\n\n\n\n\n\n\n\n4.2 gom_exact_fixed\nTest: gom_exact_fixed | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.5307\n0.072\n0.3452\n0.7162\n6.1\n‚úì\n\n\nh12_rate\n0.04\n0.0371\n0.0034\n0.0284\n0.0458\n7.3\n‚úì\n\n\nh12_shape\n0.08\n0.092\n0.0089\n0.069\n0.1149\n14.9\n‚úì\n\n\nh23_beta\n0.5\n0.5945\n0.1345\n0.2482\n0.9408\n18.9\n‚úì\n\n\nh23_rate\n0.03\n0.0346\n0.0047\n0.0224\n0.0468\n15.3\n‚úì\n\n\nh23_shape\n0.06\n0.0124\n0.0179\n-0.0338\n0.0586\n79.3\n‚úó\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†27: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†28: State Prevalence\n\n\n\n\n\n\n\n4.3 gom_exact_tvc\nTest: gom_exact_tvc | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.4752\n0.1246\n0.1543\n0.7961\n5.0\n‚úì\n\n\nh12_rate\n0.04\n0.0396\n0.003\n0.0318\n0.0475\n1.0\n‚úì\n\n\nh12_shape\n0.08\n0.0889\n0.0138\n0.0533\n0.1246\n11.2\n‚úì\n\n\nh23_beta\n0.5\n0.3798\n0.2564\n-0.2806\n1.0402\n24.0\n‚úì\n\n\nh23_rate\n0.03\n0.0287\n0.0069\n0.011\n0.0463\n4.4\n‚úì\n\n\nh23_shape\n0.06\n0.0705\n0.0177\n0.0248\n0.1161\n17.4\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†29: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†30: State Prevalence\n\n\n\n\n\n\n\n4.4 gom_mcem_nocov\nTest: gom_mcem_nocov | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_rate\n0.04\n0.0403\n0.0026\n0.0335\n0.047\n0.6\n‚úì\n\n\nh12_shape\n0.08\n0.0787\n0.0052\n0.0655\n0.092\n1.6\n‚úì\n\n\nh23_rate\n0.03\n0.0277\n0.0023\n0.0217\n0.0338\n7.5\n‚úì\n\n\nh23_shape\n0.06\n0.0708\n0.0082\n0.0498\n0.0918\n18.0\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†31: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†32: State Prevalence\n\n\n\n\n\n\n\n4.5 gom_mcem_fixed\nTest: gom_mcem_fixed | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.5428\n0.0669\n0.3705\n0.7152\n8.6\n‚úì\n\n\nh12_rate\n0.04\n0.0379\n0.0028\n0.0306\n0.0452\n5.2\n‚úì\n\n\nh12_shape\n0.08\n0.0813\n0.0054\n0.0673\n0.0953\n1.6\n‚úì\n\n\nh23_beta\n0.5\n0.5008\n0.087\n0.2766\n0.725\n0.2\n‚úì\n\n\nh23_rate\n0.03\n0.0274\n0.0025\n0.0209\n0.0338\n8.8\n‚úì\n\n\nh23_shape\n0.06\n0.0678\n0.0074\n0.0487\n0.087\n13.1\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†33: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†34: State Prevalence\n\n\n\n\n\n\n\n4.6 gom_mcem_tvc\nTest: gom_mcem_tvc | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nh12_beta\n0.5\n0.7611\n0.109\n0.4802\n1.042\n52.2\n‚úì\n\n\nh12_rate\n0.04\n0.0395\n0.0029\n0.032\n0.047\n1.2\n‚úì\n\n\nh12_shape\n0.08\n0.0612\n0.0086\n0.039\n0.0835\n23.5\n‚úì\n\n\nh23_beta\n0.5\n0.6048\n0.2885\n-0.1385\n1.348\n21.0\n‚úì\n\n\nh23_rate\n0.03\n0.0233\n0.0065\n0.0064\n0.0402\n22.3\n‚úì\n\n\nh23_shape\n0.06\n0.0716\n0.0076\n0.0521\n0.0911\n19.3\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†35: Cumulative Incidence\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†36: State Prevalence"
  },
  {
    "objectID": "03_long_tests.html#phase-type-hazard-models",
    "href": "03_long_tests.html#phase-type-hazard-models",
    "title": "Long Tests Status",
    "section": "5. Phase-Type Hazard Models",
    "text": "5. Phase-Type Hazard Models\nPhase-type hazard models use Coxian phase-type distributions to model sojourn times. Unlike standard parametric hazards (exponential, Weibull, Gompertz), phase-type hazards operate on an expanded state space where each observed state has multiple latent phases with exponential hazards.\nThese tests validate inference for models where the target model uses phase-type hazards. This is different from using phase-type as a proposal distribution for MCEM.\n\n\n\n\n\n\nNote\n\n\n\nNote on plots: Prevalence and cumulative incidence plots for phase-type tests show True (from simulation with true parameters) and Estimated (from simulation with fitted parameters) curves on the observed state space, not the expanded phase space. The capture_phasetype_longtest_result! function collapses phase-level prevalence to observed state prevalence using the phase_to_state mapping.\n\n\n\n\n\n\n\n\nWarning\n\n\n\nPanel Data Limitation: For panel-observed data (pt_panel_* tests), the ‚ÄúObserved‚Äù cumulative incidence curves may differ substantially from ‚ÄúTrue‚Äù model curves. This is expected because:\n\nPanel data only records states at discrete observation times\nBetween observations, the exact transition path is unknown\nThe ‚ÄúObserved‚Äù CI counts direct transitions in the observed data, while ‚ÄúTrue‚Äù CI comes from continuous-time simulated paths\n\nFor example, in illness-death models, a subject going 1‚Üí2‚Üí3 between observations appears as a 1‚Üí3 transition if state 2 was never observed. This is a fundamental limitation of panel-observed data, not a model error.\n\n\n\nTest Overview\n\n\n\n\n\n\n\n\n\n\nTest\nModel Structure\nData Type\nPhases\nStatus\n\n\n\n\npt_exact_nocov\nIllness-death (1‚Üí2‚Üí3, 1‚Üí3)\nExact\n2 per state\n‚úÖ Pass\n\n\npt_exact_fixed\n2-state + covariate\nExact\n2 phases\n‚úÖ Pass\n\n\npt_exact_tvc\n2-state + TVC\nExact\n2 phases\n‚úÖ Pass\n\n\npt_panel_simple\n2-state (1‚Üí2)\nPanel\n2 phases\n‚úÖ Pass\n\n\npt_panel_id\nIllness-death\nPanel\n2 per state\n‚úÖ Pass\n\n\npt_mixed_simple\n2-state\nMixed (exact+panel)\n2 phases\n‚úÖ Pass\n\n\npt_mixed_structured\n2-state\nMixed (structured)\n2 phases\n‚úÖ Pass\n\n\npt_panel_fixed\n2-state + covariate\nPanel\n2 phases\n‚úÖ Pass\n\n\npt_panel_tvc\n2-state + TVC\nPanel\n2 phases\n‚úÖ Pass\n\n\n\n\n\n5.1 pt_exact_nocov\nTests a 3-state illness-death model (1‚Üí2‚Üí3 and 1‚Üí3) with 2 Coxian phases per transient state, using exactly observed transition times. Validates that phase-type rate parameters are recovered when all transition times are known. This is the simplest case with 8 rate parameters.\nTest: pt_exact_nocov | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nrate_1\n0.5\n0.4585\n0.0244\n0.3957\n0.5213\n8.3\n‚úì\n\n\nrate_2\n0.3\n0.3411\n0.0201\n0.2894\n0.3929\n13.7\n‚úì\n\n\nrate_3\n0.4\n0.4101\n0.0221\n0.3533\n0.4669\n2.5\n‚úì\n\n\nrate_4\n0.2\n0.2103\n0.0164\n0.1679\n0.2526\n5.1\n‚úì\n\n\nrate_5\n0.25\n0.2364\n0.0159\n0.1954\n0.2775\n5.4\n‚úì\n\n\nrate_6\n0.35\n0.3614\n0.0222\n0.3042\n0.4187\n3.3\n‚úì\n\n\nrate_7\n0.3\n0.2923\n0.0195\n0.2422\n0.3425\n2.6\n‚úì\n\n\nrate_8\n0.15\n0.1734\n0.014\n0.1372\n0.2096\n15.6\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†37: Cumulative Incidence (Observed State Space)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†38: State Prevalence (Observed State Space)\n\n\n\n\n\n\n\n5.2 pt_exact_fixed\nTests a 2-state model (1‚Üí2) with 2 phases and a time-fixed binary covariate affecting transition rates. Validates that both baseline rates and covariate effects (log hazard ratios) are recovered from exact data.\nTest: pt_exact_fixed | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nbeta_1\n0.0\n0.0204\n0.0872\n-0.2042\n0.245\n2.0\n‚úì\n\n\nbeta_2\n0.4\n0.4337\n0.0994\n0.1775\n0.6899\n8.4\n‚úì\n\n\nbeta_3\n0.3\n0.3241\n0.0793\n0.1198\n0.5284\n8.0\n‚úì\n\n\nrate_1\n0.5\n0.4954\n0.0296\n0.4191\n0.5717\n0.9\n‚úì\n\n\nrate_2\n0.3\n0.314\n0.0243\n0.2515\n0.3765\n4.7\n‚úì\n\n\nrate_3\n0.6\n0.5985\n0.0337\n0.5116\n0.6853\n0.3\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†39: Cumulative Incidence (Observed State Space)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†40: State Prevalence (Observed State Space)\n\n\n\n\n\n\n\n5.3 pt_exact_tvc\nTests a 2-state model with 2 phases and a time-varying covariate that changes at a fixed time point. Validates inference for phase-type models when covariate values change during follow-up.\nTest: pt_exact_tvc | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\nbeta_1\n0.0\n-0.0185\n0.1697\n-0.4556\n0.4186\n1.8\n‚úì\n\n\nbeta_2\n0.5\n0.4548\n0.1779\n-0.0035\n0.913\n9.0\n‚úì\n\n\nbeta_3\n0.4\n0.3191\n0.0984\n0.0657\n0.5726\n20.2\n‚úì\n\n\nrate_1\n0.4\n0.4166\n0.0175\n0.3714\n0.4617\n4.1\n‚úì\n\n\nrate_2\n0.25\n0.2521\n0.0134\n0.2177\n0.2865\n0.8\n‚úì\n\n\nrate_3\n0.5\n0.5574\n0.0239\n0.4959\n0.6189\n11.5\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†41: Cumulative Incidence (Observed State Space)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†42: State Prevalence (Observed State Space)\n\n\n\n\n\n\n\n5.4 pt_panel_simple\nTests a simple 2-state model (1‚Üí2 absorbing) with 2 phases using panel/interval-censored data where states are observed only at discrete times. Validates that panel data likelihood works correctly for phase-type models.\nTest: pt_panel_simple | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\np1\n0.4\n0.4306\n0.0183\n0.3836\n0.4777\n7.7\n‚úì\n\n\np2\n0.2\n0.2156\n0.0135\n0.1809\n0.2503\n7.8\n‚úì\n\n\np3\n0.5\n0.5139\n0.021\n0.4597\n0.5681\n2.8\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†43: Cumulative Incidence (Observed State Space)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†44: State Prevalence (Observed State Space)\n\n\n\n\n\n\n\n5.5 pt_panel_id\nTests a 3-state illness-death model with 2 phases per transient state using panel data. This is the most complex panel test with 8 rate parameters estimated from interval-censored observations.\nTest: pt_panel_id | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\np1\n0.5\n0.5349\n0.0543\n0.3951\n0.6747\n7.0\n‚úì\n\n\np2\n0.3\n0.2941\n0.0445\n0.1795\n0.4086\n2.0\n‚úì\n\n\np3\n0.35\n0.3562\n0.0363\n0.2628\n0.4497\n1.8\n‚úì\n\n\np4\n0.4\n0.3857\n0.0485\n0.2608\n0.5106\n3.6\n‚úì\n\n\np5\n0.25\n0.2829\n0.0396\n0.1809\n0.3848\n13.1\n‚úì\n\n\np6\n0.2\n0.2084\n0.0184\n0.161\n0.2557\n4.2\n‚úì\n\n\np7\n0.3\n0.2905\n0.028\n0.2184\n0.3626\n3.2\n‚úì\n\n\np8\n0.35\n0.3535\n0.0323\n0.2703\n0.4366\n1.0\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†45: Cumulative Incidence (Observed State Space)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†46: State Prevalence (Observed State Space)\n\n\n\n\n\n\n\n5.6 pt_mixed_simple\nTests a 2-state model where some subjects have exact observations and others have panel observations. Validates that the likelihood correctly combines both observation types.\nTest: pt_mixed_simple | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\np1\n0.35\n0.3434\n0.0148\n0.3053\n0.3816\n1.9\n‚úì\n\n\np2\n0.25\n0.2531\n0.0127\n0.2203\n0.286\n1.3\n‚úì\n\n\np3\n0.45\n0.4544\n0.02\n0.4028\n0.506\n1.0\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†47: Cumulative Incidence (Observed State Space)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†48: State Prevalence (Observed State Space)\n\n\n\n\n\n\n\n5.7 pt_mixed_structured\nTests a 2-state model with structured mixed observations where the first half of subjects are observed exactly and the second half have panel data. Validates inference with heterogeneous observation patterns.\nTest: pt_mixed_structured | Passed: ‚úÖ | Time: 0.0s\n\n\n\nParameter\nTrue\nEstimated\nSE\nCI Low\nCI High\nRel Err %\nCovered\n\n\n\n\np1\n0.4\n0.3934\n0.0164\n0.3513\n0.4356\n1.6\n‚úì\n\n\np2\n0.25\n0.2487\n0.0135\n0.2139\n0.2836\n0.5\n‚úì\n\n\np3\n0.5\n0.4894\n0.0213\n0.4345\n0.5444\n2.1\n‚úì\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†49: Cumulative Incidence (Observed State Space)\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure¬†50: State Prevalence (Observed State Space)\n\n\n\n\n\n\n\n5.8 pt_panel_fixed\nTests phase-type with fixed covariates on panel data using the production API with homogeneous covariate constraints. With appropriate identifiability constraints (eigenvalue ordering, homogeneous covariates, SCTP), the identifiable quantities (Œ≤, Œº‚ÇÇ, ŒΩ‚ÇÅ=Œª+Œº‚ÇÅ) are recovered accurately. Note that individual Œª and Œº‚ÇÅ are NOT identifiable from panel data‚Äîonly their sum ŒΩ‚ÇÅ is identified.\n\n\n\n\n\n\nNote\n\n\n\nIdentifiability Note: Individual rates Œª (progression) and Œº‚ÇÅ (exit from phase 1) are NOT separately identifiable from panel data‚Äîonly their sum ŒΩ‚ÇÅ = Œª + Œº‚ÇÅ is identified. Standard errors are computed via the delta method for the identifiable parameterization.\n\n\nTest pt_panel_fixed not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n5.9 pt_panel_tvc\nTests phase-type with time-varying covariates on panel data using the production API with homogeneous covariate constraints. The TVC changes at a fixed time point during follow-up. With appropriate identifiability constraints, the model recovers the identifiable quantities including the treatment effect Œ≤. Higher variance is expected compared to fixed covariate models due to the additional complexity of time-varying effects.\n\n\n\n\n\n\nNote\n\n\n\nIdentifiability Note: Same identifiability constraints as pt_panel_fixed apply. The TVC effect Œ≤ is shared across phases (homogeneous constraint) for identifiability. Higher variance is expected compared to fixed covariate models.\n\n\nTest pt_panel_tvc not yet run. Execute longtest_parametric_suite.jl to populate."
  },
  {
    "objectID": "03_long_tests.html#aft-models",
    "href": "03_long_tests.html#aft-models",
    "title": "Long Tests Status",
    "section": "6. AFT Models",
    "text": "6. AFT Models\nTests in longtest_aft_suite.jl validate accelerated failure time models across exponential, Weibull, and Gompertz hazard families.\n\n6.1 Exponential AFT\n\n\n\nTest\nCovariates\nData Type\nStatus\n\n\n\n\nexp_aft_exact_nocov\nNone\nExact\n‚úÖ Pass\n\n\nexp_aft_exact_tfc\nFixed\nExact\n‚úÖ Pass\n\n\nexp_aft_exact_tvc\nTime-varying\nExact\n‚úÖ Pass\n\n\nexp_aft_panel_nocov\nNone\nPanel\n‚úÖ Pass\n\n\nexp_aft_panel_tfc\nFixed\nPanel\n‚úÖ Pass\n\n\nexp_aft_panel_tvc\nTime-varying\nPanel\n‚úÖ Pass\n\n\n\n\n\n6.2 Weibull AFT\n\n\n\nTest\nCovariates\nData Type\nStatus\n\n\n\n\nwei_aft_exact_nocov\nNone\nExact\n‚úÖ Pass\n\n\nwei_aft_exact_tfc\nFixed\nExact\n‚úÖ Pass\n\n\nwei_aft_exact_tvc\nTime-varying\nExact\n‚úÖ Pass\n\n\nwei_aft_panel_nocov\nNone\nPanel\n‚úÖ Pass\n\n\nwei_aft_panel_tfc\nFixed\nPanel\n‚úÖ Pass\n\n\nwei_aft_panel_tvc\nTime-varying\nPanel\n‚úÖ Pass\n\n\n\n\n\n6.3 Gompertz AFT\n\n\n\nTest\nCovariates\nData Type\nStatus\n\n\n\n\ngom_aft_exact_nocov\nNone\nExact\n‚úÖ Pass\n\n\ngom_aft_exact_tfc\nFixed\nExact\n‚úÖ Pass\n\n\ngom_aft_exact_tvc\nTime-varying\nExact\n‚úÖ Pass\n\n\ngom_aft_panel_nocov\nNone\nPanel\n‚úÖ Pass\n\n\ngom_aft_panel_tfc\nFixed\nPanel\n‚úÖ Pass\n\n\ngom_aft_panel_tvc\nTime-varying\nPanel\n‚úÖ Pass\n\n\n\n\n\n\n\n\n\nNoteAFT Panel Models Use MCEM with PhaseType Proposal\n\n\n\nAFT panel models are fitted via MCEM. The PhaseType proposal must scale rates by exp(-Œ≤'x) (not exp(Œ≤'x) as in PH models). This was fixed in v0.3.0+."
  },
  {
    "objectID": "03_long_tests.html#penalized-spline-models",
    "href": "03_long_tests.html#penalized-spline-models",
    "title": "Long Tests Status",
    "section": "7. Penalized Spline Models",
    "text": "7. Penalized Spline Models\n\n7.1 Smooth Covariate Effects (s(x))\n\n\n\nTest\nTrue Function\nStatus\n\n\n\n\nSinusoidal\nf(x) = sin(2œÄx)\n‚úÖ Pass\n\n\nQuadratic\nf(x) = x¬≤\n‚úÖ Pass\n\n\nSigmoid\nf(x) = tanh(5(x-0.5))\n‚úÖ Pass\n\n\ns(x) + Linear\nf(x) = sin(2œÄx) + 0.5¬∑trt\n‚úÖ Pass\n\n\n\n\n\n7.2 Tensor Product Smooths (te(x,y))\n\n\n\nTest\nTrue Surface\nStatus\n\n\n\n\nSeparable\ng(x,y) = sin(œÄx)cos(œÄy)\n‚úÖ Pass\n\n\nBilinear\ng(x,y) = (x-0.5)(y-0.5)\n‚úÖ Pass\n\n\nAdditive\ng(x,y) = sin(2œÄx) + 0.5cos(2œÄy)\n‚úÖ Pass\n\n\n\n\n\n7.3 Spline Hazards with Exact Data\nTests in longtest_spline_exact.jl validate spline hazard recovery with exact observation data (obstype=1) using a Weibull DGP.\n\n\n\nTest\nEffect\nCovariates\nStatus\n\n\n\n\nsp_exact_nocov\nPH\nNone\n‚úÖ Pass\n\n\nsp_exact_tfc\nPH\nFixed\n‚úÖ Pass\n\n\nsp_exact_tvc\nPH\nTime-varying\n‚úÖ Pass\n\n\nsp_aft_exact_nocov\nAFT\nNone\n‚úÖ Pass\n\n\nsp_aft_exact_tfc\nAFT\nFixed\n‚úÖ Pass\n\n\nsp_aft_exact_tvc\nAFT\nTime-varying\n‚úÖ Pass\n\n\n\n\n\n7.4 MCEM with Spline Hazards\n\n\n\nTest\nApproximates\nStatus\n\n\n\n\nLinear spline\nExponential (constant) hazard\n‚úÖ Pass\n\n\nPiecewise spline\nStep function hazard\n‚úÖ Pass\n\n\nCubic spline\nGompertz (exponential increase)\n‚úÖ Pass"
  },
  {
    "objectID": "03_long_tests.html#unpenalized-spline-suite",
    "href": "03_long_tests.html#unpenalized-spline-suite",
    "title": "Long Tests Status",
    "section": "8. Unpenalized Spline Suite",
    "text": "8. Unpenalized Spline Suite\nTests in longtest_spline_suite.jl comprehensively validate unpenalized spline hazard inference. The test matrix covers: (exact √ó panel) √ó (PH √ó AFT) √ó (Markov √ó PhaseType surrogate) √ó (nocov √ó fixed √ó tvc).\nValidation Strategy: Generate data from spline models with known B-spline coefficients, then fit the same spline model to directly compare estimated coefficients to true values.\nSpline Configuration: degree=3 (cubic), 2 interior knots, boundary=[0.0, 15.0], no penalization.\n\n8.1 Exact Data Tests (6 tests)\n\n\n\nTest\nEffect\nCovariates\nStatus\n\n\n\n\nsp_ph_exact_nocov\nPH\nNone\n‚è≥ Not Run\n\n\nsp_ph_exact_fixed\nPH\nFixed\n‚è≥ Not Run\n\n\nsp_ph_exact_tvc\nPH\nTime-varying\n‚è≥ Not Run\n\n\nsp_aft_exact_nocov\nAFT\nNone\n‚è≥ Not Run\n\n\nsp_aft_exact_fixed\nAFT\nFixed\n‚è≥ Not Run\n\n\nsp_aft_exact_tvc\nAFT\nTime-varying\n‚è≥ Not Run\n\n\n\n\n8.1.1 sp_ph_exact_nocov\nSpline PH hazard, exact data, no covariates. Tests direct coefficient recovery.\nTest sp_ph_exact_nocov not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.1.2 sp_ph_exact_fixed\nSpline PH hazard, exact data, time-fixed covariate.\nTest sp_ph_exact_fixed not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.1.3 sp_ph_exact_tvc\nSpline PH hazard, exact data, time-varying covariate.\nTest sp_ph_exact_tvc not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.1.4 sp_aft_exact_nocov\nSpline AFT hazard, exact data, no covariates.\nTest sp_aft_exact_nocov not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.1.5 sp_aft_exact_fixed\nSpline AFT hazard, exact data, time-fixed covariate.\nTest sp_aft_exact_fixed not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.1.6 sp_aft_exact_tvc\nSpline AFT hazard, exact data, time-varying covariate.\nTest sp_aft_exact_tvc not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n\n8.2 Panel Data Tests - Markov Surrogate (6 tests)\nTests with panel data using MCEM with Markov surrogate.\n\n\n\nTest\nEffect\nCovariates\nStatus\n\n\n\n\nsp_ph_panel_markov_nocov\nPH\nNone\n‚è≥ Not Run\n\n\nsp_ph_panel_markov_fixed\nPH\nFixed\n‚è≥ Not Run\n\n\nsp_ph_panel_markov_tvc\nPH\nTime-varying\n‚è≥ Not Run\n\n\nsp_aft_panel_markov_nocov\nAFT\nNone\n‚è≥ Not Run\n\n\nsp_aft_panel_markov_fixed\nAFT\nFixed\n‚è≥ Not Run\n\n\nsp_aft_panel_markov_tvc\nAFT\nTime-varying\n‚è≥ Not Run\n\n\n\n\n8.2.1 sp_ph_panel_markov_nocov\nSpline PH, panel data, Markov surrogate, no covariates.\nTest sp_ph_panel_markov_nocov not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.2.2 sp_ph_panel_markov_fixed\nSpline PH, panel data, Markov surrogate, time-fixed covariate.\nTest sp_ph_panel_markov_fixed not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.2.3 sp_ph_panel_markov_tvc\nSpline PH, panel data, Markov surrogate, time-varying covariate.\nTest sp_ph_panel_markov_tvc not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.2.4 sp_aft_panel_markov_nocov\nSpline AFT, panel data, Markov surrogate, no covariates.\nTest sp_aft_panel_markov_nocov not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.2.5 sp_aft_panel_markov_fixed\nSpline AFT, panel data, Markov surrogate, time-fixed covariate.\nTest sp_aft_panel_markov_fixed not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.2.6 sp_aft_panel_markov_tvc\nSpline AFT, panel data, Markov surrogate, time-varying covariate.\nTest sp_aft_panel_markov_tvc not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n\n8.3 Panel Data Tests - PhaseType Surrogate (6 tests)\nTests with panel data using MCEM with PhaseType surrogate.\n\n\n\nTest\nEffect\nCovariates\nStatus\n\n\n\n\nsp_ph_panel_phasetype_nocov\nPH\nNone\n‚è≥ Not Run\n\n\nsp_ph_panel_phasetype_fixed\nPH\nFixed\n‚è≥ Not Run\n\n\nsp_ph_panel_phasetype_tvc\nPH\nTime-varying\n‚è≥ Not Run\n\n\nsp_aft_panel_phasetype_nocov\nAFT\nNone\n‚è≥ Not Run\n\n\nsp_aft_panel_phasetype_fixed\nAFT\nFixed\n‚è≥ Not Run\n\n\nsp_aft_panel_phasetype_tvc\nAFT\nTime-varying\n‚è≥ Not Run\n\n\n\n\n8.3.1 sp_ph_panel_phasetype_nocov\nSpline PH, panel data, PhaseType surrogate, no covariates.\nTest sp_ph_panel_phasetype_nocov not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.3.2 sp_ph_panel_phasetype_fixed\nSpline PH, panel data, PhaseType surrogate, time-fixed covariate.\nTest sp_ph_panel_phasetype_fixed not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.3.3 sp_ph_panel_phasetype_tvc\nSpline PH, panel data, PhaseType surrogate, time-varying covariate.\nTest sp_ph_panel_phasetype_tvc not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.3.4 sp_aft_panel_phasetype_nocov\nSpline AFT, panel data, PhaseType surrogate, no covariates.\nTest sp_aft_panel_phasetype_nocov not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.3.5 sp_aft_panel_phasetype_fixed\nSpline AFT, panel data, PhaseType surrogate, time-fixed covariate.\nTest sp_aft_panel_phasetype_fixed not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n8.3.6 sp_aft_panel_phasetype_tvc\nSpline AFT, panel data, PhaseType surrogate, time-varying covariate.\nTest sp_aft_panel_phasetype_tvc not yet run. Execute longtest_parametric_suite.jl to populate.\n\n\n\n\n\n\nNoteSurrogate Comparison\n\n\n\nBoth Markov and PhaseType surrogates should produce similar estimates. For each test case, we verify that estimates from both surrogates are within 35% relative tolerance of each other (20% for Œ≤ parameters)."
  },
  {
    "objectID": "03_long_tests.html#notes",
    "href": "03_long_tests.html#notes",
    "title": "Long Tests Status",
    "section": "9. Notes",
    "text": "9. Notes\n\nModel: 3-state progressive: State 1 ‚Üí State 2 ‚Üí State 3\nTolerance: 35% relative error for main parameters\nTVC: Time-varying covariate effects change at t=5\nExact data: obstype=1 (continuous observation)\nPanel data: Discrete observation times with MCEM"
  },
  {
    "objectID": "index.html#coverage-summary",
    "href": "index.html#coverage-summary",
    "title": "Unit Test Coverage",
    "section": "1. Coverage Summary",
    "text": "1. Coverage Summary\n\nOverall Statistics (as of January 23, 2026)\n\n\n\nMetric\nValue\n\n\n\n\nTotal Test Files\n26\n\n\nTotal Test Cases\n~2831\n\n\nPassing\n~2831\n\n\nFailing\n0\n\n\nBranch\npenalized_splines\n\n\nRuntime\n~8.5 minutes\n\n\n\n\n\nCoverage by Functional Area\n\n\n\n\n\n\n\n\nArea\nTest Files\nDescription\n\n\n\n\nHazard Evaluation\ntest_hazards.jl, test_compute_hazard.jl\nHazard functions, cumulative hazards, survival\n\n\nSpline Infrastructure\ntest_splines.jl, test_penalty_infrastructure.jl\nB-spline basis, penalization\n\n\nSimulation\ntest_simulation.jl\nPath simulation, distribution fidelity\n\n\nMCEM Algorithm\ntest_mcem.jl\nMonte Carlo EM helper functions\n\n\nPhase-Type\ntest_phasetype.jl\nState expansion, FFBS, emission matrices, Coxian math\n\n\nSurrogates\ntest_surrogates.jl\nMarkov and phase-type surrogate fitting\n\n\nSIR Resampling\ntest_sir.jl\nMultinomial and LHS resampling\n\n\nVariance Estimation\ntest_variance.jl\nModel, IJ, jackknife variance\n\n\nWeights\ntest_subject_weights.jl\nSubject and observation weights\n\n\nPIJCV\ntest_pijcv.jl\nSmoothing parameter selection\n\n\nLikelihood\ntest_loglik_analytical.jl\nExact, panel, penalized likelihoods\n\n\nModel Construction\ntest_hazard_macro.jl, test_initialization.jl\nModel building, parameter init\n\n\nInfrastructure\ntest_bounds.jl, test_constraints.jl, test_ad_backends.jl\nParameter bounds, optimization, AD compatibility"
  },
  {
    "objectID": "index.html#hazard-functions-test_hazards.jl",
    "href": "index.html#hazard-functions-test_hazards.jl",
    "title": "Unit Test Coverage",
    "section": "2. Hazard Functions (test_hazards.jl)",
    "text": "2. Hazard Functions (test_hazards.jl)\nTests verify that all parametric hazard families return mathematically correct values against analytical formulas.\n\n2.1 Mathematical Reference\n\n\n\n\n\n\nNoteAnalytical Hazard Formulas (Click to expand)\n\n\n\n\n\nExponential:\n\n\\(h(t) = \\lambda\\) (constant hazard)\n\\(H(t) = \\lambda t\\) (cumulative hazard)\n\\(S(t) = \\exp(-\\lambda t)\\) (survival function)\n\nWeibull (shape \\(\\kappa\\), scale \\(\\lambda\\)):\n\n\\(h(t) = \\lambda \\kappa t^{\\kappa-1}\\) (increasing/decreasing with \\(t\\))\n\\(H(t) = \\lambda t^\\kappa\\)\n\\(S(t) = \\exp(-\\lambda t^\\kappa)\\)\n\nGompertz (shape \\(a\\), rate \\(b\\)) - flexsurv parameterization:\n\n\\(h(t) = b \\exp(at)\\) (\\(a&gt;0\\): increasing, \\(a&lt;0\\): decreasing)\n\\(H(t) = \\frac{b}{a}(\\exp(at) - 1)\\) for \\(a \\neq 0\\)\n\\(S(t) = \\exp\\left(-\\frac{b}{a}(\\exp(at) - 1)\\right)\\)\n\nCovariate Effects:\n\nProportional Hazards (PH): \\(h(t|x) = h_0(t) \\exp(\\beta'x)\\)\nAccelerated Failure Time (AFT): \\(h(t|x) = h_0(t \\cdot e^{-\\beta'x}) e^{-\\beta'x}\\)\n\n\n\n\n\n\n2.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Test Criteria (Click to expand)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTest\nCriterion\nFormula Verified\nTolerance\n\n\n\n\nSurvival probability\n\\(1 - S(0,t) = F(t)\\) matches Distributions.Exponential\nTotal hazard rate = 0.2, \\(F(2) = 1 - e^{-0.4}\\)\nrtol=1e-6\n\n\nExponential baseline\n\\(h(t) = \\lambda\\) constant in \\(t\\)\neval_hazard = rate parameter\nrtol=1e-6\n\n\nExponential with covariates\n\\(\\log h = \\log\\lambda + \\beta_1 x_1 + \\beta_2 x_2 + \\beta_{12} x_1 x_2\\)\nFull linear predictor formula\nExact match\n\n\nWeibull baseline\n\\(\\log h = \\log\\lambda + \\log\\kappa + (\\kappa-1)\\log t\\)\nLog-hazard at \\(t=1.7\\)\nrtol=1e-6\n\n\nWeibull with covariates\nPH and AFT covariate effects\nShape and scale adjustments\nrtol=1e-6\n\n\nGompertz baseline\n\\(h(t) = b\\exp(at)\\)\nRate exponentially increasing in \\(t\\)\nrtol=1e-6\n\n\nGompertz cumhaz\n\\(H(t) = (b/a)(\\exp(at)-1)\\)\nAnalytical integration\nrtol=1e-6\n\n\nTime transform parity\neval_hazard(apply_transform=true) = eval_hazard(apply_transform=false)\nTang optimization produces identical values\nExact match\n\n\nCumulative hazard additivity\n\\(H(a,c) = H(a,b) + H(b,c)\\)\nInterval splitting\nrtol=1e-8\n\n\n\nTolerance Justification: rtol=1e-6 accounts for ParameterHandling.positive() using \\(\\varepsilon \\approx 1.49 \\times 10^{-8}\\) safety margin in exp/log round-trips.\n\n\n\n\n\n2.3 Summary Table\n\n\n\nFamily\nBaseline\nCovariates\nAFT\nTime Transform\nStatus\n\n\n\n\nExponential\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass\n\n\nWeibull\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass\n\n\nGompertz\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass\n\n\nSpline\n‚úÖ\n‚úÖ\n‚úÖ\n‚úÖ\nPass"
  },
  {
    "objectID": "index.html#spline-hazards-test_splines.jl",
    "href": "index.html#spline-hazards-test_splines.jl",
    "title": "Unit Test Coverage",
    "section": "3. Spline Hazards (test_splines.jl)",
    "text": "3. Spline Hazards (test_splines.jl)\nTests verify B-spline basis construction, numerical integration accuracy, and penalization infrastructure.\n\n3.1 Mathematical Reference\n\n\n\n\n\n\nNoteSpline Mathematical Background (Click to expand)\n\n\n\n\n\nB-Spline Hazard:\n\n\\(h(t) = \\sum_i \\beta_i B_i(t)\\) where \\(B_i\\) are B-spline basis functions\nCoefficients \\(\\beta_i &gt; 0\\) ensure non-negative hazard\n\nCumulative Hazard:\n\n\\(H(a,b) = \\int_a^b h(t) dt = \\sum_i \\beta_i \\int_a^b B_i(t) dt\\)\nUses analytical B-spline antiderivative (not numerical quadrature)\n\nSecond-Order Penalty Matrix:\n\n\\(\\mathbf{P} = \\int \\mathbf{B}''(t) \\mathbf{B}''(t)' dt\\)\nPenalizes deviation from linearity (Wood, 2017)\nMust be symmetric, positive semi-definite with \\(\\text{rank} = k - m\\) where \\(m\\) = penalty order\n\nTensor Product (te()):\n\n\\(f(x,y) = \\sum_i \\sum_j \\beta_{ij} B_i^{(x)}(x) B_j^{(y)}(y)\\)\nBasis: Kronecker product \\(\\mathbf{B}^{(x)} \\otimes \\mathbf{B}^{(y)}\\)\nPenalty: Row + column penalties on coefficient matrix\n\n\n\n\n\n\n3.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Spline Test Criteria (Click to expand)\n\n\n\n\n\nNumerical Integration Verification:\n\n\n\n\n\n\n\n\nTest\nCriterion\nMethod\n\n\n\n\nCumhaz vs QuadGK\n\\(H(a,b)_\\text{impl} \\approx \\int_a^b h(t)dt\\)\nQuadGK adaptive quadrature, 5 random parameter configs, 5 intervals each\n\n\nB-spline antiderivative\nBSplineKit integral() matches QuadGK\nrtol=1e-10 (machine precision for polynomials)\n\n\nCovariate effect\n\\(H(a,b|x) = H_0(a,b) \\exp(\\beta'x)\\) for PH\nMultiple covariate values\n\n\n\nPenalty Matrix Properties:\n\n\n\n\n\n\n\nProperty\nCriterion\n\n\n\n\nSymmetry\n\\(\\mathbf{P} = \\mathbf{P}'\\) exactly\n\n\nPositive semi-definiteness\nAll eigenvalues \\(\\geq 0\\)\n\n\nNull space dimension\n\\(\\text{dim}(\\text{null}(\\mathbf{P})) = m\\) (penalty order)\n\n\nNull space basis\nContains polynomials of degree \\(&lt; m\\)\n\n\n\nSmooth Term Parsing:\n\n\n\nTest\nInput\nExpected Output\n\n\n\n\nBasic s(x)\n@formula(0 ~ s(x))\nSmoothTerm with default k=10\n\n\nCustom k\n@formula(0 ~ s(x, k=15))\nSmoothTerm with k=15\n\n\nCustom m\n@formula(0 ~ s(x, m=1))\nFirst-order penalty (ridge)\n\n\nTensor product\n@formula(0 ~ te(x,y))\nTensorProductTerm\n\n\n\nAutomatic Knot Placement:\n\n\n\nTest\nCriterion\n\n\n\n\nInterior knots\nPlaced at quantiles of transition times\n\n\nBoundary knots\nSpan observed time range\n\n\nEdge case handling\nk &gt; n_unique_times handled gracefully\n\n\n\n\n\n\n\n\n3.3 Summary Table\n\n\n\n\n\n\n\n\n\nComponent\nTests\nTolerance\nStatus\n\n\n\n\nCumhaz vs numerical integration\n25 random configs\nrtol=1e-6\n‚úÖ Pass\n\n\nB-spline antiderivative\n6 test cases\nrtol=1e-10\n‚úÖ Pass\n\n\nPenalty matrix symmetry\nExact equality\nExact\n‚úÖ Pass\n\n\nPenalty matrix eigenvalues\nAll ‚â• 0\natol=1e-10\n‚úÖ Pass\n\n\nPenalty null space\nDimension = m\nExact count\n‚úÖ Pass\n\n\ns() term parsing\n10+ variants\nN/A\n‚úÖ Pass\n\n\nte() tensor product\nKronecker construction\nExact\n‚úÖ Pass\n\n\nAutomatic knot placement\nQuantile-based\nN/A\n‚úÖ Pass\n\n\nMonotone rectification\nCoefficients non-decreasing\nN/A\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#simulation-test_simulation.jl",
    "href": "index.html#simulation-test_simulation.jl",
    "title": "Unit Test Coverage",
    "section": "4. Simulation (test_simulation.jl)",
    "text": "4. Simulation (test_simulation.jl)\nTests verify simulation produces statistically correct output with correct schema.\n\n4.1 Mathematical Reference\n\n\n\n\n\n\nNoteSimulation Statistical Properties (Click to expand)\n\n\n\n\n\nExponential Distribution (\\(\\text{Exp}(\\lambda)\\)):\n\nMean: \\(E[T] = 1/\\lambda\\)\nVariance: \\(\\text{Var}(T) = 1/\\lambda^2\\)\nStandard error of sample mean: \\(\\text{SE}(\\bar{T}) = 1/(\\lambda\\sqrt{n})\\)\n\nStatistical Tests Applied:\n\nSample mean within 10% of true mean (relative tolerance)\nSample variance within 15% of true variance\nSample mean within 3 standard errors of true mean (statistical validity)\n\n\n\n\n\n\n4.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Simulation Test Criteria (Click to expand)\n\n\n\n\n\nDistribution Correctness (n=500 simulations):\n\n\n\n\n\n\n\n\nTest\nCriterion\nParameters\n\n\n\n\nMean\n\\(\\|\\bar{T} - 1/\\lambda\\| / (1/\\lambda) &lt; 0.10\\)\n\\(\\lambda=0.5\\), true mean = 2.0\n\n\nVariance\n\\(\\|s^2 - 1/\\lambda^2\\| / (1/\\lambda^2) &lt; 0.15\\)\ntrue var = 4.0\n\n\nStandard error\n\\(\\|\\bar{T} - 2.0\\| &lt; 3 \\times \\text{SE}\\)\n\\(\\text{SE} \\approx 0.0894\\)\n\n\n\nDataFrame Schema:\n\n\n\nColumn\nRequired Type\nConstraint\n\n\n\n\nid\nInt\nSubject identifier\n\n\ntstart\nFloat64\nInterval start\n\n\ntstop\nFloat64\nInterval end, tstop &gt; tstart\n\n\nstatefrom\nInt\nOrigin state\n\n\nstateto\nInt\nDestination state\n\n\nobstype\nInt\nObservation type\n\n\n\nPath Validity:\n\n\n\nTest\nCriterion\n\n\n\n\nMonotonic times\ntimes[i+1] &gt; times[i] for all \\(i\\)\n\n\nLegal transitions\ntmat[from, to] &gt; 0 when state changes\n\n\nInitial state\nMatches statefrom in data\n\n\nAbsorbing states\nNo transitions out of absorbing states\n\n\n\nTransform Strategy Equivalence:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nCachedTransformStrategy vs DirectTransformStrategy\nIdentical distribution (same RNG seed)\n\n\n\n\n\n\n\n\n4.3 Summary Table\n\n\n\nTest Category\nTests\nStatus\n\n\n\n\nMean correctness\n1\n‚úÖ Pass\n\n\nVariance correctness\n1\n‚úÖ Pass\n\n\nSchema validation\n3 simulations √ó 6 columns\n‚úÖ Pass\n\n\nMonotonic times\n50 paths\n‚úÖ Pass\n\n\nLegal transitions\n50 paths\n‚úÖ Pass\n\n\nInitial state\n20 paths\n‚úÖ Pass\n\n\nTransform strategy parity\nSame RNG\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#mcem-algorithm-test_mcem.jl",
    "href": "index.html#mcem-algorithm-test_mcem.jl",
    "title": "Unit Test Coverage",
    "section": "5. MCEM Algorithm (test_mcem.jl)",
    "text": "5. MCEM Algorithm (test_mcem.jl)\nTests verify Monte Carlo EM helper functions.\n\n5.1 Mathematical Reference\n\n\n\n\n\n\nNoteMCEM Mathematical Background (Click to expand)\n\n\n\n\n\nMCEM Marginal Log-Likelihood:\n\\[Q(\\theta) = \\sum_{i=1}^n w_i \\sum_{j=1}^{m_i} p_{ij} \\ell(\\theta; y_i, z_{ij})\\]\nwhere \\(w_i\\) = subject weight, \\(p_{ij}\\) = importance weight for path \\(j\\) of subject \\(i\\).\nMCEM Asymptotic Standard Error:\n\\[\\text{ASE} = \\sqrt{\\sum_{i=1}^n w_i^2 \\cdot \\text{Var}_{p_i}[\\ell(\\theta; y_i, z_i) - \\ell(\\theta_0; y_i, z_i)]}\\]\n\n\n\n\n\n5.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed MCEM Test Criteria (Click to expand)\n\n\n\n\n\nForwardDiff Gradient Compatibility:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nExactData gradient\nForwardDiff.gradient() produces finite values\n\n\nSMPanelData gradient\nForwardDiff.gradient() produces finite values\n\n\nGradient length\nMatches parameter count\n\n\n\nMCEM Helper Functions:\n\n\n\nFunction\nTest\nExpected Value\n\n\n\n\nmcem_mll\nUnit weights\nSum of weighted log-liks\n\n\nmcem_mll\nNon-unit weights\nSubject-weighted sum\n\n\nmcem_ase\nIdentical logliks\n0.0 (no variance)\n\n\nvar_ris\nAll zeros\n0.0\n\n\n\nMCEM Monotonicity (Limited Iterations):\n\n\n\nTest\nCriterion\n\n\n\n\nQ-function increase\nFinal MLL not substantially worse than initial\n\n\nMC noise allowance\nAllow 10% relative decrease\n\n\n\n\n\n\n\n\n5.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nAD gradient compatibility\n2 data types\n‚úÖ Pass\n\n\nmcem_mll correctness\n2 weight configs\n‚úÖ Pass\n\n\nmcem_ase correctness\n1 edge case\n‚úÖ Pass\n\n\nMCEM monotonicity\n3 iterations\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#sir-resampling-test_sir.jl",
    "href": "index.html#sir-resampling-test_sir.jl",
    "title": "Unit Test Coverage",
    "section": "6. SIR Resampling (test_sir.jl)",
    "text": "6. SIR Resampling (test_sir.jl)\nTests verify Sampling Importance Resampling functions for MCEM.\n\n6.1 Mathematical Reference\n\n\n\n\n\n\nNoteSIR Mathematical Background (Click to expand)\n\n\n\n\n\nPool Size Formula:\n\\[m_\\text{pool} = \\min(c \\cdot m \\cdot \\log(m), m_\\text{max})\\]\nwhere \\(c\\) = constant (default 2), \\(m\\) = target ESS.\nMultinomial Resampling:\n\nSample indices with replacement proportional to weights\nExpected count for index \\(i\\): \\(E[n_i] = m \\cdot w_i\\)\n\nLatin Hypercube Sampling (LHS):\n\nStratified sampling with one sample per stratum\nReduces variance compared to multinomial for smooth functions\n\n\n\n\n\n\n6.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed SIR Test Criteria (Click to expand)\n\n\n\n\n\nPool Size Computation:\n\n\n\nTest\nInput\nExpected\n\n\n\n\nBasic\nESS=50, c=2.0\n\\(\\lceil 2 \\cdot 50 \\cdot \\log(50) \\rceil\\)\n\n\nCap\nESS=1000, max=500\n500\n\n\nLarge ESS\nESS=1000, max=8192\n8192 (capped)\n\n\nEdge case\nESS=1\n1 (log(1)=0 handled)\n\n\n\nMultinomial Resampling:\n\n\n\nTest\nCriterion\n\n\n\n\nOutput length\nEquals requested count\n\n\nIndex range\nAll indices in [1, n_weights]\n\n\nProportionality\nHigher weights selected more often\n\n\nDeterminism\nSame RNG seed ‚Üí same result\n\n\nUniform weights\nApproximately equal counts\n\n\n\nLHS Resampling:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nOutput length\nEquals requested count\n\n\nIndex range\nAll indices in [1, n_weights]\n\n\nVariance reduction\n\\(\\text{Var}(\\bar{X}_\\text{LHS}) \\leq 1.5 \\cdot \\text{Var}(\\bar{X}_\\text{SIR})\\)\n\n\n\nMLL Computation:\n\n\n\n\n\n\n\n\nFunction\nTest\nExpected\n\n\n\n\nmcem_mll_sir\nUniform indices\nMean of selected log-liks\n\n\nmcem_mll_sir\nSubject weights\nWeighted sum\n\n\nmcem_ase_sir\nKnown differences\n\\(\\sqrt{\\sum_i \\text{Var}_i / m_i}\\)\n\n\n\n\n\n\n\n\n6.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nPool size formula\n5 cases\n‚úÖ Pass\n\n\nMultinomial resampling\n5 properties\n‚úÖ Pass\n\n\nLHS resampling\n3 properties\n‚úÖ Pass\n\n\nLHS variance reduction\n200 reps comparison\n‚úÖ Pass\n\n\nMLL with SIR\n2 weight configs\n‚úÖ Pass\n\n\nASE with SIR\nKnown variances\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#variance-estimation-test_variance.jl",
    "href": "index.html#variance-estimation-test_variance.jl",
    "title": "Unit Test Coverage",
    "section": "7. Variance Estimation (test_variance.jl)",
    "text": "7. Variance Estimation (test_variance.jl)\nTests verify variance-covariance matrix computation matches analytical formulas.\n\n7.1 Mathematical Reference\n\n\n\n\n\n\nNoteVariance Estimation Mathematical Background (Click to expand)\n\n\n\n\n\nExponential MLE Fisher Information:\n\nObserved information: \\(I(\\hat\\lambda) = n/\\hat\\lambda^2\\)\nMLE variance: \\(\\text{Var}(\\hat\\lambda) = \\hat\\lambda^2/n\\)\nMLE formula: \\(\\hat\\lambda = n / \\sum_i t_i\\)\n\nInfinitesimal Jackknife (IJ):\n\\[\\text{Var}_\\text{IJ} = \\left(\\frac{\\partial^2 \\ell}{\\partial \\theta^2}\\right)^{-1} \\left(\\sum_i \\frac{\\partial \\ell_i}{\\partial \\theta} \\frac{\\partial \\ell_i}{\\partial \\theta}'\\right) \\left(\\frac{\\partial^2 \\ell}{\\partial \\theta^2}\\right)^{-1}\\]\nJK-IJ Relationship:\n\\[\\text{Var}_\\text{JK} = \\frac{n-1}{n} \\text{Var}_\\text{IJ}\\]\n\n\n\n\n\n7.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Variance Test Criteria (Click to expand)\n\n\n\n\n\nAnalytical Verification (Exponential, n=100):\n\n\n\nTest\nCriterion\nExpected\n\n\n\n\nMLE formula\n\\(\\hat\\lambda = n/\\sum t_i\\)\nrtol=0.001\n\n\nVariance formula\n\\(\\hat\\sigma^2 = \\hat\\lambda^2/n\\)\nrtol=0.01\n\n\nAsymptotic variance\n\\(\\approx \\lambda^2/n = 0.0025\\)\nrtol=0.5\n\n\n\nVariance Matrix Properties:\n\n\n\nProperty\nCriterion\n\n\n\n\nSymmetry\n\\(\\mathbf{V} = \\mathbf{V}'\\) exactly\n\n\nPositive definiteness\nAll eigenvalues &gt; 0\n\n\nEigenvalue sum\n\\(\\sum \\lambda_i = \\text{tr}(\\mathbf{V})\\)\n\n\nDimensions\n\\(p \\times p\\) where \\(p\\) = parameter count\n\n\n\nAPI Functionality:\n\n\n\nTest\nCriterion\n\n\n\n\nget_vcov(type=:model)\nReturns model-based variance\n\n\nget_vcov(type=:ij)\nReturns IJ variance\n\n\nget_vcov(type=:jk)\nReturns jackknife variance\n\n\nUnfitted model\nWarns, returns nothing\n\n\n\n\n\n\n\n\n7.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nMLE analytical match\n1 test\n‚úÖ Pass\n\n\nVariance analytical match\n1 test\n‚úÖ Pass\n\n\nSymmetry\n2 families\n‚úÖ Pass\n\n\nPositive definiteness\n2 families\n‚úÖ Pass\n\n\nEigenvalue checksum\n2 families\n‚úÖ Pass\n\n\nAPI type selection\n3 types\n‚úÖ Pass\n\n\nWarning for missing vcov\n1 test\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#pijcv-smoothing-selection-test_pijcv.jl",
    "href": "index.html#pijcv-smoothing-selection-test_pijcv.jl",
    "title": "Unit Test Coverage",
    "section": "8. PIJCV Smoothing Selection (test_pijcv.jl)",
    "text": "8. PIJCV Smoothing Selection (test_pijcv.jl)\nTests verify Predictive Infinitesimal Jackknife Cross-Validation implementation based on Wood (2024).\n\n8.1 Mathematical Reference\n\n\n\n\n\n\nNotePIJCV Mathematical Background (Click to expand)\n\n\n\n\n\nCholesky Downdate:\nGiven \\(\\mathbf{H} = \\mathbf{L}\\mathbf{L}'\\) and vector \\(v\\), compute \\(\\mathbf{L}_{-}\\) such that: \\[\\mathbf{L}_{-}\\mathbf{L}_{-}' = \\mathbf{H} - vv'\\]\nLOO Newton Step:\n\\[\\hat\\theta_{-i} \\approx \\hat\\theta - (\\mathbf{H} - \\mathbf{H}_i)^{-1} g_i\\]\nwhere \\(\\mathbf{H}_i\\) = subject \\(i\\)‚Äôs Hessian contribution, \\(g_i\\) = gradient contribution.\nPIJCV Criterion (Wood 2024):\n\\[\\text{PIJCV}(\\lambda) = \\sum_{i=1}^n \\ell_i(\\hat\\theta_{-i}(\\lambda))\\]\nMinimizing PIJCV selects optimal \\(\\lambda\\).\n\n\n\n\n\n8.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed PIJCV Test Criteria (Click to expand)\n\n\n\n\n\nCholesky Downdate:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nCorrectness\n\\(\\mathbf{L}_{-}\\mathbf{L}_{-}' = \\mathbf{H} - vv'\\)\n\n\nPD preservation\nAll eigenvalues &gt; 0 after downdate\n\n\nIndefiniteness detection\nReturns false when \\(\\mathbf{H} - vv'\\) not PD\n\n\nNon-mutating copy\nOriginal \\(\\mathbf{L}\\) unchanged\n\n\nSequential downdates\nAccumulate correctly\n\n\n\nLOO Newton Step:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nDirect vs Cholesky\nResults match to rtol=1e-8\n\n\nSubject removal\n\\((\\mathbf{H} - \\mathbf{H}_i)^{-1}\\) computed correctly\n\n\n\nPIJCV Criterion:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nPerturbations\nMatch direct LOO computation\n\n\nObjective value\nCorrect sum of LOO likelihoods\n\n\nEnd-to-end API\nselect_smoothing_parameters returns valid \\(\\lambda\\)\n\n\n\n\n\n\n\n\n8.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nCholesky downdate correctness\n1 test\n‚úÖ Pass\n\n\nPD preservation\n1 test\n‚úÖ Pass\n\n\nIndefiniteness detection\n1 test\n‚úÖ Pass\n\n\nNon-mutating copy\n1 test\n‚úÖ Pass\n\n\nSequential downdates\n1 test\n‚úÖ Pass\n\n\nLOO Newton step\n2 methods compared\n‚úÖ Pass\n\n\nPIJCV criterion\n1 test\n‚úÖ Pass\n\n\nEnd-to-end API\n1 test\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#phase-type-models-test_phasetype.jl",
    "href": "index.html#phase-type-models-test_phasetype.jl",
    "title": "Unit Test Coverage",
    "section": "9. Phase-Type Models (test_phasetype.jl)",
    "text": "9. Phase-Type Models (test_phasetype.jl)\nTests verify phase-type distribution implementation against analytical formulas.\n\n9.1 Mathematical Reference\n\n\n\n\n\n\nNotePhase-Type Mathematical Background (Click to expand)\n\n\n\n\n\n\\(p\\)-Phase Coxian Distribution:\nSub-intensity matrix \\(\\mathbf{S}\\), absorption rates \\(\\mathbf{a}\\), initial distribution \\(\\boldsymbol{\\pi}\\):\n\nDensity: \\(f(t) = \\boldsymbol{\\pi}' \\exp(\\mathbf{S}t) \\mathbf{a}\\)\nSurvival: \\(S(t) = \\boldsymbol{\\pi}' \\exp(\\mathbf{S}t) \\mathbf{1}\\)\nHazard: \\(h(t) = f(t) / S(t)\\)\nCumulative hazard: \\(H(t) = -\\log S(t)\\)\n\n2-Phase Coxian Analytical Formulas:\nFor \\(\\mathbf{S} = \\begin{pmatrix} -(r+a_1) & r \\\\ 0 & -a_2 \\end{pmatrix}\\), \\(\\boldsymbol{\\pi} = (1, 0)'\\):\n\\[\\exp(\\mathbf{S}t)_{11} = e^{-\\lambda_1 t}, \\quad \\exp(\\mathbf{S}t)_{22} = e^{-\\lambda_2 t}\\] \\[\\exp(\\mathbf{S}t)_{12} = \\frac{r(e^{-\\lambda_1 t} - e^{-\\lambda_2 t})}{\\lambda_2 - \\lambda_1}\\]\nwhere \\(\\lambda_1 = r + a_1\\), \\(\\lambda_2 = a_2\\).\n\n\n\n\n\n9.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Phase-Type Test Criteria (Click to expand)\n\n\n\n\n\nEmission Matrix:\n\n\n\n\n\n\n\nTest\nCriterion\n\n\n\n\nPanel observation (obstype=2)\nAll phases of destination state = 1.0\n\n\nExact transition (obstype=1)\nOnly first phase = 1.0\n\n\nFully censored (obstype=0)\nAll phases = 1.0\n\n\nCustom censoring patterns\nCorrect pattern application\n\n\n\nData Expansion:\n\n\n\nTest\nCriterion\n\n\n\n\nExact transition split\nCreates intermediate ‚Äúremain‚Äù row\n\n\nPanel observation\nNo expansion needed\n\n\nSubject index recomputation\nIndices remain valid\n\n\n\nHazard/Survival Correctness:\n\n\n\nTest\nCriterion\nTolerance\n\n\n\n\n2-phase survival\nMatches analytical formula\nrtol=1e-10\n\n\n2-phase density\nMatches analytical formula\nrtol=1e-10\n\n\n2-phase hazard\n\\(h(t) = f(t)/S(t)\\)\nrtol=1e-10\n\n\nCumulative hazard\n\\(H(t) = -\\log S(t)\\)\nrtol=1e-10\n\n\nLog-likelihood\nAnalytical path likelihood\nrtol=1e-8\n\n\n\nPath Operations:\n\n\n\nTest\nCriterion\n\n\n\n\nExpand path\nObservable states ‚Üí phase states\n\n\nCollapse path\nPhase states ‚Üí observable states\n\n\nRound-trip\nExpand then collapse = original\n\n\n\n\n\n\n\n\n9.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nEmission matrix obstype=1\n1 test\n‚úÖ Pass\n\n\nEmission matrix obstype=2\n1 test\n‚úÖ Pass\n\n\nEmission matrix obstype=0\n1 test\n‚úÖ Pass\n\n\nData expansion\n2 tests\n‚úÖ Pass\n\n\n2-phase survival\n5 time points\n‚úÖ Pass\n\n\n2-phase density\n5 time points\n‚úÖ Pass\n\n\n2-phase hazard\n5 time points\n‚úÖ Pass\n\n\nPath expansion\n1 test\n‚úÖ Pass\n\n\nPath collapse\n1 test\n‚úÖ Pass\n\n\nLog-likelihood\n3 paths\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#likelihood-functions-test_mll_consistency.jl-test_loglik_analytical.jl",
    "href": "index.html#likelihood-functions-test_mll_consistency.jl-test_loglik_analytical.jl",
    "title": "Unit Test Coverage",
    "section": "10. Likelihood Functions (test_mll_consistency.jl, test_loglik_analytical.jl)",
    "text": "10. Likelihood Functions (test_mll_consistency.jl, test_loglik_analytical.jl)\nTests verify likelihood computation consistency across methods.\n\n10.1 Mathematical Reference\n\n\n\n\n\n\nNoteLikelihood Mathematical Background (Click to expand)\n\n\n\n\n\nExact Data Likelihood:\n\\[\\ell(\\theta) = \\sum_i \\left[ \\log h(t_i | x_i) - H(0, t_i | x_i) \\right]\\]\nPanel Data Likelihood (Markov):\n\\[\\ell(\\theta) = \\sum_i \\log \\mathbf{P}(s_i | s_{i-1}, t_i - t_{i-1})\\]\nwhere \\(\\mathbf{P} = \\exp(\\mathbf{Q} \\Delta t)\\) is the transition probability matrix.\nIS-Weighted MLL:\n\\[\\hat\\ell = \\sum_i w_i \\sum_j p_{ij} \\ell_{ij}\\]\n\n\n\n\n\n10.2 Test Criteria\n\n\n\n\n\n\nNoteDetailed Likelihood Test Criteria (Click to expand)\n\n\n\n\n\nMLL Consistency Across Methods:\n\n\n\nMethod Pair\nCriterion\nTolerance\n\n\n\n\nIS-weighted vs SIR\nSample-level agreement\n15% relative\n\n\nIS-weighted vs LHS\nSample-level agreement\n15% relative\n\n\nSIR vs LHS\nSample-level agreement\n15% relative\n\n\nSubject-level correlation\n\\(r &gt; 0.85\\)\nN/A\n\n\nSubject-level MAE\n&lt; 25% relative\nN/A\n\n\n\nAnalytical Likelihood (Exponential):\n\n\n\nTest\nCriterion\n\n\n\n\nFormula\n\\(\\ell = n\\log\\lambda - \\lambda \\sum t_i\\)\n\n\nGradient\nMatches ForwardDiff\n\n\n\n\n\n\n\n\n10.3 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nIS vs SIR agreement\n1 test\n‚úÖ Pass\n\n\nIS vs LHS agreement\n1 test\n‚úÖ Pass\n\n\nSubject-level correlation\n3 pairs\n‚úÖ Pass\n\n\nSubject-level MAE\n2 methods\n‚úÖ Pass\n\n\nAnalytical likelihood\n1 family\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#model-construction-test_modelgeneration.jl-test_initialization.jl",
    "href": "index.html#model-construction-test_modelgeneration.jl-test_initialization.jl",
    "title": "Unit Test Coverage",
    "section": "11. Model Construction (test_modelgeneration.jl, test_initialization.jl)",
    "text": "11. Model Construction (test_modelgeneration.jl, test_initialization.jl)\nTests verify model building and parameter initialization.\n\n11.1 Test Criteria\n\n\n\n\n\n\nNoteDetailed Model Construction Test Criteria (Click to expand)\n\n\n\n\n\nError Detection:\n\n\n\nTest\nInput\nExpected\n\n\n\n\nDuplicate transitions\nTwo hazards 1‚Üí2\nArgumentError\n\n\nState 0 origin\nHazard(..., 0, 1)\nArgumentError\n\n\nState 0 destination\nHazard(..., 1, 0)\nArgumentError\n\n\nSelf-transition\nHazard(..., 1, 1)\nArgumentError\n\n\nInvalid family\nHazard(..., \"invalid\", ...)\nArgumentError\n\n\n\nCensoring Pattern Handling:\n\n\n\nTest\nCriterion\n\n\n\n\nPattern parsing\nRow sums ‚â§ 1\n\n\nobstype &gt; 2\nUses pattern matrix\n\n\nobstype = 0\nAll states possible\n\n\n\nInitialization Methods:\n\n\n\nMethod\nWhen Used\nCriterion\n\n\n\n\n:crude\nMarkov models\nParameters non-NaN\n\n\n:surrogate\nSemi-Markov models\nParameters non-NaN\n\n\n:auto\nDefault\nSelects appropriate method\n\n\n\n\n\n\n\n\n11.2 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nDuplicate transition detection\n1 test\n‚úÖ Pass\n\n\nState 0 detection\n2 tests\n‚úÖ Pass\n\n\nSelf-transition detection\n1 test\n‚úÖ Pass\n\n\nCensoring patterns\n1 test\n‚úÖ Pass\n\n\nCrude initialization\n1 test\n‚úÖ Pass\n\n\nAuto method selection\n1 test\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#reconstructor-test_reconstructor.jl",
    "href": "index.html#reconstructor-test_reconstructor.jl",
    "title": "Unit Test Coverage",
    "section": "12. ReConstructor (test_reconstructor.jl)",
    "text": "12. ReConstructor (test_reconstructor.jl)\nTests verify AD-compatible parameter flattening/unflattening.\n\n12.1 Test Criteria\n\n\n\n\n\n\nNoteDetailed ReConstructor Test Criteria (Click to expand)\n\n\n\n\n\nType Construction:\n\n\n\nInput Type\nFlatten Output\nUnflatten Output\n\n\n\n\nFloat64\n[x]\nx::Float64\n\n\nVector{Float64}\nx (identity)\nx::Vector\n\n\nVector{Int}\n[] (empty)\nOriginal (no flatten)\n\n\nTuple\nConcatenated\nTuple with correct lengths\n\n\nNamedTuple\nConcatenated\nNamedTuple with keys preserved\n\n\n\nAD Compatibility:\n\n\n\nTest\nCriterion\n\n\n\n\nForwardDiff gradient\nThrough unflatten ‚Üí compute ‚Üí flatten\n\n\nType stability\nReturn type matches input type\n\n\nStrict mode\nExact key preservation\n\n\nFlexible mode\nStructural preservation only\n\n\n\nRound-trip:\n\n\n\nTest\nCriterion\n\n\n\n\nunflatten(flatten(x)) == x\nFor all supported types\n\n\nNested structures\nRecursive reconstruction\n\n\n\n\n\n\n\n\n12.2 Summary Table\n\n\n\nComponent\nTests\nStatus\n\n\n\n\nReal number\n2 modes\n‚úÖ Pass\n\n\nFloat vector\n1 test\n‚úÖ Pass\n\n\nInt vector (skip)\n1 test\n‚úÖ Pass\n\n\nTuple\n2 depths\n‚úÖ Pass\n\n\nNamedTuple\n2 depths\n‚úÖ Pass\n\n\nAD compatibility\nForwardDiff\n‚úÖ Pass\n\n\nRound-trip\nAll types\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#additional-tests",
    "href": "index.html#additional-tests",
    "title": "Unit Test Coverage",
    "section": "13. Additional Tests",
    "text": "13. Additional Tests\n\n13.1 AD Backends (test_ad_backends.jl)\n\n\n\nTest\nCriterion\nStatus\n\n\n\n\nType existence\nADBackend types defined\n‚úÖ Pass\n\n\nDefault selection\nParameter count thresholds\n‚úÖ Pass\n\n\nForwardDiff gradient\nFinite, correct length\n‚úÖ Pass\n\n\nfit() integration\nadbackend kwarg works\n‚úÖ Pass\n\n\n\n\n\n13.2 @hazard Macro (test_hazard_macro.jl)\n\n\n\nTest\nCriterion\nStatus\n\n\n\n\nFamily aliases\n:exp, :wei, :gom, :sp, :pt\n‚úÖ Pass\n\n\nTransition syntax\nMultiple formats\n‚úÖ Pass\n\n\nFormula defaults\nIntercept-only\n‚úÖ Pass\n\n\nKeyword forwarding\nknots, n_phases, etc.\n‚úÖ Pass\n\n\nError messages\nMissing/invalid family\n‚úÖ Pass\n\n\n\n\n\n13.3 Model Output (test_model_output.jl)\n\n\n\nTest\nCriterion\nStatus\n\n\n\n\nAIC formula\n\\(-2\\ell + 2k\\)\n‚úÖ Pass\n\n\nBIC formula\n\\(-2\\ell + k\\log n\\)\n‚úÖ Pass\n\n\nSummary table\nTypedTable structure\n‚úÖ Pass\n\n\nestimate_loglik\nESS, MCSE fields\n‚úÖ Pass"
  },
  {
    "objectID": "index.html#coverage-gaps-and-future-work",
    "href": "index.html#coverage-gaps-and-future-work",
    "title": "Unit Test Coverage",
    "section": "14. Coverage Gaps and Future Work",
    "text": "14. Coverage Gaps and Future Work\n\n14.1 Current Gaps\n\n\n\n\n\n\n\n\nArea\nGap\nPriority\n\n\n\n\nAFT + TVC\nLimited testing for AFT with time-varying covariates\nMedium\n\n\nPanel + Splines\nIntegration tests for spline hazards with panel data\nMedium\n\n\nEdge cases\nDegenerate transition matrices\nLow\n\n\nPerformance\nBenchmark regression tests\nLow\n\n\n\n\n\n14.2 Test Suite History\n\n\n\n\n\n\n\n\nDate\nAction\nResult\n\n\n\n\n2026-01-23\nMajor cleanup: consolidated/deleted redundant tests\n26 files, 2831 tests\n\n\n2026-01-22\nMerged variance and weight tests\nReduced redundancy\n\n\n2026-01-21\nMerged phase-type tests (7‚Üí2 files)\nConsolidated coverage\n\n\n2026-01\nAdded analytical likelihood tests\ntest_loglik_analytical.jl\n\n\n2026-01\nAdded penalty infrastructure tests\ntest_penalty_infrastructure.jl\n\n\n\n\n\n14.3 Deleted Test Files (Cleanup 2026-01-23)\nThe following files were deleted during test suite cleanup due to redundancy, obsolescence, or low value:\n\ntest_perf.jl - Hardware-dependent, moved to benchmarks\ntest_error_paths.jl - Redundant with test_error_messages.jl\ntest_infrastructure.jl - Tested internal implementation details\ntest_regressions.jl - Bug fixes now covered by other tests\ntest_modelgeneration.jl - Superseded by test_hazard_macro.jl\ntest_mll_consistency.jl - Superseded by test_loglik_analytical.jl\ntest_helpers.jl - Low value utility function tests\ntest_efs.jl - Outdated EDF implementation\ntest_reconstructor.jl - Internal ReConstructor tests\ntest_phasetype_*.jl (6 files) - Merged into test_phasetype.jl\ntest_pijcv_reference.jl, test_pijcv_vs_loocv.jl - Merged into test_pijcv.jl\ntest_constrained_variance.jl - Merged into test_variance.jl\ntest_observation_weights_emat.jl, test_weight_validation.jl - Merged into test_subject_weights.jl\ntest_concurrency.jl, test_ordering_at.jl - Stale APIs"
  },
  {
    "objectID": "index.html#running-tests",
    "href": "index.html#running-tests",
    "title": "Unit Test Coverage",
    "section": "15. Running Tests",
    "text": "15. Running Tests\n# Run all unit tests\njulia --project -e 'using Pkg; Pkg.test()'\n\n# Run specific test file (standalone - may need imports)\njulia --project -e 'using Test, MultistateModels; include(\"MultistateModelsTests/unit/test_hazards.jl\")'\n\n# Run with full long tests\nMSM_TEST_LEVEL=full julia --project -e 'using Pkg; Pkg.test()'"
  }
]